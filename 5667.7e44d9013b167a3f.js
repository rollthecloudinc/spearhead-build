(self.webpackChunkspear=self.webpackChunkspear||[]).push([[5667],{2100:(X,U)=>{function T(l){return l.replace(/[-[\]/{}()*+?.\\^$]/g,"\\$&")}function k(l,r){var _=(void 0===r?{}:r).decimalMark,A=void 0===_?".":_;if("number"==typeof l)return l.toString();if("string"!=typeof l)return"NaN";var a=T(A),y=l.trim(),O=y.match(/^\(.*\)$|^-/),P=new RegExp("[^\\d"+a+"]|"+a+"(?=.*"+a+")|^\\D*"+a+"\\D*$","g");return""===(y=y.replace(P,"").replace(A,"."))?y="NaN":O&&(y="-"+y),y}U.Ro=void 0,U.Ro=function S(l,r){var _=(void 0===r?{}:r).decimalMark,a=k(l,{decimalMark:void 0===_?".":_});return"NaN"===a?NaN:Number(a)}},5667:(X,U,c)=>{c.r(U),c.d(U,{ATTRIBUTE_WIDGET:()=>E,Attribute:()=>z,AttributeMatcherService:()=>Y,AttributePipe:()=>q,AttributeSerializerService:()=>te,AttributeTypes:()=>m,AttributeValue:()=>W,AttributeWidget:()=>j,AttributeWidgetComponent:()=>b,AttributesBuilderComponent:()=>F,AttributesModule:()=>ee,ValueComputerService:()=>J,WidgetPluginManager:()=>h,WidgetsService:()=>V});var T=c(642),k=c(2292),S=c(3730),G=c(2297),K=c(3544),g=c(3288),l=c(3398),r=c(2481),d=c(5240),_=c(3683),A=c(3855),a=c(4456),y=c(8951),O=c(9452),P=c(1265),I=c(2909),D=c(5541),R=c(8388),M=c(2100);function v(t,i){}function w(t,i){if(1&t&&(r.j41(0,"div",4),r.nrm(1,"classifieds-ui-attribute-widget",5),r.k0s()),2&t){var u=i.index,n=r.XpG();r.Y8G("formGroupName",r.mNQ(u)),r.R7$(),r.Y8G("attribute",n.attributes[u])("widget",n.discoverWidget(n.attributes[u].widget))("appearance",n.appearance)}}function B(t,i){1&t&&(r.j41(0,"div")(1,"p"),r.EFF(2,"No attributes available for ad type. Click next to continue."),r.k0s()())}var E=new d.nKC("AttributeWidget"),V=function(){var t,i=function(){return(0,l.A)(function u(n){(0,g.A)(this,u),this.widgets=n},[{key:"get",value:function(e){return this.widgets.find(function(o){return o.name===e})}}])}();return(t=i).\u0275fac=function(n){return new(n||t)(d.KVO(E))},t.\u0275prov=d.jDH({token:t,factory:t.\u0275fac}),i}(),h=function(){var t,i=function(u){function n(e,o){return(0,g.A)(this,n),(0,G.A)(this,n,[e,o])}return(0,K.A)(n,u),(0,l.A)(n,[{key:"pluginDef",value:function(){return(0,O.of)(new P.PluginDef({name:"widget"}))}}])}(P.BasePluginManager);return(t=i).\u0275fac=function(n){return new(n||t)(d.KVO(P.PluginConfigurationManager),d.KVO(I.ModuleLoaderService))},t.\u0275prov=d.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),i}(),N=function(){var t,i=(0,l.A)(function u(n){(0,g.A)(this,u),this.viewContainerRef=n});return(t=i).\u0275fac=function(n){return new(n||t)(r.rXU(r.c1b))},t.\u0275dir=r.FsC({type:t,selectors:[["","classifiedsUiWidgetHost",""]],standalone:!1}),i}(),b=function(){var t,i=function(){return(0,l.A)(function u(n,e){(0,g.A)(this,u),this.componentFactoryResolver=n,this.controlContainer=e,this.appearance="legacy"},[{key:"ngOnInit",value:function(){var e=this;this.widget.subscribe(function(o){var s=e.componentFactoryResolver.resolveComponentFactory(o.component),f=e.widgetHost.viewContainerRef;f.clear();var p=f.createComponent(s);p.instance.attribute=e.attribute,p.instance.appearance=e.appearance})}}])}();return(t=i).\u0275fac=function(n){return new(n||t)(r.rXU(r.OM3),r.rXU(a.ZU))},t.\u0275cmp=r.VBU({type:t,selectors:[["classifieds-ui-attribute-widget"]],viewQuery:function(n,e){var o;1&n&&r.GBs(N,7),2&n&&r.mGM(o=r.lsd())&&(e.widgetHost=o.first)},inputs:{widget:"widget",attribute:"attribute",appearance:"appearance"},standalone:!1,decls:2,vars:1,consts:[[3,"formGroup"],["classifiedsUiWidgetHost",""]],template:function(n,e){1&n&&(r.qex(0,0),r.DNE(1,v,0,0,"ng-template",1),r.bVm()),2&n&&r.Y8G("formGroup",e.controlContainer.control)},dependencies:[a.cb,a.j4,N],encapsulation:2}),i}(),F=function(){var t,i=function(){return(0,l.A)(function u(n,e){(0,g.A)(this,u),this.widgetsService=n,this.wpm=e,this.attributes=[],this.appearance="legacy",this.attributesForm=new a.J3({attributes:new a.Bm([])}),this._attributeValues=[],this.onTouched=function(){}},[{key:"attributeValues",get:function(){return this._attributeValues},set:function(e){this._attributeValues=e,this.applyValues()}},{key:"attributesArray",get:function(){return this.attributesForm.get("attributes")}},{key:"ngOnChanges",value:function(e){var o=this;if(e.attributes&&(!e.attributes.previousValue||e.attributes.previousValue!==e.attributes.currentValue)){for(;0!==this.attributesArray.length;)this.attributesArray.removeAt(0);this.attributes.forEach(function(s){o.attributesArray.push(new a.J3({name:new a.hs(s.name,a.k0.required),type:new a.hs(s.type,a.k0.required),displayName:new a.hs(s.label,a.k0.required),value:new a.hs("",s.required?a.k0.required:[]),attributes:new a.Bm(s.attributes?s.attributes.map(function(f){return new a.J3({name:new a.hs(f.name,a.k0.required),type:new a.hs(f.type,a.k0.required),displayName:new a.hs(f.label,a.k0.required),value:new a.hs("",f.required?a.k0.required:[])})}):[])}))}),this.applyValues()}}},{key:"writeValue",value:function(e){e&&(console.log("write value: ".concat(e)),this.attributesArray.setValue(e,{emitEvent:!1}))}},{key:"registerOnChange",value:function(e){this.attributesArray.valueChanges.subscribe(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){e?this.attributesArray.disable():this.attributesArray.enable()}},{key:"validate",value:function(e){return this.attributesForm.valid?null:{invalidForm:{valid:!1,message:"attributes are invalid"}}}},{key:"discoverWidget",value:function(e){return this.wpm.getPlugin(e)}},{key:"applyValues",value:function(){var e=this;this.attributesArray.controls.forEach(function(o,s){var f=e.attributeValues?e.attributeValues.find(function(p){return p.name===o.get("name").value}):void 0;void 0!==f&&(o.get("value").setValue(f.value),o.updateValueAndValidity()),o.get("attributes").controls.forEach(function(p){var C=e.attributeValues&&void 0!==e.attributeValues[s]?e.attributeValues[s].attributes.find(function(x){return x.name===p.get("name").value}):void 0;void 0!==C&&(p.get("value").setValue(C.value),p.updateValueAndValidity())})})}}])}();return(t=i).\u0275fac=function(n){return new(n||t)(r.rXU(V),r.rXU(h))},t.\u0275cmp=r.VBU({type:t,selectors:[["classifieds-ui-attributes-builder"]],inputs:{attributes:"attributes",appearance:"appearance",attributeValues:"attributeValues"},standalone:!1,features:[r.Jv_([V,{provide:a.kq,useExisting:(0,d.Rfq)(function(){return t}),multi:!0},{provide:a.cz,useExisting:(0,d.Rfq)(function(){return t}),multi:!0}]),r.OA$],decls:4,vars:3,consts:[[3,"formGroup"],["formArrayName","attributes",1,"attribute-fields"],["class","attribute-field-container",3,"formGroupName",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"attribute-field-container",3,"formGroupName"],[3,"attribute","widget","appearance"]],template:function(n,e){1&n&&(r.qex(0,0),r.j41(1,"div",1),r.DNE(2,w,2,5,"div",2),r.k0s(),r.bVm(),r.DNE(3,B,3,0,"div",3)),2&n&&(r.Y8G("formGroup",e.attributesForm),r.R7$(2),r.Y8G("ngForOf",e.attributesArray.controls),r.R7$(),r.Y8G("ngIf",0==e.attributes.length))},dependencies:[_.Sq,_.bT,a.cb,a.j4,a.$R,a.v8,b],encapsulation:2}),i}(),L=function(){var t,i=(0,l.A)(function u(n){(0,g.A)(this,u),this.controlContainer=n,this.appearance="legacy"});return(t=i).\u0275fac=function(n){return new(n||t)(r.rXU(a.ZU))},t.\u0275cmp=r.VBU({type:t,selectors:[["classifieds-ui-text-widget"]],inputs:{attribute:"attribute",appearance:"appearance"},standalone:!1,decls:3,vars:3,consts:[[3,"formGroup"],[3,"appearance"],["matInput","","formControlName","value",3,"placeholder"]],template:function(n,e){1&n&&(r.qex(0,0),r.j41(1,"mat-form-field",1),r.nrm(2,"input",2),r.k0s(),r.bVm()),2&n&&(r.Y8G("formGroup",e.controlContainer.control),r.R7$(),r.Y8G("appearance",e.appearance),r.R7$(),r.Y8G("placeholder",e.attribute.label))},dependencies:[a.me,a.BC,a.cb,a.j4,a.JD,D.fg,R.rl],encapsulation:2}),i}(),$=function(){var t,i=(0,l.A)(function u(n){(0,g.A)(this,u),this.controlContainer=n});return(t=i).\u0275fac=function(n){return new(n||t)(r.rXU(a.ZU))},t.\u0275cmp=r.VBU({type:t,selectors:[["classifieds-ui-min-max-widget"]],inputs:{attribute:"attribute"},standalone:!1,decls:8,vars:4,consts:[[3,"formGroup"],["formArrayName","attributes"],["formGroupName","0"],["matInput","","type","number","formControlName","value",3,"placeholder"],["formGroupName","1"]],template:function(n,e){1&n&&(r.qex(0,0),r.j41(1,"label"),r.EFF(2),r.k0s(),r.j41(3,"div",1)(4,"mat-form-field",2),r.nrm(5,"input",3),r.k0s(),r.j41(6,"mat-form-field",4),r.nrm(7,"input",3),r.k0s()(),r.bVm()),2&n&&(r.Y8G("formGroup",e.controlContainer.control),r.R7$(2),r.JRh(e.attribute.label),r.R7$(3),r.Y8G("placeholder",e.attribute.attributes[0].label),r.R7$(2),r.Y8G("placeholder",e.attribute.attributes[1].label))},dependencies:[a.me,a.Q0,a.BC,a.cb,a.j4,a.JD,a.$R,a.v8,D.fg,R.rl],encapsulation:2}),i}(),Y=function(){var t,i=function(){return(0,l.A)(function u(){(0,g.A)(this,u)},[{key:"getComputedValue",value:function(e,o){var s=o&&o.length>0&&this.matchAttribute(e,o);if(s)return s.computedValue}},{key:"getValue",value:function(e,o){var s=o&&o.length>0&&this.matchAttribute(e,o);if(s)return s.value}},{key:"matchAttribute",value:function(e,o){for(var s=o.length,f=0;f<s;f++)if(o[f].attributes&&o[f].attributes.length>0){if(this.matchAttribute(e,o[f].attributes))return o[f]}else if(e===o[f].name)return o[f]}}])}();return(t=i).\u0275fac=function(n){return new(n||t)},t.\u0275prov=d.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),i}(),q=function(){var t,i=function(){return(0,l.A)(function u(n){(0,g.A)(this,u),this.attributeMatcher=n},[{key:"transform",value:function(e,o){return this.attributeMatcher.getComputedValue(o,e)||""}}])}();return(t=i).\u0275fac=function(n){return new(n||t)(r.rXU(Y,16))},t.\u0275pipe=r.EJ8({name:"attribute",type:t,pure:!0,standalone:!1}),i}(),m=function(t){return t[t.Number=0]="Number",t[t.Text=1]="Text",t[t.Complex=2]="Complex",t[t.Float=3]="Float",t[t.Array=4]="Array",t[t.Bool=5]="Bool",t[t.Date=6]="Date",t}(m||{}),j=function(t){function i(u){var n;return(0,g.A)(this,i),n=(0,G.A)(this,i,[u]),u&&(n.name=n.id,n.schema=u.schema?new z(u.schema):void 0,n.component=u.component),n}return(0,K.A)(i,t),(0,l.A)(i)}(P.Plugin),z=(0,l.A)(function t(i){(0,g.A)(this,t),this.attributes=[],i&&(this.name=i.name,this.widget=void 0!==i.widget?i.widget:"text",this.type=i.type,this.label=i.label,this.required=i.required,this.options=i.options,i.attributes&&(this.attributes=i.attributes.map(function(u){return new t(u)})))}),W=(0,l.A)(function t(i){(0,g.A)(this,t),this.attributes=[],i&&(this.name=i.name,this.displayName=i.displayName,this.type=i.type,this.value=i.value,this.intValue=i.intValue,this.computedValue=i.computedValue,i.attributes&&(Array.isArray(i.attributes)?this.attributes=i.attributes.reduce(function(u,n){return void 0===n._store||n._store?[].concat((0,S.A)(u),[new t(n)]):u},[]):(void 0===i.attributes._store||i.attributes._store)&&(this.attributes=[i.attributes])),i.value&&"object"==typeof i.value?(this.value=void 0,this.type=m.Complex,i.value.attributes.reduce(function(u,n){return void 0===n._store||n._store?[].concat((0,S.A)(u),[new t(n)]):u},[])):this.value=i.value)}),Q=function(){var i=new z({name:"",type:m.Text,label:"",required:!1,widget:"text",options:{},attributes:[]});return new j({id:"text",name:"text",title:"Text",component:L,schema:i})},Z=function(){return new j({id:"minmax",name:"minmax",title:"MinMax",component:$,schema:void 0})},ee=function(){var t,i=(0,l.A)(function u(n,e){(0,g.A)(this,u),n.forEach(function(o){return e.register(o)})});return(t=i).\u0275fac=function(n){return new(n||t)(d.KVO(E),d.KVO(h))},t.\u0275mod=r.$C({type:t}),t.\u0275inj=d.G2t({providers:[{provide:E,useFactory:Q,multi:!0},{provide:E,useFactory:Z,multi:!0},(0,A.$R)((0,A.YH)())],imports:[_.MD,a.X1,y.MaterialModule]}),i}(),J=function(){var t,i=function(){return(0,l.A)(function u(){(0,g.A)(this,u)},[{key:"compute",value:function(e){var o=this,s=[];return e.forEach(function(f){return s.push(o.computeAttribute(f))}),s}},{key:"computeAttribute",value:function(e){var o=this.resolveComputedValue(e.value,e.type);return new W((0,k.A)((0,k.A)({},e),{},e.attributes&&e.attributes.length>0?{computedValue:o,attributes:this.compute(e.attributes)}:{computedValue:o}))}},{key:"resolveComputedValue",value:function(e,o){var s;return o===m.Number?(s=(0,M.Ro)(e.trim()))&&isNaN(s)&&(s=void 0):s=e.trim(),void 0===s?s:"".concat(s)}}])}();return(t=i).\u0275fac=function(n){return new(n||t)},t.\u0275prov=d.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),i}(),te=function(){var t,i=function(){return(0,l.A)(function u(n){(0,g.A)(this,u),this.valueComputer=n},[{key:"serialize",value:function(e,o){var s=typeof e;if("object"!==s)return new W({name:o,type:"string"!==s?"boolean"!==s?m.Number:m.Bool:m.Text,displayName:o,value:"".concat(e),intValue:void 0,computedValue:this.valueComputer.resolveComputedValue("".concat(e),"string"!==s?"boolean"!==s?m.Number:m.Bool:m.Text),attributes:[]});if(Array.isArray(e)&&("attributes"===o||"settings"===o))return new W({name:o,type:m.Complex,displayName:o,value:void 0,intValue:void 0,computedValue:void 0,attributes:e});if(Array.isArray(e)){for(var f=e.length,p=[],C=0;C<f;C++)p.push(this.serialize(e[C],"".concat(C)));return new W({name:o,type:m.Array,displayName:o,value:void 0,intValue:void 0,computedValue:void 0,attributes:p})}if(e instanceof Date)return new W({name:o,type:m.Date,displayName:o,value:e.toJSON(),intValue:void 0,computedValue:e.toJSON(),attributes:[]});var x=[];for(var H in e)x.push(this.serialize(e[H],H));return new W({name:o,type:m.Complex,displayName:o,value:void 0,intValue:void 0,computedValue:void 0,attributes:x})}},{key:"deserializeAsObject",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.deserialize(new W({name:"root",type:m.Complex,displayName:"root",value:void 0,computedValue:void 0,intValue:0,attributes:e}),o)}},{key:"deserialize",value:function(e){var s,f,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e.type){case m.Complex:if(o||"attributes"!==e.name&&"settings"!==e.name){f=e.attributes.length;for(var p=0;p<f;p++)s=(0,k.A)((0,k.A)({},s),{},(0,T.A)({},e.attributes[p].name,this.deserialize(e.attributes[p])))}else s=e.attributes.map(function(x){return new W(x)});break;case m.Bool:s=void 0!==e.value?["1","true","on"].findIndex(function(x){return x===e.value})>-1:void 0;break;case m.Number:case m.Float:s=void 0!==e.value&&""!==e.value&&"undefined"!==e.value?"0"!==e.value?(0,M.Ro)(e.value.trim()):0:void 0;break;case m.Text:s=e.value;break;case m.Array:if(o||"attributes"!==e.name&&"settings"!==e.name){f=e.attributes.length,s=[];for(var C=0;C<f;C++)s=[].concat((0,S.A)(s),[this.deserialize(e.attributes[C])])}else s=e.attributes.map(function(x){return new W(x)});break;case m.Date:s=void 0!==e.value&&""!==e.value?new Date(e.value):void 0}return s}},{key:"convertToGroup",value:function(e){var o=this,s=new a.J3({name:new a.hs(e.name,a.k0.required),type:new a.hs(e.type,a.k0.required),displayName:new a.hs(e.displayName,a.k0.required),value:new a.hs(e.value,a.k0.required),computedValue:new a.hs(e.value,a.k0.required),attributes:new a.Bm([])});return e.attributes&&e.attributes.length>0&&e.attributes.forEach(function(f){s.get("attributes").push(o.convertToGroup(f))}),s}}])}();return(t=i).\u0275fac=function(n){return new(n||t)(d.KVO(J))},t.\u0275prov=d.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),i}()}}]);
//# sourceMappingURL=5667.7e44d9013b167a3f.js.map