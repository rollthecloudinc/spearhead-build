{
  "version": 3,
  "sources": ["../../@smithy/core/dist-es/submodules/protocols/extended-encode-uri-component.js", "../../@smithy/querystring-parser/dist-es/index.js", "../../@smithy/url-parser/dist-es/index.js", "../../@smithy/middleware-endpoint/dist-es/adaptors/toEndpointV1.js", "../../@smithy/middleware-endpoint/dist-es/service-customizations/s3.js", "../../@smithy/middleware-endpoint/dist-es/adaptors/createConfigValueProvider.js", "../../@smithy/middleware-endpoint/dist-es/adaptors/getEndpointFromConfig.browser.js", "../../@smithy/middleware-endpoint/dist-es/adaptors/getEndpointFromInstructions.js"],
  "sourcesContent": ["export function extendedEncodeURIComponent(str) {\n  return encodeURIComponent(str).replace(/[!'()*]/g, function (c) {\n    return \"%\" + c.charCodeAt(0).toString(16).toUpperCase();\n  });\n}", "export function parseQueryString(querystring) {\n  const query = {};\n  querystring = querystring.replace(/^\\?/, \"\");\n  if (querystring) {\n    for (const pair of querystring.split(\"&\")) {\n      let [key, value = null] = pair.split(\"=\");\n      key = decodeURIComponent(key);\n      if (value) {\n        value = decodeURIComponent(value);\n      }\n      if (!(key in query)) {\n        query[key] = value;\n      } else if (Array.isArray(query[key])) {\n        query[key].push(value);\n      } else {\n        query[key] = [query[key], value];\n      }\n    }\n  }\n  return query;\n}", "import { parseQueryString } from \"@smithy/querystring-parser\";\nexport const parseUrl = url => {\n  if (typeof url === \"string\") {\n    return parseUrl(new URL(url));\n  }\n  const {\n    hostname,\n    pathname,\n    port,\n    protocol,\n    search\n  } = url;\n  let query;\n  if (search) {\n    query = parseQueryString(search);\n  }\n  return {\n    hostname,\n    port: port ? parseInt(port) : undefined,\n    protocol,\n    path: pathname,\n    query\n  };\n};", "import { parseUrl } from \"@smithy/url-parser\";\nexport const toEndpointV1 = endpoint => {\n  if (typeof endpoint === \"object\") {\n    if (\"url\" in endpoint) {\n      return parseUrl(endpoint.url);\n    }\n    return endpoint;\n  }\n  return parseUrl(endpoint);\n};", "export const resolveParamsForS3 = async endpointParams => {\n  const bucket = endpointParams?.Bucket || \"\";\n  if (typeof endpointParams.Bucket === \"string\") {\n    endpointParams.Bucket = bucket.replace(/#/g, encodeURIComponent(\"#\")).replace(/\\?/g, encodeURIComponent(\"?\"));\n  }\n  if (isArnBucketName(bucket)) {\n    if (endpointParams.ForcePathStyle === true) {\n      throw new Error(\"Path-style addressing cannot be used with ARN buckets\");\n    }\n  } else if (!isDnsCompatibleBucketName(bucket) || bucket.indexOf(\".\") !== -1 && !String(endpointParams.Endpoint).startsWith(\"http:\") || bucket.toLowerCase() !== bucket || bucket.length < 3) {\n    endpointParams.ForcePathStyle = true;\n  }\n  if (endpointParams.DisableMultiRegionAccessPoints) {\n    endpointParams.disableMultiRegionAccessPoints = true;\n    endpointParams.DisableMRAP = true;\n  }\n  return endpointParams;\n};\nconst DOMAIN_PATTERN = /^[a-z0-9][a-z0-9\\.\\-]{1,61}[a-z0-9]$/;\nconst IP_ADDRESS_PATTERN = /(\\d+\\.){3}\\d+/;\nconst DOTS_PATTERN = /\\.\\./;\nexport const DOT_PATTERN = /\\./;\nexport const S3_HOSTNAME_PATTERN = /^(.+\\.)?s3(-fips)?(\\.dualstack)?[.-]([a-z0-9-]+)\\./;\nexport const isDnsCompatibleBucketName = bucketName => DOMAIN_PATTERN.test(bucketName) && !IP_ADDRESS_PATTERN.test(bucketName) && !DOTS_PATTERN.test(bucketName);\nexport const isArnBucketName = bucketName => {\n  const [arn, partition, service,,, bucket] = bucketName.split(\":\");\n  const isArn = arn === \"arn\" && bucketName.split(\":\").length >= 6;\n  const isValidArn = Boolean(isArn && partition && service && bucket);\n  if (isArn && !isValidArn) {\n    throw new Error(`Invalid ARN: ${bucketName} was an invalid ARN.`);\n  }\n  return isValidArn;\n};", "export const createConfigValueProvider = (configKey, canonicalEndpointParamKey, config) => {\n  const configProvider = async () => {\n    const configValue = config[configKey] ?? config[canonicalEndpointParamKey];\n    if (typeof configValue === \"function\") {\n      return configValue();\n    }\n    return configValue;\n  };\n  if (configKey === \"credentialScope\" || canonicalEndpointParamKey === \"CredentialScope\") {\n    return async () => {\n      const credentials = typeof config.credentials === \"function\" ? await config.credentials() : config.credentials;\n      const configValue = credentials?.credentialScope ?? credentials?.CredentialScope;\n      return configValue;\n    };\n  }\n  if (configKey === \"accountId\" || canonicalEndpointParamKey === \"AccountId\") {\n    return async () => {\n      const credentials = typeof config.credentials === \"function\" ? await config.credentials() : config.credentials;\n      const configValue = credentials?.accountId ?? credentials?.AccountId;\n      return configValue;\n    };\n  }\n  if (configKey === \"endpoint\" || canonicalEndpointParamKey === \"endpoint\") {\n    return async () => {\n      if (config.isCustomEndpoint === false) {\n        return undefined;\n      }\n      const endpoint = await configProvider();\n      if (endpoint && typeof endpoint === \"object\") {\n        if (\"url\" in endpoint) {\n          return endpoint.url.href;\n        }\n        if (\"hostname\" in endpoint) {\n          const {\n            protocol,\n            hostname,\n            port,\n            path\n          } = endpoint;\n          return `${protocol}//${hostname}${port ? \":\" + port : \"\"}${path}`;\n        }\n      }\n      return endpoint;\n    };\n  }\n  return configProvider;\n};", "export const getEndpointFromConfig = async serviceId => undefined;", "import { resolveParamsForS3 } from \"../service-customizations\";\nimport { createConfigValueProvider } from \"./createConfigValueProvider\";\nimport { getEndpointFromConfig } from \"./getEndpointFromConfig\";\nimport { toEndpointV1 } from \"./toEndpointV1\";\nexport const getEndpointFromInstructions = async (commandInput, instructionsSupplier, clientConfig, context) => {\n  if (!clientConfig.isCustomEndpoint) {\n    let endpointFromConfig;\n    if (clientConfig.serviceConfiguredEndpoint) {\n      endpointFromConfig = await clientConfig.serviceConfiguredEndpoint();\n    } else {\n      endpointFromConfig = await getEndpointFromConfig(clientConfig.serviceId);\n    }\n    if (endpointFromConfig) {\n      clientConfig.endpoint = () => Promise.resolve(toEndpointV1(endpointFromConfig));\n      clientConfig.isCustomEndpoint = true;\n    }\n  }\n  const endpointParams = await resolveParams(commandInput, instructionsSupplier, clientConfig);\n  if (typeof clientConfig.endpointProvider !== \"function\") {\n    throw new Error(\"config.endpointProvider is not set.\");\n  }\n  const endpoint = clientConfig.endpointProvider(endpointParams, context);\n  return endpoint;\n};\nexport const resolveParams = async (commandInput, instructionsSupplier, clientConfig) => {\n  const endpointParams = {};\n  const instructions = instructionsSupplier?.getEndpointParameterInstructions?.() || {};\n  for (const [name, instruction] of Object.entries(instructions)) {\n    switch (instruction.type) {\n      case \"staticContextParams\":\n        endpointParams[name] = instruction.value;\n        break;\n      case \"contextParams\":\n        endpointParams[name] = commandInput[instruction.name];\n        break;\n      case \"clientContextParams\":\n      case \"builtInParams\":\n        endpointParams[name] = await createConfigValueProvider(instruction.name, name, clientConfig)();\n        break;\n      case \"operationContextParams\":\n        endpointParams[name] = instruction.get(commandInput);\n        break;\n      default:\n        throw new Error(\"Unrecognized endpoint parameter instruction: \" + JSON.stringify(instruction));\n    }\n  }\n  if (Object.keys(instructions).length === 0) {\n    Object.assign(endpointParams, clientConfig);\n  }\n  if (String(clientConfig.serviceId).toLowerCase() === \"s3\") {\n    await resolveParamsForS3(endpointParams);\n  }\n  return endpointParams;\n};"],
  "mappings": "wCAAO,SAASA,EAA2BC,EAAK,CAC9C,OAAO,mBAAmBA,CAAG,EAAE,QAAQ,WAAY,SAAUC,EAAG,CAC9D,MAAO,IAAMA,EAAE,WAAW,CAAC,EAAE,SAAS,EAAE,EAAE,YAAY,CACxD,CAAC,CACH,CCJO,SAASC,EAAiBC,EAAa,CAC5C,IAAMC,EAAQ,CAAC,EAEf,GADAD,EAAcA,EAAY,QAAQ,MAAO,EAAE,EACvCA,EACF,QAAWE,KAAQF,EAAY,MAAM,GAAG,EAAG,CACzC,GAAI,CAACG,EAAKC,EAAQ,IAAI,EAAIF,EAAK,MAAM,GAAG,EACxCC,EAAM,mBAAmBA,CAAG,EACxBC,IACFA,EAAQ,mBAAmBA,CAAK,GAE5BD,KAAOF,EAEF,MAAM,QAAQA,EAAME,CAAG,CAAC,EACjCF,EAAME,CAAG,EAAE,KAAKC,CAAK,EAErBH,EAAME,CAAG,EAAI,CAACF,EAAME,CAAG,EAAGC,CAAK,EAJ/BH,EAAME,CAAG,EAAIC,CAMjB,CAEF,OAAOH,CACT,CCnBO,IAAMI,EAAWC,GAAO,CAC7B,GAAI,OAAOA,GAAQ,SACjB,OAAOD,EAAS,IAAI,IAAIC,CAAG,CAAC,EAE9B,GAAM,CACJ,SAAAC,EACA,SAAAC,EACA,KAAAC,EACA,SAAAC,EACA,OAAAC,CACF,EAAIL,EACAM,EACJ,OAAID,IACFC,EAAQC,EAAiBF,CAAM,GAE1B,CACL,SAAAJ,EACA,KAAME,EAAO,SAASA,CAAI,EAAI,OAC9B,SAAAC,EACA,KAAMF,EACN,MAAAI,CACF,CACF,ECtBO,IAAME,EAAeC,GACtB,OAAOA,GAAa,SAClB,QAASA,EACJC,EAASD,EAAS,GAAG,EAEvBA,EAEFC,EAASD,CAAQ,ECRnB,IAAME,EAA2BC,GAAkBC,EAAA,sBACxD,IAAMC,EAASF,GAAgB,QAAU,GAIzC,GAHI,OAAOA,EAAe,QAAW,WACnCA,EAAe,OAASE,EAAO,QAAQ,KAAM,mBAAmB,GAAG,CAAC,EAAE,QAAQ,MAAO,mBAAmB,GAAG,CAAC,GAE1GC,EAAgBD,CAAM,GACxB,GAAIF,EAAe,iBAAmB,GACpC,MAAM,IAAI,MAAM,uDAAuD,OAEhE,CAACI,EAA0BF,CAAM,GAAKA,EAAO,QAAQ,GAAG,IAAM,IAAM,CAAC,OAAOF,EAAe,QAAQ,EAAE,WAAW,OAAO,GAAKE,EAAO,YAAY,IAAMA,GAAUA,EAAO,OAAS,KACxLF,EAAe,eAAiB,IAElC,OAAIA,EAAe,iCACjBA,EAAe,+BAAiC,GAChDA,EAAe,YAAc,IAExBA,CACT,GACMK,EAAiB,uCACjBC,EAAqB,gBACrBC,EAAe,OAGd,IAAMC,EAA4BC,GAAcC,EAAe,KAAKD,CAAU,GAAK,CAACE,EAAmB,KAAKF,CAAU,GAAK,CAACG,EAAa,KAAKH,CAAU,EAClJI,EAAkBJ,GAAc,CAC3C,GAAM,CAACK,EAAKC,EAAWC,EAAQ,CAAC,CAAEC,CAAM,EAAIR,EAAW,MAAM,GAAG,EAC1DS,EAAQJ,IAAQ,OAASL,EAAW,MAAM,GAAG,EAAE,QAAU,EACzDU,EAAa,GAAQD,GAASH,GAAaC,GAAWC,GAC5D,GAAIC,GAAS,CAACC,EACZ,MAAM,IAAI,MAAM,gBAAgBV,CAAU,sBAAsB,EAElE,OAAOU,CACT,EChCO,IAAMC,EAA4B,CAACC,EAAWC,EAA2BC,IAAW,CACzF,IAAMC,EAAiB,IAAYC,EAAA,sBACjC,IAAMC,EAAcH,EAAOF,CAAS,GAAKE,EAAOD,CAAyB,EACzE,OAAI,OAAOI,GAAgB,WAClBA,EAAY,EAEdA,CACT,GACA,OAAIL,IAAc,mBAAqBC,IAA8B,kBAC5D,IAAYG,EAAA,sBACjB,IAAME,EAAc,OAAOJ,EAAO,aAAgB,WAAa,MAAMA,EAAO,YAAY,EAAIA,EAAO,YAEnG,OADoBI,GAAa,iBAAmBA,GAAa,eAEnE,GAEEN,IAAc,aAAeC,IAA8B,YACtD,IAAYG,EAAA,sBACjB,IAAME,EAAc,OAAOJ,EAAO,aAAgB,WAAa,MAAMA,EAAO,YAAY,EAAIA,EAAO,YAEnG,OADoBI,GAAa,WAAaA,GAAa,SAE7D,GAEEN,IAAc,YAAcC,IAA8B,WACrD,IAAYG,EAAA,sBACjB,GAAIF,EAAO,mBAAqB,GAC9B,OAEF,IAAMK,EAAW,MAAMJ,EAAe,EACtC,GAAII,GAAY,OAAOA,GAAa,SAAU,CAC5C,GAAI,QAASA,EACX,OAAOA,EAAS,IAAI,KAEtB,GAAI,aAAcA,EAAU,CAC1B,GAAM,CACJ,SAAAC,EACA,SAAAC,EACA,KAAAC,EACA,KAAAC,CACF,EAAIJ,EACJ,MAAO,GAAGC,CAAQ,KAAKC,CAAQ,GAAGC,EAAO,IAAMA,EAAO,EAAE,GAAGC,CAAI,EACjE,CACF,CACA,OAAOJ,CACT,GAEKJ,CACT,EC9CO,IAAMS,EAA8BC,GAAUC,EAAA,yBCI9C,IAAMC,EAA8B,CAAOC,EAAcC,EAAsBC,EAAcC,IAAYC,EAAA,sBAC9G,GAAI,CAACF,EAAa,iBAAkB,CAClC,IAAIG,EACAH,EAAa,0BACfG,EAAqB,MAAMH,EAAa,0BAA0B,EAElEG,EAAqB,MAAMC,EAAsBJ,EAAa,SAAS,EAErEG,IACFH,EAAa,SAAW,IAAM,QAAQ,QAAQK,EAAaF,CAAkB,CAAC,EAC9EH,EAAa,iBAAmB,GAEpC,CACA,IAAMM,EAAiB,MAAMC,EAAcT,EAAcC,EAAsBC,CAAY,EAC3F,GAAI,OAAOA,EAAa,kBAAqB,WAC3C,MAAM,IAAI,MAAM,qCAAqC,EAGvD,OADiBA,EAAa,iBAAiBM,EAAgBL,CAAO,CAExE,GACaM,EAAgB,CAAOT,EAAcC,EAAsBC,IAAiBE,EAAA,sBACvF,IAAMI,EAAiB,CAAC,EAClBE,EAAeT,GAAsB,mCAAmC,GAAK,CAAC,EACpF,OAAW,CAACU,EAAMC,CAAW,IAAK,OAAO,QAAQF,CAAY,EAC3D,OAAQE,EAAY,KAAM,CACxB,IAAK,sBACHJ,EAAeG,CAAI,EAAIC,EAAY,MACnC,MACF,IAAK,gBACHJ,EAAeG,CAAI,EAAIX,EAAaY,EAAY,IAAI,EACpD,MACF,IAAK,sBACL,IAAK,gBACHJ,EAAeG,CAAI,EAAI,MAAME,EAA0BD,EAAY,KAAMD,EAAMT,CAAY,EAAE,EAC7F,MACF,IAAK,yBACHM,EAAeG,CAAI,EAAIC,EAAY,IAAIZ,CAAY,EACnD,MACF,QACE,MAAM,IAAI,MAAM,gDAAkD,KAAK,UAAUY,CAAW,CAAC,CACjG,CAEF,OAAI,OAAO,KAAKF,CAAY,EAAE,SAAW,GACvC,OAAO,OAAOF,EAAgBN,CAAY,EAExC,OAAOA,EAAa,SAAS,EAAE,YAAY,IAAM,OACnD,MAAMY,EAAmBN,CAAc,GAElCA,CACT",
  "names": ["extendedEncodeURIComponent", "str", "c", "parseQueryString", "querystring", "query", "pair", "key", "value", "parseUrl", "url", "hostname", "pathname", "port", "protocol", "search", "query", "parseQueryString", "toEndpointV1", "endpoint", "parseUrl", "resolveParamsForS3", "endpointParams", "__async", "bucket", "isArnBucketName", "isDnsCompatibleBucketName", "DOMAIN_PATTERN", "IP_ADDRESS_PATTERN", "DOTS_PATTERN", "isDnsCompatibleBucketName", "bucketName", "DOMAIN_PATTERN", "IP_ADDRESS_PATTERN", "DOTS_PATTERN", "isArnBucketName", "arn", "partition", "service", "bucket", "isArn", "isValidArn", "createConfigValueProvider", "configKey", "canonicalEndpointParamKey", "config", "configProvider", "__async", "configValue", "credentials", "endpoint", "protocol", "hostname", "port", "path", "getEndpointFromConfig", "serviceId", "__async", "getEndpointFromInstructions", "commandInput", "instructionsSupplier", "clientConfig", "context", "__async", "endpointFromConfig", "getEndpointFromConfig", "toEndpointV1", "endpointParams", "resolveParams", "instructions", "name", "instruction", "createConfigValueProvider", "resolveParamsForS3"]
}
