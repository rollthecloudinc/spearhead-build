(self.webpackChunkspear=self.webpackChunkspear||[]).push([[5667],{12100:(K,k)=>{function B(l){return l.replace(/[-[\]/{}()*+?.\\^$]/g,"\\$&")}function A(l,t){var b=(void 0===t?{}:t).decimalMark,a=void 0===b?".":b;if("number"==typeof l)return l.toString();if("string"!=typeof l)return"NaN";var E=B(a),C=l.trim(),O=C.match(/^\(.*\)$|^-/),R=new RegExp("[^\\d"+E+"]|"+E+"(?=.*"+E+")|^\\D*"+E+"\\D*$","g");return""===(C=C.replace(R,"").replace(a,"."))?C="NaN":O&&(C="-"+C),C}k.Ro=void 0,k.Ro=function w(l,t){var b=(void 0===t?{}:t).decimalMark,E=A(l,{decimalMark:void 0===b?".":b});return"NaN"===E?NaN:Number(E)}},95667:(K,k,d)=>{d.r(k),d.d(k,{ATTRIBUTE_WIDGET:()=>h,Attribute:()=>H,AttributeMatcherService:()=>L,AttributePipe:()=>z,AttributeSerializerService:()=>Z,AttributeTypes:()=>p,AttributeValue:()=>I,AttributeWidget:()=>$,AttributeWidgetComponent:()=>y,AttributesBuilderComponent:()=>U,AttributesModule:()=>q,ValueComputerService:()=>Q,WidgetPluginManager:()=>F,WidgetsService:()=>V});var B=d(40642),A=d(22292),w=d(63730),_=d(82297),D=d(13544),m=d(43288),l=d(63398),t=d(49431),f=d(25965),b=d(55787),a=d(81011),E=d(68951),C=d(59452),O=d(71265),R=d(52909),W=d(51973),S=d(12100);function G(n,i){}function N(n,i){if(1&n&&(t.\u0275\u0275elementStart(0,"div",4),t.\u0275\u0275element(1,"classifieds-ui-attribute-widget",5),t.\u0275\u0275elementEnd()),2&n){var o=i.index,r=t.\u0275\u0275nextContext();t.\u0275\u0275property("formGroupName",t.\u0275\u0275interpolate(o)),t.\u0275\u0275advance(),t.\u0275\u0275property("attribute",r.attributes[o])("widget",r.discoverWidget(r.attributes[o].widget))("appearance",r.appearance)}}function v(n,i){1&n&&(t.\u0275\u0275elementStart(0,"div")(1,"p"),t.\u0275\u0275text(2,"No attributes available for ad type. Click next to continue."),t.\u0275\u0275elementEnd()())}var h=new t.InjectionToken("AttributeWidget"),V=function(){var n,i=function(){return(0,l.A)(function o(r){(0,m.A)(this,o),this.widgets=r},[{key:"get",value:function(e){return this.widgets.find(function(u){return u.name===e})}}])}();return(n=i).\u0275fac=function(r){return new(r||n)(t.\u0275\u0275inject(h))},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),i}(),F=function(){var n,i=function(o){function r(e,u){return(0,m.A)(this,r),(0,_.A)(this,r,[e,u])}return(0,D.A)(r,o),(0,l.A)(r,[{key:"pluginDef",value:function(){return(0,C.of)(new O.PluginDef({name:"widget"}))}}])}(O.BasePluginManager);return(n=i).\u0275fac=function(r){return new(r||n)(t.\u0275\u0275inject(O.PluginConfigurationManager),t.\u0275\u0275inject(R.ModuleLoaderService))},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),i}(),j=function(){var n,i=(0,l.A)(function o(r){(0,m.A)(this,o),this.viewContainerRef=r});return(n=i).\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(t.ViewContainerRef))},n.\u0275dir=t.\u0275\u0275defineDirective({type:n,selectors:[["","classifiedsUiWidgetHost",""]],standalone:!1}),i}(),y=function(){var n,i=function(){return(0,l.A)(function o(r,e){(0,m.A)(this,o),this.componentFactoryResolver=r,this.controlContainer=e,this.appearance="legacy"},[{key:"ngOnInit",value:function(){var e=this;this.widget.subscribe(function(u){var s=e.componentFactoryResolver.resolveComponentFactory(u.component),c=e.widgetHost.viewContainerRef;c.clear();var g=c.createComponent(s);g.instance.attribute=e.attribute,g.instance.appearance=e.appearance})}}])}();return(n=i).\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(t.ComponentFactoryResolver),t.\u0275\u0275directiveInject(a.ControlContainer))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["classifieds-ui-attribute-widget"]],viewQuery:function(r,e){var u;1&r&&t.\u0275\u0275viewQuery(j,7),2&r&&t.\u0275\u0275queryRefresh(u=t.\u0275\u0275loadQuery())&&(e.widgetHost=u.first)},inputs:{widget:"widget",attribute:"attribute",appearance:"appearance"},standalone:!1,decls:2,vars:1,consts:[[3,"formGroup"],["classifiedsUiWidgetHost",""]],template:function(r,e){1&r&&(t.\u0275\u0275elementContainerStart(0,0),t.\u0275\u0275template(1,G,0,0,"ng-template",1),t.\u0275\u0275elementContainerEnd()),2&r&&t.\u0275\u0275property("formGroup",e.controlContainer.control)},dependencies:[a.NgControlStatusGroup,a.FormGroupDirective,j],encapsulation:2}),i}(),U=function(){var n,i=function(){return(0,l.A)(function o(r,e){(0,m.A)(this,o),this.widgetsService=r,this.wpm=e,this.attributes=[],this.appearance="legacy",this.attributesForm=new a.UntypedFormGroup({attributes:new a.UntypedFormArray([])}),this._attributeValues=[],this.onTouched=function(){}},[{key:"attributeValues",get:function(){return this._attributeValues},set:function(e){this._attributeValues=e,this.applyValues()}},{key:"attributesArray",get:function(){return this.attributesForm.get("attributes")}},{key:"ngOnChanges",value:function(e){var u=this;if(e.attributes&&(!e.attributes.previousValue||e.attributes.previousValue!==e.attributes.currentValue)){for(;0!==this.attributesArray.length;)this.attributesArray.removeAt(0);this.attributes.forEach(function(s){u.attributesArray.push(new a.UntypedFormGroup({name:new a.UntypedFormControl(s.name,a.Validators.required),type:new a.UntypedFormControl(s.type,a.Validators.required),displayName:new a.UntypedFormControl(s.label,a.Validators.required),value:new a.UntypedFormControl("",s.required?a.Validators.required:[]),attributes:new a.UntypedFormArray(s.attributes?s.attributes.map(function(c){return new a.UntypedFormGroup({name:new a.UntypedFormControl(c.name,a.Validators.required),type:new a.UntypedFormControl(c.type,a.Validators.required),displayName:new a.UntypedFormControl(c.label,a.Validators.required),value:new a.UntypedFormControl("",c.required?a.Validators.required:[])})}):[])}))}),this.applyValues()}}},{key:"writeValue",value:function(e){e&&(console.log("write value: ".concat(e)),this.attributesArray.setValue(e,{emitEvent:!1}))}},{key:"registerOnChange",value:function(e){this.attributesArray.valueChanges.subscribe(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){e?this.attributesArray.disable():this.attributesArray.enable()}},{key:"validate",value:function(e){return this.attributesForm.valid?null:{invalidForm:{valid:!1,message:"attributes are invalid"}}}},{key:"discoverWidget",value:function(e){return this.wpm.getPlugin(e)}},{key:"applyValues",value:function(){var e=this;this.attributesArray.controls.forEach(function(u,s){var c=e.attributeValues?e.attributeValues.find(function(g){return g.name===u.get("name").value}):void 0;void 0!==c&&(u.get("value").setValue(c.value),u.updateValueAndValidity()),u.get("attributes").controls.forEach(function(g){var P=e.attributeValues&&void 0!==e.attributeValues[s]?e.attributeValues[s].attributes.find(function(x){return x.name===g.get("name").value}):void 0;void 0!==P&&(g.get("value").setValue(P.value),g.updateValueAndValidity())})})}}])}();return(n=i).\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(V),t.\u0275\u0275directiveInject(F))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["classifieds-ui-attributes-builder"]],inputs:{attributes:"attributes",appearance:"appearance",attributeValues:"attributeValues"},standalone:!1,features:[t.\u0275\u0275ProvidersFeature([V,{provide:a.NG_VALUE_ACCESSOR,useExisting:(0,t.forwardRef)(function(){return n}),multi:!0},{provide:a.NG_VALIDATORS,useExisting:(0,t.forwardRef)(function(){return n}),multi:!0}]),t.\u0275\u0275NgOnChangesFeature],decls:4,vars:3,consts:[[3,"formGroup"],["formArrayName","attributes",1,"attribute-fields"],["class","attribute-field-container",3,"formGroupName",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"attribute-field-container",3,"formGroupName"],[3,"attribute","widget","appearance"]],template:function(r,e){1&r&&(t.\u0275\u0275elementContainerStart(0,0),t.\u0275\u0275elementStart(1,"div",1),t.\u0275\u0275template(2,N,2,5,"div",2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd(),t.\u0275\u0275template(3,v,3,0,"div",3)),2&r&&(t.\u0275\u0275property("formGroup",e.attributesForm),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",e.attributesArray.controls),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",0==e.attributes.length))},dependencies:[f.NgForOf,f.NgIf,a.NgControlStatusGroup,a.FormGroupDirective,a.FormGroupName,a.FormArrayName,y],encapsulation:2}),i}(),M=function(){var n,i=(0,l.A)(function o(r){(0,m.A)(this,o),this.controlContainer=r,this.appearance="legacy"});return(n=i).\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(a.ControlContainer))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["classifieds-ui-text-widget"]],inputs:{attribute:"attribute",appearance:"appearance"},standalone:!1,decls:3,vars:3,consts:[[3,"formGroup"],[3,"appearance"],["matInput","","formControlName","value",3,"placeholder"]],template:function(r,e){1&r&&(t.\u0275\u0275elementContainerStart(0,0),t.\u0275\u0275elementStart(1,"mat-form-field",1),t.\u0275\u0275element(2,"input",2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()),2&r&&(t.\u0275\u0275property("formGroup",e.controlContainer.control),t.\u0275\u0275advance(),t.\u0275\u0275property("appearance",e.appearance),t.\u0275\u0275advance(),t.\u0275\u0275property("placeholder",e.attribute.label))},dependencies:[a.DefaultValueAccessor,a.NgControlStatus,a.NgControlStatusGroup,a.FormGroupDirective,a.FormControlName,W.MatInput,W.MatFormField],encapsulation:2}),i}(),T=function(){var n,i=(0,l.A)(function o(r){(0,m.A)(this,o),this.controlContainer=r});return(n=i).\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(a.ControlContainer))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["classifieds-ui-min-max-widget"]],inputs:{attribute:"attribute"},standalone:!1,decls:8,vars:4,consts:[[3,"formGroup"],["formArrayName","attributes"],["formGroupName","0"],["matInput","","type","number","formControlName","value",3,"placeholder"],["formGroupName","1"]],template:function(r,e){1&r&&(t.\u0275\u0275elementContainerStart(0,0),t.\u0275\u0275elementStart(1,"label"),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"div",1)(4,"mat-form-field",2),t.\u0275\u0275element(5,"input",3),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"mat-form-field",4),t.\u0275\u0275element(7,"input",3),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementContainerEnd()),2&r&&(t.\u0275\u0275property("formGroup",e.controlContainer.control),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(e.attribute.label),t.\u0275\u0275advance(3),t.\u0275\u0275property("placeholder",e.attribute.attributes[0].label),t.\u0275\u0275advance(2),t.\u0275\u0275property("placeholder",e.attribute.attributes[1].label))},dependencies:[a.DefaultValueAccessor,a.NumberValueAccessor,a.NgControlStatus,a.NgControlStatusGroup,a.FormGroupDirective,a.FormControlName,a.FormGroupName,a.FormArrayName,W.MatInput,W.MatFormField],encapsulation:2}),i}(),L=function(){var n,i=function(){return(0,l.A)(function o(){(0,m.A)(this,o)},[{key:"getComputedValue",value:function(e,u){var s=u&&u.length>0&&this.matchAttribute(e,u);if(s)return s.computedValue}},{key:"getValue",value:function(e,u){var s=u&&u.length>0&&this.matchAttribute(e,u);if(s)return s.value}},{key:"matchAttribute",value:function(e,u){for(var s=u.length,c=0;c<s;c++)if(u[c].attributes&&u[c].attributes.length>0){if(this.matchAttribute(e,u[c].attributes))return u[c]}else if(e===u[c].name)return u[c]}}])}();return(n=i).\u0275fac=function(r){return new(r||n)},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),i}(),z=function(){var n,i=function(){return(0,l.A)(function o(r){(0,m.A)(this,o),this.attributeMatcher=r},[{key:"transform",value:function(e,u){return this.attributeMatcher.getComputedValue(u,e)||""}}])}();return(n=i).\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(L,16))},n.\u0275pipe=t.\u0275\u0275definePipe({name:"attribute",type:n,pure:!0,standalone:!1}),i}(),p=function(n){return n[n.Number=0]="Number",n[n.Text=1]="Text",n[n.Complex=2]="Complex",n[n.Float=3]="Float",n[n.Array=4]="Array",n[n.Bool=5]="Bool",n[n.Date=6]="Date",n}(p||{}),$=function(n){function i(o){var r;return(0,m.A)(this,i),r=(0,_.A)(this,i,[o]),o&&(r.name=r.id,r.schema=o.schema?new H(o.schema):void 0,r.component=o.component),r}return(0,D.A)(i,n),(0,l.A)(i)}(O.Plugin),H=(0,l.A)(function n(i){(0,m.A)(this,n),this.attributes=[],i&&(this.name=i.name,this.widget=void 0!==i.widget?i.widget:"text",this.type=i.type,this.label=i.label,this.required=i.required,this.options=i.options,i.attributes&&(this.attributes=i.attributes.map(function(o){return new n(o)})))}),I=(0,l.A)(function n(i){(0,m.A)(this,n),this.attributes=[],i&&(this.name=i.name,this.displayName=i.displayName,this.type=i.type,this.value=i.value,this.intValue=i.intValue,this.computedValue=i.computedValue,i.attributes&&(Array.isArray(i.attributes)?this.attributes=i.attributes.reduce(function(o,r){return void 0===r._store||r._store?[].concat((0,w.A)(o),[new n(r)]):o},[]):(void 0===i.attributes._store||i.attributes._store)&&(this.attributes=[i.attributes])),i.value&&"object"==typeof i.value?(this.value=void 0,this.type=p.Complex,i.value.attributes.reduce(function(o,r){return void 0===r._store||r._store?[].concat((0,w.A)(o),[new n(r)]):o},[])):this.value=i.value)}),X=function(){var i=new H({name:"",type:p.Text,label:"",required:!1,widget:"text",options:{},attributes:[]});return new $({id:"text",name:"text",title:"Text",component:M,schema:i})},Y=function(){return new $({id:"minmax",name:"minmax",title:"MinMax",component:T,schema:void 0})},q=function(){var n,i=(0,l.A)(function o(r,e){(0,m.A)(this,o),r.forEach(function(u){return e.register(u)})});return(n=i).\u0275fac=function(r){return new(r||n)(t.\u0275\u0275inject(h),t.\u0275\u0275inject(F))},n.\u0275mod=t.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=t.\u0275\u0275defineInjector({providers:[{provide:h,useFactory:X,multi:!0},{provide:h,useFactory:Y,multi:!0},(0,b.provideHttpClient)((0,b.withJsonpSupport)())],imports:[f.CommonModule,a.ReactiveFormsModule,E.MaterialModule]}),i}(),Q=function(){var n,i=function(){return(0,l.A)(function o(){(0,m.A)(this,o)},[{key:"compute",value:function(e){var u=this,s=[];return e.forEach(function(c){return s.push(u.computeAttribute(c))}),s}},{key:"computeAttribute",value:function(e){var u=this.resolveComputedValue(e.value,e.type);return new I((0,A.A)((0,A.A)({},e),{},e.attributes&&e.attributes.length>0?{computedValue:u,attributes:this.compute(e.attributes)}:{computedValue:u}))}},{key:"resolveComputedValue",value:function(e,u){var s;return u===p.Number?(s=(0,S.Ro)(e.trim()))&&isNaN(s)&&(s=void 0):s=e.trim(),void 0===s?s:"".concat(s)}}])}();return(n=i).\u0275fac=function(r){return new(r||n)},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),i}(),Z=function(){var n,i=function(){return(0,l.A)(function o(r){(0,m.A)(this,o),this.valueComputer=r},[{key:"serialize",value:function(e,u){var s=typeof e;if("object"!==s)return new I({name:u,type:"string"!==s?"boolean"!==s?p.Number:p.Bool:p.Text,displayName:u,value:"".concat(e),intValue:void 0,computedValue:this.valueComputer.resolveComputedValue("".concat(e),"string"!==s?"boolean"!==s?p.Number:p.Bool:p.Text),attributes:[]});if(Array.isArray(e)&&("attributes"===u||"settings"===u))return new I({name:u,type:p.Complex,displayName:u,value:void 0,intValue:void 0,computedValue:void 0,attributes:e});if(Array.isArray(e)){for(var c=e.length,g=[],P=0;P<c;P++)g.push(this.serialize(e[P],"".concat(P)));return new I({name:u,type:p.Array,displayName:u,value:void 0,intValue:void 0,computedValue:void 0,attributes:g})}if(e instanceof Date)return new I({name:u,type:p.Date,displayName:u,value:e.toJSON(),intValue:void 0,computedValue:e.toJSON(),attributes:[]});var x=[];for(var J in e)x.push(this.serialize(e[J],J));return new I({name:u,type:p.Complex,displayName:u,value:void 0,intValue:void 0,computedValue:void 0,attributes:x})}},{key:"deserializeAsObject",value:function(e){var u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.deserialize(new I({name:"root",type:p.Complex,displayName:"root",value:void 0,computedValue:void 0,intValue:0,attributes:e}),u)}},{key:"deserialize",value:function(e){var s,c,u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e.type){case p.Complex:if(u||"attributes"!==e.name&&"settings"!==e.name){c=e.attributes.length;for(var g=0;g<c;g++)s=(0,A.A)((0,A.A)({},s),{},(0,B.A)({},e.attributes[g].name,this.deserialize(e.attributes[g])))}else s=e.attributes.map(function(x){return new I(x)});break;case p.Bool:s=void 0!==e.value?["1","true","on"].findIndex(function(x){return x===e.value})>-1:void 0;break;case p.Number:case p.Float:s=void 0!==e.value&&""!==e.value&&"undefined"!==e.value?"0"!==e.value?(0,S.Ro)(e.value.trim()):0:void 0;break;case p.Text:s=e.value;break;case p.Array:if(u||"attributes"!==e.name&&"settings"!==e.name){c=e.attributes.length,s=[];for(var P=0;P<c;P++)s=[].concat((0,w.A)(s),[this.deserialize(e.attributes[P])])}else s=e.attributes.map(function(x){return new I(x)});break;case p.Date:s=void 0!==e.value&&""!==e.value?new Date(e.value):void 0}return s}},{key:"convertToGroup",value:function(e){var u=this,s=new a.UntypedFormGroup({name:new a.UntypedFormControl(e.name,a.Validators.required),type:new a.UntypedFormControl(e.type,a.Validators.required),displayName:new a.UntypedFormControl(e.displayName,a.Validators.required),value:new a.UntypedFormControl(e.value,a.Validators.required),computedValue:new a.UntypedFormControl(e.value,a.Validators.required),attributes:new a.UntypedFormArray([])});return e.attributes&&e.attributes.length>0&&e.attributes.forEach(function(c){s.get("attributes").push(u.convertToGroup(c))}),s}}])}();return(n=i).\u0275fac=function(r){return new(r||n)(t.\u0275\u0275inject(Q))},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),i}()},40642:(K,k,d)=>{d.d(k,{A:()=>A});var B=d(91436);function A(w,_,D){return(_=(0,B.A)(_))in w?Object.defineProperty(w,_,{value:D,enumerable:!0,configurable:!0,writable:!0}):w[_]=D,w}},22292:(K,k,d)=>{d.d(k,{A:()=>w});var B=d(40642);function A(_,D){var m=Object.keys(_);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(_);D&&(l=l.filter(function(t){return Object.getOwnPropertyDescriptor(_,t).enumerable})),m.push.apply(m,l)}return m}function w(_){for(var D=1;D<arguments.length;D++){var m=null!=arguments[D]?arguments[D]:{};D%2?A(Object(m),!0).forEach(function(l){(0,B.A)(_,l,m[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(m)):A(Object(m)).forEach(function(l){Object.defineProperty(_,l,Object.getOwnPropertyDescriptor(m,l))})}return _}}}]);
//# sourceMappingURL=5667.b3c9aa0e9d1e47d9.js.map