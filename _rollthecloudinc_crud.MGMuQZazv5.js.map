{
  "version": 3,
  "sources": ["../../@rollthecloudinc/crud/fesm2022/rollthecloudinc-crud.mjs"],
  "sourcesContent": ["import { CommonModule } from '@angular/common';\nimport * as i0 from '@angular/core';\nimport { forwardRef, Input, Component, Injectable, NgModule } from '@angular/core';\nimport * as i1 from '@angular/forms';\nimport { NG_VALUE_ACCESSOR, NG_VALIDATORS, ReactiveFormsModule, FormsModule } from '@angular/forms';\nimport * as i4 from '@rollthecloudinc/context';\nimport { ContextModule } from '@rollthecloudinc/context';\nimport * as i6 from '@rollthecloudinc/dparam';\nimport { Param, DparamModule } from '@rollthecloudinc/dparam';\nimport { MaterialModule } from '@rollthecloudinc/material';\nimport { BehaviorSubject, combineLatest, of, forkJoin, iif, Observable, ReplaySubject } from 'rxjs';\nimport { map, tap, filter, delay, debounceTime, switchMap, take, defaultIfEmpty } from 'rxjs/operators';\nimport qs from 'qs';\nimport * as i1$1 from '@rollthecloudinc/plugin';\nimport { Plugin, BasePluginManager, PluginDef } from '@rollthecloudinc/plugin';\nimport * as i2 from '@rollthecloudinc/attributes';\nimport * as i3 from '@angular/material/input';\nimport * as i1$2 from '@rollthecloudinc/datasource';\nimport { DatasourcePlugin, DatasourceEditorOptions, Dataset } from '@rollthecloudinc/datasource';\nimport * as i3$1 from '@rollthecloudinc/refinery';\nimport { DataductPlugin, DuctdataOutput } from '@rollthecloudinc/refinery';\nimport * as uuid from 'uuid';\nimport * as i2$1 from '@rollthecloudinc/utils';\nimport * as jre from 'json-rules-engine';\nimport * as rd from 'recursive-diff';\nimport * as i8 from '@rollthecloudinc/durl';\nclass CrudAdaptorPlugin extends Plugin {\n  constructor(data) {\n    super(data);\n    if (data) {\n      this.create = data.create;\n      this.read = data.read;\n      this.update = data.update;\n      this.delete = data.delete;\n      if (data.query) {\n        this.query = data.query;\n      }\n    }\n  }\n}\nclass CrudAdaptorDatasource {\n  constructor(data) {\n    this.options = [];\n    this.params = [];\n    if (data) {\n      this.adaptorName = data.adaptorName;\n      this.optionsString = data.optionsString ? data.optionsString : undefined;\n      this.paramsString = data.paramsString ? data.paramsString : undefined;\n      if (data.options && Array.isArray(data.options)) {\n        this.options = data.options.map(o => new Param(o));\n      }\n      if (data.params && Array.isArray(data.params)) {\n        this.params = data.params.map(p => new Param(p));\n      }\n    }\n  }\n}\nlet CrudAdaptorDatasourceFormComponent = /*#__PURE__*/(() => {\n  class CrudAdaptorDatasourceFormComponent {\n    set settings(settings) {\n      this.settings$.next(settings);\n    }\n    constructor(fb, attributeSerializer) {\n      this.fb = fb;\n      this.attributeSerializer = attributeSerializer;\n      this.contexts = [];\n      this.settings$ = new BehaviorSubject(undefined);\n      this.datasource$ = new BehaviorSubject(undefined);\n      this.optionValues$ = new BehaviorSubject([]);\n      this.paramValues$ = new BehaviorSubject([]);\n      this.formGroup = this.fb.group({\n        adaptorName: this.fb.control(''),\n        optionsString: this.fb.control(''),\n        paramsString: this.fb.control(''),\n        options: this.fb.control([]),\n        params: this.fb.control([])\n      });\n      this.settingsSub = this.settings$.pipe(map(s => s ? new CrudAdaptorDatasource(this.attributeSerializer.deserializeAsObject(s)) : undefined), tap(ds => setTimeout(() => this.datasource$.next(ds)))).subscribe(ds => {\n        if (ds) {\n          this.formGroup.get('adaptorName').setValue(ds.adaptorName);\n          this.formGroup.get('optionsString').setValue(ds.optionsString ? ds.optionsString : '');\n          this.formGroup.get('paramsString').setValue(ds.paramsString ? ds.paramsString : '');\n        } else {\n          this.formGroup.get('adaptorName').setValue('');\n          this.formGroup.get('optionsString').setValue('');\n          this.formGroup.get('paramsString').setValue('');\n          setTimeout(() => this.optionValues$.next([]), 2);\n          setTimeout(() => this.optionValues$.next([]), 2);\n        }\n      });\n      this.datasourceOptionsSub = combineLatest([this.datasource$, this.formGroup.get('optionsString').valueChanges]).pipe(filter(([ds]) => ds !== undefined), delay(1), tap(([ds]) => this.optionValues$.next(ds.options))).subscribe();\n      this.datasourceParamsSub = combineLatest([this.datasource$, this.formGroup.get('paramsString').valueChanges]).pipe(filter(([ds]) => ds !== undefined), delay(1), tap(([ds]) => this.paramValues$.next(ds.params))).subscribe();\n      this.optionsStringChangeSub = this.formGroup.get('optionsString').valueChanges.pipe(debounceTime(500)).subscribe(optionsString => {\n        const parsed = qs.parse('?' + optionsString);\n        this.optionsParsed = parsed;\n      });\n      this.paramsStringChangeSub = this.formGroup.get('paramsString').valueChanges.pipe(debounceTime(500)).subscribe(paramsString => {\n        const parsed = qs.parse('?' + paramsString);\n        this.paramsParsed = parsed;\n      });\n      this.onTouched = () => {};\n    }\n    ngOnInit() {}\n    writeValue(val) {\n      if (val) {\n        this.formGroup.setValue(val, {\n          emitEvent: false\n        });\n      }\n    }\n    registerOnChange(fn) {\n      this.formGroup.valueChanges.subscribe(fn);\n    }\n    registerOnTouched(fn) {\n      this.onTouched = fn;\n    }\n    setDisabledState(isDisabled) {\n      if (isDisabled) {\n        this.formGroup.disable();\n      } else {\n        this.formGroup.enable();\n      }\n    }\n    validate(c) {\n      return this.formGroup.valid ? null : this.formGroup.errors;\n    }\n    static {\n      this.\u0275fac = function CrudAdaptorDatasourceFormComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || CrudAdaptorDatasourceFormComponent)(i0.\u0275\u0275directiveInject(i1.UntypedFormBuilder), i0.\u0275\u0275directiveInject(i2.AttributeSerializerService));\n      };\n    }\n    static {\n      this.\u0275cmp = /* @__PURE__ */i0.\u0275\u0275defineComponent({\n        type: CrudAdaptorDatasourceFormComponent,\n        selectors: [[\"classifieds-ui-crud-adaptor-datasource-form\"]],\n        inputs: {\n          contexts: \"contexts\",\n          settings: \"settings\"\n        },\n        standalone: false,\n        features: [i0.\u0275\u0275ProvidersFeature([{\n          provide: NG_VALUE_ACCESSOR,\n          useExisting: forwardRef(() => CrudAdaptorDatasourceFormComponent),\n          multi: true\n        }, {\n          provide: NG_VALIDATORS,\n          useExisting: forwardRef(() => CrudAdaptorDatasourceFormComponent),\n          multi: true\n        }])],\n        decls: 14,\n        vars: 7,\n        consts: [[3, \"formGroup\"], [\"matInput\", \"\", \"placeholder\", \"Adaptor\", \"formControlName\", \"adaptorName\", \"required\", \"\"], [1, \"options-container\"], [\"matInput\", \"\", \"placeholder\", \"Options\", \"formControlName\", \"optionsString\"], [\"formControlName\", \"options\", 3, \"params\", \"paramValues\", \"contexts\"], [1, \"params-container\"], [\"matInput\", \"\", \"placeholder\", \"Params\", \"formControlName\", \"paramsString\"], [\"formControlName\", \"params\", 3, \"params\", \"paramValues\", \"contexts\"]],\n        template: function CrudAdaptorDatasourceFormComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.\u0275\u0275elementStart(0, \"div\", 0)(1, \"div\")(2, \"mat-form-field\");\n            i0.\u0275\u0275element(3, \"input\", 1);\n            i0.\u0275\u0275elementEnd()();\n            i0.\u0275\u0275elementStart(4, \"div\", 2)(5, \"div\")(6, \"mat-form-field\");\n            i0.\u0275\u0275element(7, \"input\", 3);\n            i0.\u0275\u0275elementEnd()();\n            i0.\u0275\u0275element(8, \"classifieds-ui-params-form\", 4);\n            i0.\u0275\u0275elementEnd();\n            i0.\u0275\u0275elementStart(9, \"div\", 5)(10, \"div\")(11, \"mat-form-field\");\n            i0.\u0275\u0275element(12, \"input\", 6);\n            i0.\u0275\u0275elementEnd()();\n            i0.\u0275\u0275element(13, \"classifieds-ui-params-form\", 7);\n            i0.\u0275\u0275elementEnd()();\n          }\n          if (rf & 2) {\n            i0.\u0275\u0275property(\"formGroup\", ctx.formGroup);\n            i0.\u0275\u0275advance(8);\n            i0.\u0275\u0275property(\"params\", ctx.optionsParsed)(\"paramValues\", ctx.optionValues$.value)(\"contexts\", ctx.contexts);\n            i0.\u0275\u0275advance(5);\n            i0.\u0275\u0275property(\"params\", ctx.paramsParsed)(\"paramValues\", ctx.paramValues$.value)(\"contexts\", ctx.contexts);\n          }\n        },\n        dependencies: [i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.RequiredValidator, i1.FormGroupDirective, i1.FormControlName, i3.MatInput, i3.MatFormField, i6.ParamsFormComponent],\n        encapsulation: 2\n      });\n    }\n  }\n  return CrudAdaptorDatasourceFormComponent;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet CrudAdaptorDatasourceComponent = /*#__PURE__*/(() => {\n  class CrudAdaptorDatasourceComponent {\n    constructor(controlContainer) {\n      this.controlContainer = controlContainer;\n      this.settings = [];\n      this.contexts = [];\n    }\n    static {\n      this.\u0275fac = function CrudAdaptorDatasourceComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || CrudAdaptorDatasourceComponent)(i0.\u0275\u0275directiveInject(i1.ControlContainer));\n      };\n    }\n    static {\n      this.\u0275cmp = /* @__PURE__ */i0.\u0275\u0275defineComponent({\n        type: CrudAdaptorDatasourceComponent,\n        selectors: [[\"classifieds-ui-crud-adaptor-datasource\"]],\n        inputs: {\n          settings: \"settings\",\n          contexts: \"contexts\"\n        },\n        standalone: false,\n        decls: 2,\n        vars: 3,\n        consts: [[3, \"formGroup\"], [\"formControlName\", \"settings\", 3, \"settings\", \"contexts\"]],\n        template: function CrudAdaptorDatasourceComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.\u0275\u0275elementContainerStart(0, 0);\n            i0.\u0275\u0275element(1, \"classifieds-ui-crud-adaptor-datasource-form\", 1);\n            i0.\u0275\u0275elementContainerEnd();\n          }\n          if (rf & 2) {\n            i0.\u0275\u0275property(\"formGroup\", ctx.controlContainer.control);\n            i0.\u0275\u0275advance();\n            i0.\u0275\u0275property(\"settings\", ctx.settings)(\"contexts\", ctx.contexts);\n          }\n        },\n        dependencies: [i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, CrudAdaptorDatasourceFormComponent],\n        encapsulation: 2\n      });\n    }\n  }\n  return CrudAdaptorDatasourceComponent;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n// import { ParamContextExtractorService } from '@rollthecloudinc/context';\nconst crudAdaptorDatasourcePluginFactory = (paramContextExtractor, attributeSerializer, cpm, paramEvaluatorService, crudDataHelper, urlGenerator) => {\n  return new DatasourcePlugin({\n    id: 'crud_adaptor',\n    title: 'Crud Adaptor',\n    editor: CrudAdaptorDatasourceComponent,\n    fetch: ({\n      settings,\n      metadata\n    }) => of(new Dataset()).pipe(map(() => attributeSerializer.deserializeAsObject(settings)), map(s => new CrudAdaptorDatasource(s)), switchMap(ds => cpm.getPlugin(ds.adaptorName).pipe(map(plugin => ({\n      plugin,\n      ds\n    })))), map(({\n      plugin,\n      ds\n    }) => ({\n      plugin,\n      ds,\n      optionNames: ds.optionsString ? ds.optionsString.split('&').filter(v => v.indexOf('=:') !== -1).map(v => v.split('=', 2)[1].substr(1)) : []\n    })), switchMap(({\n      plugin,\n      ds,\n      optionNames\n    }) => forkJoin([paramEvaluatorService.paramValues(ds.options.reduce((p, c, i) => new Map([...p, [optionNames[i], c]]), new Map())).pipe(map(params => Array.from(params).reduce((p, [k, v]) => ({\n      ...p,\n      [k]: v\n    }), {}))), ds.paramsString && ds.paramsString !== '' ? urlGenerator.getUrl('?' + ds.paramsString, ds.params, metadata).pipe(take(1)) : of(undefined)]).pipe(map(([options, query]) => ({\n      plugin,\n      options,\n      query\n    })))), switchMap(({\n      plugin,\n      options,\n      query\n    }) => crudDataHelper.evaluateCollectionPlugins({\n      plugins: {\n        [plugin.id]: {\n          params: options\n        }\n      },\n      op: 'query',\n      query: query ? query.substr(1) : query\n    })), map(results => new Dataset({\n      results\n    }))),\n    editorOptions: () => of(new DatasourceEditorOptions({\n      fullscreen: true\n    })),\n    getBindings: ({\n      settings,\n      metadata\n    }) => of([]) /*.pipe(\n                 map(() => attributeSerializer.deserializeAsObject(settings)),\n                 map<any, CrudAdaptorDatasource>(s => new EntityDatasource(s)),\n                 switchMap(ds => paramContextExtractor.extractContexts(ds.params)),\n                 map(contexts => contexts.map(id => new ContentBinding({ id, type: 'context' })))\n                 )*/\n  });\n};\nconst crudDataductPluginFactory = ({\n  crudDataHelper,\n  attributeSerializer\n}) => new DataductPlugin({\n  id: 'crud',\n  title: 'Crud',\n  editor: CrudAdaptorDatasourceComponent,\n  send: input => of(new DuctdataOutput({})).pipe(map(() => ({\n    settings: attributeSerializer.deserializeAsObject(input.settings)\n  })), tap(({\n    settings\n  }) => console.log('crud data duct', settings)), map(({\n    settings\n  }) => ({\n    plugins: {\n      [`${settings.adaptorName}`]: {\n        plugin: `${settings.adaptorName}`,\n        ops: ['create'],\n        params: `${settings.optionsString}`.split('&').reduce((p, c, i) => ({\n          ...p,\n          [c.split('=', 1)[0]]: new Param(settings.options[i])\n        }), {})\n      }\n    }\n  })), switchMap(({\n    plugins\n  }) => crudDataHelper.evaluatePlugins({\n    object: input.data,\n    plugins,\n    op: 'create',\n    parentObject: {\n      id: uuid.v4()\n    }\n  })), map(() => new DuctdataOutput({})))\n});\nlet CrudAdaptorPluginManager = /*#__PURE__*/(() => {\n  class CrudAdaptorPluginManager extends BasePluginManager {\n    constructor(pcm, moduleLoader) {\n      super(pcm, moduleLoader);\n    }\n    pluginDef() {\n      return of(new PluginDef({\n        name: 'crud_adaptor'\n      }));\n    }\n    static {\n      this.\u0275fac = function CrudAdaptorPluginManager_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || CrudAdaptorPluginManager)(i0.\u0275\u0275inject(i1$1.PluginConfigurationManager), i0.\u0275\u0275inject(i2$1.ModuleLoaderService));\n      };\n    }\n    static {\n      this.\u0275prov = /* @__PURE__ */i0.\u0275\u0275defineInjectable({\n        token: CrudAdaptorPluginManager,\n        factory: CrudAdaptorPluginManager.\u0275fac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return CrudAdaptorPluginManager;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet CrudDataHelperService = /*#__PURE__*/(() => {\n  class CrudDataHelperService {\n    constructor(crud) {\n      this.crud = crud;\n      this.cachedCollectionQueries = [];\n      this.cachedCollectionIgnore = {\n        p: {\n          create: undefined,\n          update: undefined,\n          delete: undefined,\n          query: undefined,\n          read: undefined\n        },\n        input: {\n          identity: undefined\n        }\n      };\n    }\n    evaluatePlugins({\n      object,\n      plugins,\n      op,\n      parentObject\n    }) {\n      const adaptors = Object.keys(plugins);\n      const operations$ = adaptors.filter(a => !plugins[a].ops || plugins[a].ops.includes(op)).map(a => this.crud.getPlugin(plugins[a].plugin ? plugins[a].plugin : a).pipe(map(p => ({\n        p,\n        params: plugins[a].params ? Object.keys(plugins[a].params).reduce((p, name) => ({\n          ...p,\n          [name]: plugins[a].params[name] instanceof Param ? plugins[a].params[name] : new Param({\n            flags: [],\n            mapping: {\n              type: 'static',\n              value: plugins[a].params[name],\n              context: undefined,\n              testValue: plugins[a].params[name]\n            }\n          })\n        }), {}) : {}\n      })), switchMap(({\n        p,\n        params\n      }) => p[op]({\n        rule: undefined,\n        object,\n        parentObject,\n        params,\n        identity: ({\n          object,\n          parentObject\n        }) => of({\n          identity: object.id ? object.id : parentObject ? parentObject.id : undefined\n        })\n      })), switchMap(res => iif(() => plugins[a].plugins && Object.keys(plugins[a].plugins).length !== 0, plugins[a].plugins && Object.keys(plugins[a].plugins).length !== 0 ? this.evaluatePlugins({\n        plugins: plugins[a].plugins,\n        object: res.entity ? res.entity : object,\n        parentObject: res.originalEntity ? res.originalEntity : object,\n        op\n      }) : of(res), of(res)))));\n      return forkJoin(operations$).pipe(map(() => object));\n    }\n    evaluateCollectionPlugins({\n      query,\n      objects,\n      plugins,\n      op,\n      parentObjects\n    }) {\n      console.log('evaluate collection plugins');\n      const adaptors = Object.keys(plugins);\n      const operations$ = adaptors.filter(a => !plugins[a].ops || plugins[a].ops.includes(op)).map(a => this.crud.getPlugin(plugins[a].plugin ? plugins[a].plugin : a).pipe(map(p => ({\n        p,\n        params: plugins[a].params ? Object.keys(plugins[a].params).reduce((p, name) => ({\n          ...p,\n          [name]: plugins[a].params[name] instanceof Param ? plugins[a].params[name] : new Param({\n            flags: [],\n            mapping: {\n              type: 'static',\n              value: plugins[a].params[name],\n              context: undefined,\n              testValue: plugins[a].params[name]\n            }\n          })\n        }), {}) : {}\n      })), switchMap(({\n        p,\n        params\n      }) => this.buildQueryRule({\n        params: query,\n        config: plugins[a]\n      }).pipe(map(({\n        rule\n      }) => ({\n        p,\n        params,\n        rule\n      })))),\n      // tap(({ params, rule }) => console.log('right before collection plugin query', params, rule)),\n      // switchMap(({ p, params, rule }) => p.query({ rule, objects, parentObjects, params, identity: ({ object, parentObject }) => of({ identity: object.id ? object.id : parentObject ? parentObject.id : undefined }) }).pipe(\n      switchMap(({\n        p,\n        params,\n        rule\n      }) => this.flightAndCacheAwareCollectionQuery({\n        p,\n        input: {\n          rule,\n          objects,\n          parentObjects,\n          params,\n          identity: ({\n            object,\n            parentObject\n          }) => of({\n            identity: object.id ? object.id : parentObject ? parentObject.id : undefined\n          })\n        }\n      }).pipe(tap(() => console.log('end of crud query call')))),\n      // tap(res => console.log('right before nested collection plugins', res)),\n      switchMap(res => iif(() => plugins[a].plugins && Object.keys(plugins[a].plugins).length !== 0, this.evaluateCollectionPlugins({\n        query,\n        plugins: plugins[a].plugins && Object.keys(plugins[a].plugins).length !== 0 ? plugins[a].plugins : {},\n        objects: res.entities ? res.entities : objects,\n        parentObjects: res.originalEntities ? res.originalEntities : objects,\n        op\n      }), of(res))), tap(res => console.log('end of op', res))));\n      const fallback = adaptors.filter(a => !plugins[a].ops || plugins[a].ops.includes(op)).find(a => plugins[a].fallback);\n      if (fallback && operations$.length > 1) {\n        return operations$.reduce((p, c) => p.pipe(switchMap(entities => entities && Array.isArray(entities) && entities.length > 0 ? of(entities) : c.pipe(map(c => c && c.entities && Array.isArray(c.entities) ? c.entities : []))), switchMap(entities => entities.length > 0 ? of(entities) : of([]))), of([]));\n      } else {\n        return operations$.length === 1 ? operations$[0].pipe(map(c => [...c.entities])) : forkJoin(operations$).pipe(map(responses => responses.reduce((p, c) => [...p, ...c.entities], [])), defaultIfEmpty([]));\n      }\n    }\n    buildQueryRule({\n      params,\n      config\n    }) {\n      return new Observable(obs => {\n        // const metadata = this.entityDefinitionService.getDefinition(this.entityName).metadata as CrudEntityMetadata<any, {}>;\n        const conditions = [];\n        // KISS for now - use qs later - move to reusable function probably inside durl. First lets proof it out with one level.\n        if (typeof params === 'string') {\n          const pieces = params.split('&').map(p => p.split('=', 2)).reduce((p, [name, value]) => new Map([...Array.from(p).filter(([k, _]) => k !== name), [name, [...(p.has(name) ? p.get(name) : []), value]]]), new Map());\n          pieces.forEach((values, name) => conditions.push({\n            any: values.map(value => ({\n              fact: name === 'identity' ? 'identity' : 'entity',\n              operator: config.queryMappings && config.queryMappings.has(name) && config.queryMappings.get(name).defaultOperator ? config.queryMappings.get(name).defaultOperator : 'equal',\n              value,\n              ...(name === 'identity' ? {} : {\n                path: `$.${name}`\n              })\n            }))\n          }));\n        }\n        const rule = conditions.length > 0 ? new jre.Rule({\n          conditions: {\n            all: conditions\n          },\n          event: {\n            type: 'visible'\n          }\n        }) : undefined;\n        obs.next({\n          rule\n        });\n        obs.complete();\n      });\n    }\n    flightAndCacheAwareCollectionQuery(q) {\n      // console.log('flightAndCacheAwareCollectionQuery', q.p, q.input);\n      let matchedIndex = this.cachedCollectionQueries.findIndex(({\n        p,\n        input\n      }) => {\n        const pDiff = rd.getDiff({\n          ...q.p,\n          ...this.cachedCollectionIgnore.p\n        }, {\n          ...p,\n          ...this.cachedCollectionIgnore.p\n        });\n        const iDiff = rd.getDiff({\n          ...q.input,\n          ...this.cachedCollectionIgnore.input\n        }, {\n          ...input,\n          ...this.cachedCollectionIgnore.input\n        });\n        // console.log('pDiff', pDiff);\n        // console.log('iDiff', iDiff);\n        return pDiff.length === 0 && iDiff.length === 0;\n      });\n      if (matchedIndex === -1) {\n        this.cachedCollectionQueries.push({\n          p: q.p,\n          input: q.input,\n          query$: new ReplaySubject()\n        });\n        matchedIndex = this.cachedCollectionQueries.length - 1;\n        q.p.query(q.input).pipe(tap(res => this.cachedCollectionQueries[matchedIndex].query$.next(res)), take(1)).subscribe();\n      }\n      return this.cachedCollectionQueries[matchedIndex].query$.pipe(take(1));\n    }\n    static {\n      this.\u0275fac = function CrudDataHelperService_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || CrudDataHelperService)(i0.\u0275\u0275inject(CrudAdaptorPluginManager));\n      };\n    }\n    static {\n      this.\u0275prov = /* @__PURE__ */i0.\u0275\u0275defineInjectable({\n        token: CrudDataHelperService,\n        factory: CrudDataHelperService.\u0275fac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return CrudDataHelperService;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet CrudModule = /*#__PURE__*/(() => {\n  class CrudModule {\n    constructor(dpm, cpm, ddpm, paramContextExtractor, attributeSerializer, paramEvaluatorService, crudDataHelper, urlGenerator) {\n      dpm.register(crudAdaptorDatasourcePluginFactory(paramContextExtractor, attributeSerializer, cpm, paramEvaluatorService, crudDataHelper, urlGenerator));\n      ddpm.register(crudDataductPluginFactory({\n        crudDataHelper,\n        attributeSerializer\n      }));\n    }\n    static {\n      this.\u0275fac = function CrudModule_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || CrudModule)(i0.\u0275\u0275inject(i1$2.DatasourcePluginManager), i0.\u0275\u0275inject(CrudAdaptorPluginManager), i0.\u0275\u0275inject(i3$1.DataductPluginManager), i0.\u0275\u0275inject(i4.ParamContextExtractorService), i0.\u0275\u0275inject(i2.AttributeSerializerService), i0.\u0275\u0275inject(i6.ParamEvaluatorService), i0.\u0275\u0275inject(CrudDataHelperService), i0.\u0275\u0275inject(i8.UrlGeneratorService));\n      };\n    }\n    static {\n      this.\u0275mod = /* @__PURE__ */i0.\u0275\u0275defineNgModule({\n        type: CrudModule\n      });\n    }\n    static {\n      this.\u0275inj = /* @__PURE__ */i0.\u0275\u0275defineInjector({\n        imports: [CommonModule, ReactiveFormsModule, FormsModule, MaterialModule, ContextModule, DparamModule]\n      });\n    }\n  }\n  return CrudModule;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nconst blankCrudAdaptorResponse = {\n  success: false\n};\n\n// import qs from 'qs'\nclass CrudDataService {\n  get name() {\n    return this._name;\n  }\n  constructor(entityName, crud, entityDefinitionService, crudDataHelperService) {\n    this.crud = crud;\n    this.entityDefinitionService = entityDefinitionService;\n    this.crudDataHelperService = crudDataHelperService;\n    this._name = `${entityName} CrudDataService`;\n    this.entityName = entityName;\n  }\n  add(object) {\n    const metadata = this.entityDefinitionService.getDefinition(this.entityName).metadata;\n    return this.crudDataHelperService.evaluatePlugins({\n      object,\n      plugins: metadata.crud,\n      op: 'create'\n    });\n  }\n  update(update) {\n    const metadata = this.entityDefinitionService.getDefinition(this.entityName).metadata;\n    return this.crudDataHelperService.evaluatePlugins({\n      object: update.changes,\n      plugins: metadata.crud,\n      op: 'update'\n    });\n  }\n  upsert(object) {\n    const metadata = this.entityDefinitionService.getDefinition(this.entityName).metadata;\n    return this.crudDataHelperService.evaluatePlugins({\n      object,\n      plugins: metadata.crud,\n      op: 'update'\n    }); // just alias of update for now.\n  }\n  delete(id) {\n    const metadata = this.entityDefinitionService.getDefinition(this.entityName).metadata;\n    return this.getById(id).pipe(switchMap(object => this.crudDataHelperService.evaluatePlugins({\n      object,\n      plugins: metadata.crud,\n      op: 'delete'\n    })), map(() => id));\n  }\n  getAll() {\n    const metadata = this.entityDefinitionService.getDefinition(this.entityName).metadata;\n    return this.crudDataHelperService.evaluateCollectionPlugins({\n      plugins: metadata.crud,\n      op: 'query'\n    });\n  }\n  getById(id) {\n    const metadata = this.entityDefinitionService.getDefinition(this.entityName).metadata;\n    return this.crudDataHelperService.evaluateCollectionPlugins({\n      query: `identity=${id}`,\n      plugins: metadata.crud,\n      op: 'query'\n    }).pipe(map(objects => objects && objects.length !== 0 ? objects[0] : undefined));\n  }\n  getWithQuery(params) {\n    // @todo: convert to rules. - eq support possibly nesting... - _root. -- where root will be the item/object\n    /*const flat: Array<T> = [];\n    this.entities.forEach(v => {\n      flat.push(v);\n    });\n    return of(flat);*/\n    const metadata = this.entityDefinitionService.getDefinition(this.entityName).metadata;\n    return this.crudDataHelperService.evaluateCollectionPlugins({\n      query: params,\n      plugins: metadata.crud,\n      op: 'query'\n    });\n  }\n}\n\n/*\n * Public API Surface of crud\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { CrudAdaptorDatasource, CrudAdaptorDatasourceComponent, CrudAdaptorDatasourceFormComponent, CrudAdaptorPlugin, CrudAdaptorPluginManager, CrudDataHelperService, CrudDataService, CrudModule, blankCrudAdaptorResponse };\n"],
  "mappings": "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",
  "names": ["CommonModule", "i0", "forwardRef", "i1", "NG_VALUE_ACCESSOR", "NG_VALIDATORS", "ReactiveFormsModule", "FormsModule", "i4", "ContextModule", "i6", "Param", "DparamModule", "MaterialModule", "BehaviorSubject", "combineLatest", "of", "forkJoin", "iif", "Observable", "ReplaySubject", "map", "tap", "filter", "delay", "debounceTime", "switchMap", "take", "defaultIfEmpty", "qs", "i1$1", "Plugin", "BasePluginManager", "PluginDef", "i2", "i3", "i1$2", "DatasourcePlugin", "DatasourceEditorOptions", "Dataset", "i3$1", "DataductPlugin", "DuctdataOutput", "jre", "rd", "i2$1", "i8", "CrudAdaptorPlugin", "Plugin", "data", "CrudAdaptorDatasource", "o", "Param", "p", "CrudAdaptorDatasourceFormComponent", "settings", "fb", "attributeSerializer", "BehaviorSubject", "map", "s", "tap", "ds", "combineLatest", "filter", "delay", "debounceTime", "optionsString", "parsed", "qs", "paramsString", "val", "fn", "isDisabled", "c", "__ngFactoryType__", "NG_VALUE_ACCESSOR", "forwardRef", "NG_VALIDATORS", "rf", "ctx", "CrudAdaptorDatasourceComponent", "controlContainer", "crudAdaptorDatasourcePluginFactory", "paramContextExtractor", "cpm", "paramEvaluatorService", "crudDataHelper", "urlGenerator", "DatasourcePlugin", "metadata", "of", "Dataset", "switchMap", "plugin", "v", "optionNames", "forkJoin", "i", "params", "k", "__spreadProps", "__spreadValues", "take", "options", "query", "results", "DatasourceEditorOptions", "crudDataductPluginFactory", "DataductPlugin", "input", "DuctdataOutput", "plugins", "v4_default", "CrudAdaptorPluginManager", "BasePluginManager", "pcm", "moduleLoader", "PluginDef", "CrudDataHelperService", "crud", "object", "op", "parentObject", "operations$", "a", "name", "res", "iif", "objects", "parentObjects", "adaptors", "rule", "entities", "responses", "defaultIfEmpty", "config", "Observable", "obs", "conditions", "value", "_", "values", "q", "matchedIndex", "pDiff", "iDiff", "ReplaySubject", "CrudModule", "dpm", "ddpm", "CommonModule", "ReactiveFormsModule", "FormsModule", "MaterialModule", "ContextModule", "DparamModule", "blankCrudAdaptorResponse", "CrudDataService", "entityName", "entityDefinitionService", "crudDataHelperService", "update", "id"]
}
