{
  "version": 3,
  "sources": ["../../@smithy/property-provider/dist-es/CredentialsProviderError.js", "../../@aws-sdk/credential-provider-cognito-identity/dist-es/resolveLogins.js", "../../@aws-sdk/credential-provider-cognito-identity/dist-es/fromCognitoIdentity.js", "../../@aws-sdk/credential-provider-cognito-identity/dist-es/IndexedDbStorage.js", "../../@aws-sdk/credential-provider-cognito-identity/dist-es/InMemoryStorage.js", "../../@aws-sdk/credential-provider-cognito-identity/dist-es/localStorage.js", "../../@aws-sdk/credential-provider-cognito-identity/dist-es/fromCognitoIdentityPool.js"],
  "sourcesContent": ["import { ProviderError } from \"./ProviderError\";\nexport class CredentialsProviderError extends ProviderError {\n  name = \"CredentialsProviderError\";\n  constructor(message, options = true) {\n    super(message, options);\n    Object.setPrototypeOf(this, CredentialsProviderError.prototype);\n  }\n}", "export function resolveLogins(logins) {\n  return Promise.all(Object.keys(logins).reduce((arr, name) => {\n    const tokenOrProvider = logins[name];\n    if (typeof tokenOrProvider === \"string\") {\n      arr.push([name, tokenOrProvider]);\n    } else {\n      arr.push(tokenOrProvider().then(token => [name, token]));\n    }\n    return arr;\n  }, [])).then(resolvedPairs => resolvedPairs.reduce((logins, [key, value]) => {\n    logins[key] = value;\n    return logins;\n  }, {}));\n}", "import { CredentialsProviderError } from \"@smithy/property-provider\";\nimport { resolveLogins } from \"./resolveLogins\";\nexport function fromCognitoIdentity(parameters) {\n  return async awsIdentityProperties => {\n    parameters.logger?.debug(\"@aws-sdk/credential-provider-cognito-identity - fromCognitoIdentity\");\n    const {\n      GetCredentialsForIdentityCommand,\n      CognitoIdentityClient\n    } = await import(\"./loadCognitoIdentity\");\n    const fromConfigs = property => parameters.clientConfig?.[property] ?? parameters.parentClientConfig?.[property] ?? awsIdentityProperties?.callerClientConfig?.[property];\n    const {\n      Credentials: {\n        AccessKeyId = throwOnMissingAccessKeyId(parameters.logger),\n        Expiration,\n        SecretKey = throwOnMissingSecretKey(parameters.logger),\n        SessionToken\n      } = throwOnMissingCredentials(parameters.logger)\n    } = await (parameters.client ?? new CognitoIdentityClient(Object.assign({}, parameters.clientConfig ?? {}, {\n      region: fromConfigs(\"region\"),\n      profile: fromConfigs(\"profile\")\n    }))).send(new GetCredentialsForIdentityCommand({\n      CustomRoleArn: parameters.customRoleArn,\n      IdentityId: parameters.identityId,\n      Logins: parameters.logins ? await resolveLogins(parameters.logins) : undefined\n    }));\n    return {\n      identityId: parameters.identityId,\n      accessKeyId: AccessKeyId,\n      secretAccessKey: SecretKey,\n      sessionToken: SessionToken,\n      expiration: Expiration\n    };\n  };\n}\nfunction throwOnMissingAccessKeyId(logger) {\n  throw new CredentialsProviderError(\"Response from Amazon Cognito contained no access key ID\", {\n    logger\n  });\n}\nfunction throwOnMissingCredentials(logger) {\n  throw new CredentialsProviderError(\"Response from Amazon Cognito contained no credentials\", {\n    logger\n  });\n}\nfunction throwOnMissingSecretKey(logger) {\n  throw new CredentialsProviderError(\"Response from Amazon Cognito contained no secret key\", {\n    logger\n  });\n}", "const STORE_NAME = \"IdentityIds\";\nexport class IndexedDbStorage {\n  dbName;\n  constructor(dbName = \"aws:cognito-identity-ids\") {\n    this.dbName = dbName;\n  }\n  getItem(key) {\n    return this.withObjectStore(\"readonly\", store => {\n      const req = store.get(key);\n      return new Promise(resolve => {\n        req.onerror = () => resolve(null);\n        req.onsuccess = () => resolve(req.result ? req.result.value : null);\n      });\n    }).catch(() => null);\n  }\n  removeItem(key) {\n    return this.withObjectStore(\"readwrite\", store => {\n      const req = store.delete(key);\n      return new Promise((resolve, reject) => {\n        req.onerror = () => reject(req.error);\n        req.onsuccess = () => resolve();\n      });\n    });\n  }\n  setItem(id, value) {\n    return this.withObjectStore(\"readwrite\", store => {\n      const req = store.put({\n        id,\n        value\n      });\n      return new Promise((resolve, reject) => {\n        req.onerror = () => reject(req.error);\n        req.onsuccess = () => resolve();\n      });\n    });\n  }\n  getDb() {\n    const openDbRequest = self.indexedDB.open(this.dbName, 1);\n    return new Promise((resolve, reject) => {\n      openDbRequest.onsuccess = () => {\n        resolve(openDbRequest.result);\n      };\n      openDbRequest.onerror = () => {\n        reject(openDbRequest.error);\n      };\n      openDbRequest.onblocked = () => {\n        reject(new Error(\"Unable to access DB\"));\n      };\n      openDbRequest.onupgradeneeded = () => {\n        const db = openDbRequest.result;\n        db.onerror = () => {\n          reject(new Error(\"Failed to create object store\"));\n        };\n        db.createObjectStore(STORE_NAME, {\n          keyPath: \"id\"\n        });\n      };\n    });\n  }\n  withObjectStore(mode, action) {\n    return this.getDb().then(db => {\n      const tx = db.transaction(STORE_NAME, mode);\n      tx.oncomplete = () => db.close();\n      return new Promise((resolve, reject) => {\n        tx.onerror = () => reject(tx.error);\n        resolve(action(tx.objectStore(STORE_NAME)));\n      }).catch(err => {\n        db.close();\n        throw err;\n      });\n    });\n  }\n}", "export class InMemoryStorage {\n  store;\n  constructor(store = {}) {\n    this.store = store;\n  }\n  getItem(key) {\n    if (key in this.store) {\n      return this.store[key];\n    }\n    return null;\n  }\n  removeItem(key) {\n    delete this.store[key];\n  }\n  setItem(key, value) {\n    this.store[key] = value;\n  }\n}", "import { IndexedDbStorage } from \"./IndexedDbStorage\";\nimport { InMemoryStorage } from \"./InMemoryStorage\";\nconst inMemoryStorage = new InMemoryStorage();\nexport function localStorage() {\n  if (typeof self === \"object\" && self.indexedDB) {\n    return new IndexedDbStorage();\n  }\n  if (typeof window === \"object\" && window.localStorage) {\n    return window.localStorage;\n  }\n  return inMemoryStorage;\n}", "import { CredentialsProviderError } from \"@smithy/property-provider\";\nimport { fromCognitoIdentity } from \"./fromCognitoIdentity\";\nimport { localStorage } from \"./localStorage\";\nimport { resolveLogins } from \"./resolveLogins\";\nexport function fromCognitoIdentityPool({\n  accountId,\n  cache = localStorage(),\n  client,\n  clientConfig,\n  customRoleArn,\n  identityPoolId,\n  logins,\n  userIdentifier = !logins || Object.keys(logins).length === 0 ? \"ANONYMOUS\" : undefined,\n  logger,\n  parentClientConfig\n}) {\n  logger?.debug(\"@aws-sdk/credential-provider-cognito-identity - fromCognitoIdentity\");\n  const cacheKey = userIdentifier ? `aws:cognito-identity-credentials:${identityPoolId}:${userIdentifier}` : undefined;\n  let provider = async awsIdentityProperties => {\n    const {\n      GetIdCommand,\n      CognitoIdentityClient\n    } = await import(\"./loadCognitoIdentity\");\n    const fromConfigs = property => clientConfig?.[property] ?? parentClientConfig?.[property] ?? awsIdentityProperties?.callerClientConfig?.[property];\n    const _client = client ?? new CognitoIdentityClient(Object.assign({}, clientConfig ?? {}, {\n      region: fromConfigs(\"region\"),\n      profile: fromConfigs(\"profile\")\n    }));\n    let identityId = cacheKey && (await cache.getItem(cacheKey));\n    if (!identityId) {\n      const {\n        IdentityId = throwOnMissingId(logger)\n      } = await _client.send(new GetIdCommand({\n        AccountId: accountId,\n        IdentityPoolId: identityPoolId,\n        Logins: logins ? await resolveLogins(logins) : undefined\n      }));\n      identityId = IdentityId;\n      if (cacheKey) {\n        Promise.resolve(cache.setItem(cacheKey, identityId)).catch(() => {});\n      }\n    }\n    provider = fromCognitoIdentity({\n      client: _client,\n      customRoleArn,\n      logins,\n      identityId\n    });\n    return provider(awsIdentityProperties);\n  };\n  return awsIdentityProperties => provider(awsIdentityProperties).catch(async err => {\n    if (cacheKey) {\n      Promise.resolve(cache.removeItem(cacheKey)).catch(() => {});\n    }\n    throw err;\n  });\n}\nfunction throwOnMissingId(logger) {\n  throw new CredentialsProviderError(\"Response from Amazon Cognito contained no identity ID\", {\n    logger\n  });\n}"],
  "mappings": "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",
  "names": ["CredentialsProviderError", "_CredentialsProviderError", "ProviderError", "message", "options", "resolveLogins", "logins", "arr", "name", "tokenOrProvider", "token", "resolvedPairs", "key", "value", "fromCognitoIdentity", "parameters", "awsIdentityProperties", "__async", "GetCredentialsForIdentityCommand", "CognitoIdentityClient", "fromConfigs", "property", "AccessKeyId", "throwOnMissingAccessKeyId", "Expiration", "SecretKey", "throwOnMissingSecretKey", "SessionToken", "throwOnMissingCredentials", "resolveLogins", "logger", "CredentialsProviderError", "STORE_NAME", "IndexedDbStorage", "dbName", "key", "store", "req", "resolve", "reject", "id", "value", "openDbRequest", "db", "mode", "action", "tx", "err", "InMemoryStorage", "store", "key", "value", "inMemoryStorage", "InMemoryStorage", "localStorage", "IndexedDbStorage", "fromCognitoIdentityPool", "accountId", "cache", "localStorage", "client", "clientConfig", "customRoleArn", "identityPoolId", "logins", "userIdentifier", "logger", "parentClientConfig", "cacheKey", "provider", "awsIdentityProperties", "__async", "GetIdCommand", "CognitoIdentityClient", "fromConfigs", "property", "_client", "identityId", "IdentityId", "throwOnMissingId", "resolveLogins", "fromCognitoIdentity", "err", "CredentialsProviderError"]
}
