{
  "version": 3,
  "sources": ["../../@rollthecloudinc/auth/fesm2022/rollthecloudinc-auth.mjs"],
  "sourcesContent": ["import * as i1 from '@ngrx/store';\nimport { createFeatureSelector, createSelector, select, StoreModule } from '@ngrx/store';\nimport * as i0 from '@angular/core';\nimport { Injectable, PLATFORM_ID, Inject, Component, NgModule } from '@angular/core';\nimport { map, tap } from 'rxjs/operators';\nimport { CommonModule } from '@angular/common';\nimport { v4 } from 'uuid';\nimport * as i2 from '@angular/router';\nimport * as i1$1 from '@ngrx/data';\nvar AuthActionTypes = /*#__PURE__*/function (AuthActionTypes) {\n  AuthActionTypes[\"Login\"] = \"[Auth] Login\";\n  AuthActionTypes[\"Logout\"] = \"[Auth] Logout\";\n  AuthActionTypes[\"CompleteAuthentication\"] = \"[Auth] CompleteAuthentication\";\n  AuthActionTypes[\"SetUser\"] = \"[Auth] SetUser\";\n  return AuthActionTypes;\n}(AuthActionTypes || {});\nclass Login {\n  constructor() {\n    this.type = AuthActionTypes.Login;\n  }\n}\nclass Logout {\n  constructor() {\n    this.type = AuthActionTypes.Logout;\n  }\n}\nclass CompleteAuthentication {\n  constructor() {\n    this.type = AuthActionTypes.CompleteAuthentication;\n  }\n}\nclass SetUser {\n  constructor(payload) {\n    this.payload = payload;\n    this.type = AuthActionTypes.SetUser;\n  }\n}\nconst fromAuthActions = {\n  Login,\n  Logout,\n  CompleteAuthentication,\n  SetUser\n};\nvar auth_actions = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  get AuthActionTypes() {\n    return AuthActionTypes;\n  },\n  CompleteAuthentication: CompleteAuthentication,\n  Login: Login,\n  Logout: Logout,\n  SetUser: SetUser,\n  fromAuthActions: fromAuthActions\n});\n\n// import { userInfo } from 'os';\nconst AUTH_FEATURE_KEY = 'auth';\nconst initialState = {\n  user: undefined,\n  cookies: new Map()\n};\nfunction reducer(state = initialState, action) {\n  switch (action.type) {\n    case AuthActionTypes.SetUser:\n      {\n        state = {\n          ...state,\n          user: action.payload\n        };\n        break;\n      }\n    case AuthActionTypes.Logout:\n      {\n        state = {\n          ...state,\n          user: undefined\n        };\n        break;\n      }\n  }\n  return state;\n}\nvar auth_reducer = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  AUTH_FEATURE_KEY: AUTH_FEATURE_KEY,\n  initialState: initialState,\n  reducer: reducer\n});\n\n// Lookup the 'Auth' feature state managed by NgRx\nconst getAuthState = createFeatureSelector(AUTH_FEATURE_KEY);\nconst getUser = createSelector(getAuthState, state => state.user);\nconst authQuery = {\n  getUser\n};\nvar auth_selectors = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  authQuery: authQuery\n});\nlet AuthFacade = /*#__PURE__*/(() => {\n  class AuthFacade {\n    constructor(store) {\n      this.store = store;\n      this.getUser$ = this.store.pipe(select(authQuery.getUser));\n      this.token$ = this.store.pipe(select(authQuery.getUser), map(u => u ? `${u.token_type} ${u.access_token}` : undefined));\n      this.idToken$ = this.store.pipe(select(authQuery.getUser), map(u => u ? `${u.token_type} ${u.id_token}` : undefined));\n    }\n    login() {\n      this.store.dispatch(new Login());\n    }\n    logout() {\n      this.store.dispatch(new Logout());\n    }\n    setUser(user) {\n      this.store.dispatch(new SetUser(user));\n    }\n    completeAuthentication() {\n      this.store.dispatch(new CompleteAuthentication());\n    }\n    static {\n      this.\u0275fac = function AuthFacade_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || AuthFacade)(i0.\u0275\u0275inject(i1.Store));\n      };\n    }\n    static {\n      this.\u0275prov = /* @__PURE__ */i0.\u0275\u0275defineInjectable({\n        token: AuthFacade,\n        factory: AuthFacade.\u0275fac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AuthFacade;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nconst entityMetadata = {\n  PublicUserProfile: {\n    entityName: 'PublicUserProfile'\n  }\n};\nlet AuthCallbackComponent = /*#__PURE__*/(() => {\n  class AuthCallbackComponent {\n    constructor(authFacade, router, route, platformId) {\n      this.authFacade = authFacade;\n      this.router = router;\n      this.route = route;\n      this.platformId = platformId;\n    }\n    async ngOnInit() {\n      // check for error\n      /*if (this.route.snapshot.fragment.indexOf('error') >= 0) {\n         this.error=true;\n         return;\n       }*/\n      //if(isPlatformBrowser(this.platformId)) {\n      this.authFacade.completeAuthentication();\n      this.router.navigate(['/pages/create-panel-page'], {\n        queryParams: {\n          cacheBuster: v4()\n        }\n      });\n      //}\n    }\n    static {\n      this.\u0275fac = function AuthCallbackComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || AuthCallbackComponent)(i0.\u0275\u0275directiveInject(AuthFacade), i0.\u0275\u0275directiveInject(i2.Router), i0.\u0275\u0275directiveInject(i2.ActivatedRoute), i0.\u0275\u0275directiveInject(PLATFORM_ID));\n      };\n    }\n    static {\n      this.\u0275cmp = /* @__PURE__ */i0.\u0275\u0275defineComponent({\n        type: AuthCallbackComponent,\n        selectors: [[\"classifieds-ui-auth-callback\"]],\n        standalone: false,\n        decls: 2,\n        vars: 0,\n        template: function AuthCallbackComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.\u0275\u0275elementStart(0, \"p\");\n            i0.\u0275\u0275text(1, \"auth-callback works!\");\n            i0.\u0275\u0275elementEnd();\n          }\n        },\n        encapsulation: 2\n      });\n    }\n  }\n  return AuthCallbackComponent;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet AuthModule = /*#__PURE__*/(() => {\n  class AuthModule {\n    constructor(eds) {\n      eds.registerMetadataMap(entityMetadata);\n    }\n    static forRoot() {\n      return {\n        ngModule: AuthModule,\n        providers: [AuthFacade]\n      };\n    }\n    static {\n      this.\u0275fac = function AuthModule_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || AuthModule)(i0.\u0275\u0275inject(i1$1.EntityDefinitionService));\n      };\n    }\n    static {\n      this.\u0275mod = /* @__PURE__ */i0.\u0275\u0275defineNgModule({\n        type: AuthModule\n      });\n    }\n    static {\n      this.\u0275inj = /* @__PURE__ */i0.\u0275\u0275defineInjector({\n        imports: [CommonModule,\n        // HttpClientModule,\n        StoreModule.forFeature(AUTH_FEATURE_KEY, reducer)]\n      });\n    }\n  }\n  return AuthModule;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet LogoutInterceptor = /*#__PURE__*/(() => {\n  class LogoutInterceptor {\n    constructor(authFacade, router) {\n      this.authFacade = authFacade;\n      this.router = router;\n    }\n    intercept(req, next) {\n      return next.handle(req).pipe(tap({\n        error: e => {\n          if (e.status === 401) {\n            // This breaks the server application remove for now.\n            // this.authFacade.logout();\n            // alert('You have been automatically logged out due to inactivity. Please login again.');\n            //this.router.navigateByUrl('/');\n          }\n        }\n      }));\n    }\n    static {\n      this.\u0275fac = function LogoutInterceptor_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || LogoutInterceptor)(i0.\u0275\u0275inject(AuthFacade), i0.\u0275\u0275inject(i2.Router));\n      };\n    }\n    static {\n      this.\u0275prov = /* @__PURE__ */i0.\u0275\u0275defineInjectable({\n        token: LogoutInterceptor,\n        factory: LogoutInterceptor.\u0275fac\n      });\n    }\n  }\n  return LogoutInterceptor;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nclass UserInfo {\n  constructor(data) {\n    if (data) {\n      this.sub = data.sub;\n    }\n  }\n}\nclass PublicUserProfile {\n  constructor(data) {\n    if (data) {\n      this.id = data.id;\n      this.userName = data.userName;\n    }\n  }\n}\nclass Cookie {\n  constructor(data) {\n    if (data) {\n      this.name = data.name;\n      this.value = data.value;\n    }\n  }\n}\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { AuthActionTypes, auth_actions as AuthActions, AuthCallbackComponent, AuthFacade, auth_reducer as AuthFeature, AuthModule, auth_selectors as AuthSelectors, CompleteAuthentication, Cookie, Login, Logout, LogoutInterceptor, PublicUserProfile, SetUser, UserInfo, fromAuthActions };\n"],
  "mappings": "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",
  "names": ["i1", "createFeatureSelector", "createSelector", "select", "StoreModule", "i0", "PLATFORM_ID", "map", "tap", "CommonModule", "i2", "i1$1", "AuthActionTypes", "Login", "Logout", "CompleteAuthentication", "SetUser", "payload", "fromAuthActions", "auth_actions", "AUTH_FEATURE_KEY", "initialState", "reducer", "state", "action", "__spreadProps", "__spreadValues", "auth_reducer", "getAuthState", "createFeatureSelector", "getUser", "createSelector", "authQuery", "auth_selectors", "AuthFacade", "store", "select", "map", "u", "user", "__ngFactoryType__", "entityMetadata", "AuthCallbackComponent", "authFacade", "router", "route", "platformId", "__async", "v4_default", "PLATFORM_ID", "rf", "ctx", "AuthModule", "eds", "CommonModule", "StoreModule", "LogoutInterceptor", "req", "next", "tap", "e", "UserInfo", "data", "PublicUserProfile", "Cookie"]
}
