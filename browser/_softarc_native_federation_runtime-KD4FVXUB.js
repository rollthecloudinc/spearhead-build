var j=Object.defineProperty,v=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var E=(e,t,o)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,f=(e,t)=>{for(var o in t||={})D.call(t,o)&&E(e,o,t[o]);if(y)for(var o of y(t))U.call(t,o)&&E(e,o,t[o]);return e},d=(e,t)=>v(e,C(t));var u=(e,t,o)=>new Promise((n,r)=>{var c=i=>{try{a(o.next(i))}catch(l){r(l)}},s=i=>{try{a(o.throw(i))}catch(l){r(l)}},a=i=>i.done?n(i.value):Promise.resolve(i.value).then(c,s);a((o=o.apply(e,t)).next())});var A={singleton:!1,requiredVersionPrefix:""};function ne(e=A){let o=window.__NATIVE_FEDERATION__.externals,n={},c=[...o.keys()].filter(s=>!s.startsWith("/@id/")&&!s.startsWith("@angular-architects/module-federation")&&!s.endsWith("@")).sort();for(let s of c){let a=s.lastIndexOf("@"),i=s.substring(0,a),l=s.substring(a+1),m=o.get(s)??"",$={version:l,get:()=>u(null,null,function*(){let P=yield window.importShim(m);return()=>P}),shareConfig:{singleton:e.singleton,requiredVersion:e.requiredVersionPrefix+l}};n[i]||(n[i]=[]),n[i].push($)}return n}var I="__NATIVE_FEDERATION__",b=globalThis;b[I]??={externals:new Map,remoteNamesToRemote:new Map,baseUrlToRemoteNames:new Map};var g=b[I],R=g.externals;function x(e){return`${e.packageName}@${e.version}`}function K(e){let t=x(e);return R.get(t)}function T(e,t){let o=x(e);R.set(o,t)}function M(e,t){return{imports:f(f({},e.imports),t.imports),scopes:f(f({},e.scopes),t.scopes)}}var F=g.remoteNamesToRemote,h=g.baseUrlToRemoteNames;function V(e,t){F.set(e,t),h.set(t.baseUrl,e)}function W(e){return h.get(e)}function L(e){return h.has(e)}function q(e){return F.get(e)}function k(e){document.head.appendChild(Object.assign(document.createElement("script"),{type:"importmap-shim",innerHTML:JSON.stringify(e)}))}function w(e){let t=e.split("/");return t.pop(),t.join("/")}function p(e,t){for(;e.endsWith("/");)e=e.substring(0,e.length-1);return t.startsWith("./")&&(t=t.substring(2,t.length)),`${e}/${t}`}var re="/@angular-architects/native-federation:build-notifications",O=(function(e){return e.COMPLETED="federation-rebuild-complete",e.ERROR="federation-rebuild-error",e})(O||{});function z(e){let t=new EventSource(e);t.onmessage=function(o){JSON.parse(o.data).type===O.COMPLETED&&(console.log("[Federation] Rebuild completed, reloading..."),window.location.reload())},t.onerror=function(o){console.warn("[Federation] SSE connection error:",o)}}function se(){return u(this,arguments,function*(e={},t){let o=t?.cacheTag?`?t=${t.cacheTag}`:"",n=typeof e=="string"?yield B(e+o):e,r="./remoteEntry.json"+o,c=yield S(r),s=yield X(c),a=yield H(n,f({throwIfRemoteNotFound:!1},t)),i=M(s,a);return k(i),i})}function B(e){return u(this,null,function*(){return yield fetch(e).then(t=>t.json())})}function H(o){return u(this,arguments,function*(e,t={throwIfRemoteNotFound:!1}){let n=Object.keys(e).map(s=>u(null,null,function*(){try{let a=e[s];if(t.cacheTag){let i=e[s].includes("?")?"&":"?";a+=`${i}t=${t.cacheTag}`}return yield _(a,s)}catch{let i=`Error loading remote entry for ${s} from file ${e[s]}`;if(t.throwIfRemoteNotFound)throw new Error(i);return console.error(i),null}}));return(yield Promise.all(n)).reduce((s,a)=>a?M(s,a):s,{imports:{},scopes:{}})})}function _(e,t){return u(this,null,function*(){let o=w(e),n=yield S(e);t||(t=n.name),n.buildNotificationsEndpoint&&z(o+n.buildNotificationsEndpoint);let r=J(n,t,o);return V(t,d(f({},n),{baseUrl:o})),r})}function J(e,t,o){let n=Q(e,t,o),r=G(e,o);return{imports:n,scopes:r}}function S(e){return u(this,null,function*(){return yield fetch(e).then(o=>o.json())})}function G(e,t){let o={},n={};for(let r of e.shared){let c=K(r)??p(t,r.outFileName);T(r,c),n[r.packageName]=c}return o[t+"/"]=n,o}function Q(e,t,o){let n={};for(let r of e.exposes){let c=p(t,r.key),s=p(o,r.outFileName);n[c]=s}return n}function X(e,t="./"){return u(this,null,function*(){let o=e.shared.reduce((n,r)=>d(f({},n),{[r.packageName]:t+r.outFileName}),{});for(let n of e.shared)T(n,t+n.outFileName);return{imports:o,scopes:{}}})}function ie(e,t){return u(this,null,function*(){let o=te(e,t);yield ee(o);let n=Z(o),r=q(n),c=o.fallback,s=r?"":"unknown remote "+n;if(!r&&!c)throw new Error(s);if(!r)return N(s),Promise.resolve(c);let a=r.exposes.find(m=>m.key===o.exposedModule),i=a?"":`Unknown exposed module ${o.exposedModule} in remote ${n}`;if(!a&&!c)throw new Error(i);if(!a)return N(i),Promise.resolve(c);let l=p(r.baseUrl,a.outFileName);try{return Y(l)}catch(m){if(c)return console.error("error loading remote module",m),c;throw m}})}function Y(e){return typeof importShim<"u"?importShim(e):import(e)}function Z(e){let t;if(e.remoteName)t=e.remoteName;else if(e.remoteEntry){let o=w(e.remoteEntry);t=W(o)}else throw new Error("unexpcted arguments: Please pass remoteName or remoteEntry");if(!t)throw new Error("unknown remoteName "+t);return t}function ee(e){return u(this,null,function*(){if(e.remoteEntry&&!L(w(e.remoteEntry))){let t=yield _(e.remoteEntry);k(t)}})}function te(e,t){let o;if(typeof e=="string"&&t)o={remoteName:e,exposedModule:t};else if(typeof e=="object"&&!t)o=e;else throw new Error("unexpected arguments: please pass options or a remoteName/exposedModule-pair");return o}function N(e){typeof window<"u"&&console.error(e)}export{re as BUILD_NOTIFICATIONS_ENDPOINT,O as BuildNotificationType,ne as getShared,se as initFederation,ie as loadRemoteModule,M as mergeImportMaps,X as processHostInfo,_ as processRemoteInfo,H as processRemoteInfos};
