{
  "version": 3,
  "sources": ["../../@rollthecloudinc/transform/fesm2022/rollthecloudinc-transform.mjs"],
  "sourcesContent": ["import * as i0 from '@angular/core';\nimport { forwardRef, Input, Component, NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport * as i1 from '@angular/forms';\nimport { Validators, NG_VALUE_ACCESSOR, NG_VALIDATORS, FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MaterialModule } from '@rollthecloudinc/material';\nimport * as i1$1 from '@rollthecloudinc/datasource';\nimport { DatasourcePlugin, Dataset, DatasourceModule } from '@rollthecloudinc/datasource';\nimport { BehaviorSubject, iif, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport * as i2 from '@rollthecloudinc/attributes';\nimport * as i3 from '@angular/material/input';\nimport * as jpp from 'jsonpath-plus';\nclass SelectTransform {\n  constructor(data) {\n    if (data) {\n      this.query = data.query;\n    }\n  }\n}\nlet SelectSourceFormComponent = /*#__PURE__*/(() => {\n  class SelectSourceFormComponent {\n    set settings(settings) {\n      this.settings$.next(settings);\n    }\n    constructor(fb, attributeSerializer) {\n      this.fb = fb;\n      this.attributeSerializer = attributeSerializer;\n      this.settings$ = new BehaviorSubject(undefined);\n      this.formGroup = this.fb.group({\n        query: this.fb.control('', [Validators.required])\n      });\n      this.settingsSub = this.settings$.pipe(map(s => s ? new SelectTransform(this.attributeSerializer.deserializeAsObject(s)) : undefined)).subscribe(ds => {\n        if (ds) {\n          this.formGroup.get('query').setValue(ds.query);\n        } else {\n          this.formGroup.get('query').setValue('');\n        }\n      });\n      this.onTouched = () => {};\n    }\n    ngOnInit() {}\n    writeValue(val) {\n      if (val) {\n        this.formGroup.setValue(val, {\n          emitEvent: false\n        });\n      }\n    }\n    registerOnChange(fn) {\n      this.formGroup.valueChanges.subscribe(fn);\n    }\n    registerOnTouched(fn) {\n      this.onTouched = fn;\n    }\n    setDisabledState(isDisabled) {\n      if (isDisabled) {\n        this.formGroup.disable();\n      } else {\n        this.formGroup.enable();\n      }\n    }\n    validate(c) {\n      return this.formGroup.valid ? null : {\n        invalidForm: {\n          valid: false,\n          message: \"content is invalid\"\n        }\n      };\n    }\n    static {\n      this.\u0275fac = function SelectSourceFormComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || SelectSourceFormComponent)(i0.\u0275\u0275directiveInject(i1.UntypedFormBuilder), i0.\u0275\u0275directiveInject(i2.AttributeSerializerService));\n      };\n    }\n    static {\n      this.\u0275cmp = /* @__PURE__ */i0.\u0275\u0275defineComponent({\n        type: SelectSourceFormComponent,\n        selectors: [[\"classifieds-ui-select-source-form\"]],\n        inputs: {\n          settings: \"settings\"\n        },\n        standalone: false,\n        features: [i0.\u0275\u0275ProvidersFeature([{\n          provide: NG_VALUE_ACCESSOR,\n          useExisting: forwardRef(() => SelectSourceFormComponent),\n          multi: true\n        }, {\n          provide: NG_VALIDATORS,\n          useExisting: forwardRef(() => SelectSourceFormComponent),\n          multi: true\n        }])],\n        decls: 5,\n        vars: 1,\n        consts: [[3, \"formGroup\"], [\"matInput\", \"\", \"formControlName\", \"query\", \"required\", \"\"]],\n        template: function SelectSourceFormComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.\u0275\u0275elementStart(0, \"div\", 0)(1, \"mat-form-field\")(2, \"mat-label\");\n            i0.\u0275\u0275text(3, \"Query\");\n            i0.\u0275\u0275elementEnd();\n            i0.\u0275\u0275element(4, \"input\", 1);\n            i0.\u0275\u0275elementEnd()();\n          }\n          if (rf & 2) {\n            i0.\u0275\u0275property(\"formGroup\", ctx.formGroup);\n          }\n        },\n        dependencies: [i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.RequiredValidator, i1.FormGroupDirective, i1.FormControlName, i3.MatInput, i3.MatFormField, i3.MatLabel],\n        encapsulation: 2\n      });\n    }\n  }\n  return SelectSourceFormComponent;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet TransformSelectComponent = /*#__PURE__*/(() => {\n  class TransformSelectComponent {\n    constructor(controlContainer) {\n      this.controlContainer = controlContainer;\n      this.settings = [];\n    }\n    static {\n      this.\u0275fac = function TransformSelectComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || TransformSelectComponent)(i0.\u0275\u0275directiveInject(i1.ControlContainer));\n      };\n    }\n    static {\n      this.\u0275cmp = /* @__PURE__ */i0.\u0275\u0275defineComponent({\n        type: TransformSelectComponent,\n        selectors: [[\"classifieds-ui-transform-select\"]],\n        inputs: {\n          settings: \"settings\"\n        },\n        standalone: false,\n        decls: 2,\n        vars: 2,\n        consts: [[3, \"formGroup\"], [\"formControlName\", \"settings\", 3, \"settings\"]],\n        template: function TransformSelectComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.\u0275\u0275elementContainerStart(0, 0);\n            i0.\u0275\u0275element(1, \"classifieds-ui-select-source-form\", 1);\n            i0.\u0275\u0275elementContainerEnd();\n          }\n          if (rf & 2) {\n            i0.\u0275\u0275property(\"formGroup\", ctx.controlContainer.control);\n            i0.\u0275\u0275advance();\n            i0.\u0275\u0275property(\"settings\", ctx.settings);\n          }\n        },\n        dependencies: [i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, SelectSourceFormComponent],\n        encapsulation: 2\n      });\n    }\n  }\n  return TransformSelectComponent;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet TransformMergeComponent = /*#__PURE__*/(() => {\n  class TransformMergeComponent {\n    constructor() {}\n    ngOnInit() {}\n    static {\n      this.\u0275fac = function TransformMergeComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || TransformMergeComponent)();\n      };\n    }\n    static {\n      this.\u0275cmp = /* @__PURE__ */i0.\u0275\u0275defineComponent({\n        type: TransformMergeComponent,\n        selectors: [[\"classifieds-ui-transform-merge\"]],\n        standalone: false,\n        decls: 2,\n        vars: 0,\n        template: function TransformMergeComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.\u0275\u0275elementStart(0, \"p\");\n            i0.\u0275\u0275text(1, \"transform merge\");\n            i0.\u0275\u0275elementEnd();\n          }\n        },\n        encapsulation: 2\n      });\n    }\n  }\n  return TransformMergeComponent;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nconst selectDatasourcePluginFactory = attributeSerializer => {\n  return new DatasourcePlugin({\n    id: 'select',\n    title: 'Select',\n    editor: TransformSelectComponent,\n    fetch: ({\n      settings,\n      dataset\n    }) => iif(() => !!dataset, of(dataset).pipe(map(() => new SelectTransform(attributeSerializer.deserializeAsObject(settings))), map(ds => new Dataset({\n      results: jpp.JSONPath({\n        path: ds.query,\n        json: dataset.results\n      })\n    }))), of(new Dataset()))\n  });\n};\nconst mergeDatasourcePluginFactory = () => {\n  return new DatasourcePlugin({\n    id: 'merge',\n    title: 'Merge',\n    editor: TransformMergeComponent,\n    fetch: ({\n      settings\n    }) => of(new Dataset())\n  });\n};\nlet TransformModule = /*#__PURE__*/(() => {\n  class TransformModule {\n    constructor(dpm, attributeSerializer) {\n      [selectDatasourcePluginFactory(attributeSerializer), mergeDatasourcePluginFactory()].forEach(p => dpm.register(p));\n    }\n    static {\n      this.\u0275fac = function TransformModule_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || TransformModule)(i0.\u0275\u0275inject(i1$1.DatasourcePluginManager), i0.\u0275\u0275inject(i2.AttributeSerializerService));\n      };\n    }\n    static {\n      this.\u0275mod = /* @__PURE__ */i0.\u0275\u0275defineNgModule({\n        type: TransformModule\n      });\n    }\n    static {\n      this.\u0275inj = /* @__PURE__ */i0.\u0275\u0275defineInjector({\n        imports: [CommonModule, FormsModule, ReactiveFormsModule, MaterialModule, DatasourceModule]\n      });\n    }\n  }\n  return TransformModule;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n/*\n * Public API Surface of transform\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { SelectSourceFormComponent, SelectTransform, TransformMergeComponent, TransformModule, TransformSelectComponent };\n"],
  "mappings": "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",
  "names": ["jpp", "i0", "forwardRef", "CommonModule", "i1", "Validators", "NG_VALUE_ACCESSOR", "NG_VALIDATORS", "FormsModule", "ReactiveFormsModule", "MaterialModule", "i1$1", "DatasourcePlugin", "Dataset", "DatasourceModule", "BehaviorSubject", "iif", "of", "map", "i2", "i3", "SelectTransform", "data", "SelectSourceFormComponent", "settings", "fb", "attributeSerializer", "s", "ds", "val", "fn", "isDisabled", "c", "__ngFactoryType__", "rf", "ctx", "TransformSelectComponent", "controlContainer", "TransformMergeComponent", "selectDatasourcePluginFactory", "dataset", "mergeDatasourcePluginFactory", "TransformModule", "dpm", "p"]
}
