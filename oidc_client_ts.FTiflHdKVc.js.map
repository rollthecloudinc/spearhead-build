{
  "version": 3,
  "sources": ["../../oidc-client-ts/node_modules/jwt-decode/build/esm/index.js", "../../oidc-client-ts/dist/esm/oidc-client-ts.js"],
  "sourcesContent": ["export class InvalidTokenError extends Error {}\nInvalidTokenError.prototype.name = \"InvalidTokenError\";\nfunction b64DecodeUnicode(str) {\n  return decodeURIComponent(atob(str).replace(/(.)/g, (m, p) => {\n    let code = p.charCodeAt(0).toString(16).toUpperCase();\n    if (code.length < 2) {\n      code = \"0\" + code;\n    }\n    return \"%\" + code;\n  }));\n}\nfunction base64UrlDecode(str) {\n  let output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n  switch (output.length % 4) {\n    case 0:\n      break;\n    case 2:\n      output += \"==\";\n      break;\n    case 3:\n      output += \"=\";\n      break;\n    default:\n      throw new Error(\"base64 string is not of the correct length\");\n  }\n  try {\n    return b64DecodeUnicode(output);\n  } catch (err) {\n    return atob(output);\n  }\n}\nexport function jwtDecode(token, options) {\n  if (typeof token !== \"string\") {\n    throw new InvalidTokenError(\"Invalid token specified: must be a string\");\n  }\n  options || (options = {});\n  const pos = options.header === true ? 0 : 1;\n  const part = token.split(\".\")[pos];\n  if (typeof part !== \"string\") {\n    throw new InvalidTokenError(`Invalid token specified: missing part #${pos + 1}`);\n  }\n  let decoded;\n  try {\n    decoded = base64UrlDecode(part);\n  } catch (e) {\n    throw new InvalidTokenError(`Invalid token specified: invalid base64 for part #${pos + 1} (${e.message})`);\n  }\n  try {\n    return JSON.parse(decoded);\n  } catch (e) {\n    throw new InvalidTokenError(`Invalid token specified: invalid json for part #${pos + 1} (${e.message})`);\n  }\n}", "// src/utils/Logger.ts\nvar nopLogger = {\n  debug: () => void 0,\n  info: () => void 0,\n  warn: () => void 0,\n  error: () => void 0\n};\nvar level;\nvar logger;\nvar Log = /* @__PURE__ */(Log2 => {\n  Log2[Log2[\"NONE\"] = 0] = \"NONE\";\n  Log2[Log2[\"ERROR\"] = 1] = \"ERROR\";\n  Log2[Log2[\"WARN\"] = 2] = \"WARN\";\n  Log2[Log2[\"INFO\"] = 3] = \"INFO\";\n  Log2[Log2[\"DEBUG\"] = 4] = \"DEBUG\";\n  return Log2;\n})(Log || {});\n(Log2 => {\n  function reset() {\n    level = 3 /* INFO */;\n    logger = nopLogger;\n  }\n  Log2.reset = reset;\n  function setLevel(value) {\n    if (!(0 /* NONE */ <= value && value <= 4 /* DEBUG */)) {\n      throw new Error(\"Invalid log level\");\n    }\n    level = value;\n  }\n  Log2.setLevel = setLevel;\n  function setLogger(value) {\n    logger = value;\n  }\n  Log2.setLogger = setLogger;\n})(Log || (Log = {}));\nvar Logger = class _Logger {\n  constructor(_name) {\n    this._name = _name;\n  }\n  /* eslint-disable @typescript-eslint/no-unsafe-enum-comparison */\n  debug(...args) {\n    if (level >= 4 /* DEBUG */) {\n      logger.debug(_Logger._format(this._name, this._method), ...args);\n    }\n  }\n  info(...args) {\n    if (level >= 3 /* INFO */) {\n      logger.info(_Logger._format(this._name, this._method), ...args);\n    }\n  }\n  warn(...args) {\n    if (level >= 2 /* WARN */) {\n      logger.warn(_Logger._format(this._name, this._method), ...args);\n    }\n  }\n  error(...args) {\n    if (level >= 1 /* ERROR */) {\n      logger.error(_Logger._format(this._name, this._method), ...args);\n    }\n  }\n  /* eslint-enable @typescript-eslint/no-unsafe-enum-comparison */\n  throw(err) {\n    this.error(err);\n    throw err;\n  }\n  create(method) {\n    const methodLogger = Object.create(this);\n    methodLogger._method = method;\n    methodLogger.debug(\"begin\");\n    return methodLogger;\n  }\n  static createStatic(name, staticMethod) {\n    const staticLogger = new _Logger(`${name}.${staticMethod}`);\n    staticLogger.debug(\"begin\");\n    return staticLogger;\n  }\n  static _format(name, method) {\n    const prefix = `[${name}]`;\n    return method ? `${prefix} ${method}:` : prefix;\n  }\n  /* eslint-disable @typescript-eslint/no-unsafe-enum-comparison */\n  // helpers for static class methods\n  static debug(name, ...args) {\n    if (level >= 4 /* DEBUG */) {\n      logger.debug(_Logger._format(name), ...args);\n    }\n  }\n  static info(name, ...args) {\n    if (level >= 3 /* INFO */) {\n      logger.info(_Logger._format(name), ...args);\n    }\n  }\n  static warn(name, ...args) {\n    if (level >= 2 /* WARN */) {\n      logger.warn(_Logger._format(name), ...args);\n    }\n  }\n  static error(name, ...args) {\n    if (level >= 1 /* ERROR */) {\n      logger.error(_Logger._format(name), ...args);\n    }\n  }\n  /* eslint-enable @typescript-eslint/no-unsafe-enum-comparison */\n};\nLog.reset();\n\n// src/utils/JwtUtils.ts\nimport { jwtDecode } from \"jwt-decode\";\nvar JwtUtils = class {\n  // IMPORTANT: doesn't validate the token\n  static decode(token) {\n    try {\n      return jwtDecode(token);\n    } catch (err) {\n      Logger.error(\"JwtUtils.decode\", err);\n      throw err;\n    }\n  }\n  static async generateSignedJwt(header, payload, privateKey) {\n    const encodedHeader = CryptoUtils.encodeBase64Url(new TextEncoder().encode(JSON.stringify(header)));\n    const encodedPayload = CryptoUtils.encodeBase64Url(new TextEncoder().encode(JSON.stringify(payload)));\n    const encodedToken = `${encodedHeader}.${encodedPayload}`;\n    const signature = await window.crypto.subtle.sign({\n      name: \"ECDSA\",\n      hash: {\n        name: \"SHA-256\"\n      }\n    }, privateKey, new TextEncoder().encode(encodedToken));\n    const encodedSignature = CryptoUtils.encodeBase64Url(new Uint8Array(signature));\n    return `${encodedToken}.${encodedSignature}`;\n  }\n};\n\n// src/utils/CryptoUtils.ts\nvar UUID_V4_TEMPLATE = \"10000000-1000-4000-8000-100000000000\";\nvar toBase64 = val => btoa([...new Uint8Array(val)].map(chr => String.fromCharCode(chr)).join(\"\"));\nvar _CryptoUtils = /*#__PURE__*/(() => {\n  let _CryptoUtils = class _CryptoUtils {\n    static _randomWord() {\n      const arr = new Uint32Array(1);\n      crypto.getRandomValues(arr);\n      return arr[0];\n    }\n    /**\n     * Generates RFC4122 version 4 guid\n     */\n    static generateUUIDv4() {\n      const uuid = UUID_V4_TEMPLATE.replace(/[018]/g, c => (+c ^ _CryptoUtils._randomWord() & 15 >> +c / 4).toString(16));\n      return uuid.replace(/-/g, \"\");\n    }\n    /**\n     * PKCE: Generate a code verifier\n     */\n    static generateCodeVerifier() {\n      return _CryptoUtils.generateUUIDv4() + _CryptoUtils.generateUUIDv4() + _CryptoUtils.generateUUIDv4();\n    }\n    /**\n     * PKCE: Generate a code challenge\n     */\n    static async generateCodeChallenge(code_verifier) {\n      if (!crypto.subtle) {\n        throw new Error(\"Crypto.subtle is available only in secure contexts (HTTPS).\");\n      }\n      try {\n        const encoder = new TextEncoder();\n        const data = encoder.encode(code_verifier);\n        const hashed = await crypto.subtle.digest(\"SHA-256\", data);\n        return toBase64(hashed).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/, \"\");\n      } catch (err) {\n        Logger.error(\"CryptoUtils.generateCodeChallenge\", err);\n        throw err;\n      }\n    }\n    /**\n     * Generates a base64-encoded string for a basic auth header\n     */\n    static generateBasicAuth(client_id, client_secret) {\n      const encoder = new TextEncoder();\n      const data = encoder.encode([client_id, client_secret].join(\":\"));\n      return toBase64(data);\n    }\n    /**\n     * Generates a hash of a string using a given algorithm\n     * @param alg\n     * @param message\n     */\n    static async hash(alg, message) {\n      const msgUint8 = new TextEncoder().encode(message);\n      const hashBuffer = await crypto.subtle.digest(alg, msgUint8);\n      return new Uint8Array(hashBuffer);\n    }\n    /**\n     * Generates a rfc7638 compliant jwk thumbprint\n     * @param jwk\n     */\n    static async customCalculateJwkThumbprint(jwk) {\n      let jsonObject;\n      switch (jwk.kty) {\n        case \"RSA\":\n          jsonObject = {\n            \"e\": jwk.e,\n            \"kty\": jwk.kty,\n            \"n\": jwk.n\n          };\n          break;\n        case \"EC\":\n          jsonObject = {\n            \"crv\": jwk.crv,\n            \"kty\": jwk.kty,\n            \"x\": jwk.x,\n            \"y\": jwk.y\n          };\n          break;\n        case \"OKP\":\n          jsonObject = {\n            \"crv\": jwk.crv,\n            \"kty\": jwk.kty,\n            \"x\": jwk.x\n          };\n          break;\n        case \"oct\":\n          jsonObject = {\n            \"crv\": jwk.k,\n            \"kty\": jwk.kty\n          };\n          break;\n        default:\n          throw new Error(\"Unknown jwk type\");\n      }\n      const utf8encodedAndHashed = await _CryptoUtils.hash(\"SHA-256\", JSON.stringify(jsonObject));\n      return _CryptoUtils.encodeBase64Url(utf8encodedAndHashed);\n    }\n    static async generateDPoPProof({\n      url,\n      accessToken,\n      httpMethod,\n      keyPair,\n      nonce\n    }) {\n      let hashedToken;\n      let encodedHash;\n      const payload = {\n        \"jti\": window.crypto.randomUUID(),\n        \"htm\": httpMethod != null ? httpMethod : \"GET\",\n        \"htu\": url,\n        \"iat\": Math.floor(Date.now() / 1e3)\n      };\n      if (accessToken) {\n        hashedToken = await _CryptoUtils.hash(\"SHA-256\", accessToken);\n        encodedHash = _CryptoUtils.encodeBase64Url(hashedToken);\n        payload.ath = encodedHash;\n      }\n      if (nonce) {\n        payload.nonce = nonce;\n      }\n      try {\n        const publicJwk = await crypto.subtle.exportKey(\"jwk\", keyPair.publicKey);\n        const header = {\n          \"alg\": \"ES256\",\n          \"typ\": \"dpop+jwt\",\n          \"jwk\": {\n            \"crv\": publicJwk.crv,\n            \"kty\": publicJwk.kty,\n            \"x\": publicJwk.x,\n            \"y\": publicJwk.y\n          }\n        };\n        return await JwtUtils.generateSignedJwt(header, payload, keyPair.privateKey);\n      } catch (err) {\n        if (err instanceof TypeError) {\n          throw new Error(`Error exporting dpop public key: ${err.message}`);\n        } else {\n          throw err;\n        }\n      }\n    }\n    static async generateDPoPJkt(keyPair) {\n      try {\n        const publicJwk = await crypto.subtle.exportKey(\"jwk\", keyPair.publicKey);\n        return await _CryptoUtils.customCalculateJwkThumbprint(publicJwk);\n      } catch (err) {\n        if (err instanceof TypeError) {\n          throw new Error(`Could not retrieve dpop keys from storage: ${err.message}`);\n        } else {\n          throw err;\n        }\n      }\n    }\n    static async generateDPoPKeys() {\n      return await window.crypto.subtle.generateKey({\n        name: \"ECDSA\",\n        namedCurve: \"P-256\"\n      }, false, [\"sign\", \"verify\"]);\n    }\n  };\n  /**\n   * Generates a base64url encoded string\n   */\n  _CryptoUtils.encodeBase64Url = input => {\n    return toBase64(input).replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n  };\n  return _CryptoUtils;\n})();\nvar CryptoUtils = _CryptoUtils;\n\n// src/utils/Event.ts\nvar Event = class {\n  constructor(_name) {\n    this._name = _name;\n    this._callbacks = [];\n    this._logger = new Logger(`Event('${this._name}')`);\n  }\n  addHandler(cb) {\n    this._callbacks.push(cb);\n    return () => this.removeHandler(cb);\n  }\n  removeHandler(cb) {\n    const idx = this._callbacks.lastIndexOf(cb);\n    if (idx >= 0) {\n      this._callbacks.splice(idx, 1);\n    }\n  }\n  async raise(...ev) {\n    this._logger.debug(\"raise:\", ...ev);\n    for (const cb of this._callbacks) {\n      await cb(...ev);\n    }\n  }\n};\n\n// src/utils/PopupUtils.ts\nvar PopupUtils = class {\n  /**\n   * Populates a map of window features with a placement centered in front of\n   * the current window. If no explicit width is given, a default value is\n   * binned into [800, 720, 600, 480, 360] based on the current window's width.\n   */\n  static center({\n    ...features\n  }) {\n    var _a, _b, _c;\n    if (features.width == null) features.width = (_a = [800, 720, 600, 480].find(width => width <= window.outerWidth / 1.618)) != null ? _a : 360;\n    (_b = features.left) != null ? _b : features.left = Math.max(0, Math.round(window.screenX + (window.outerWidth - features.width) / 2));\n    if (features.height != null) (_c = features.top) != null ? _c : features.top = Math.max(0, Math.round(window.screenY + (window.outerHeight - features.height) / 2));\n    return features;\n  }\n  static serialize(features) {\n    return Object.entries(features).filter(([, value]) => value != null).map(([key, value]) => `${key}=${typeof value !== \"boolean\" ? value : value ? \"yes\" : \"no\"}`).join(\",\");\n  }\n};\n\n// src/utils/Timer.ts\nvar Timer = class _Timer extends Event {\n  constructor() {\n    super(...arguments);\n    this._logger = new Logger(`Timer('${this._name}')`);\n    this._timerHandle = null;\n    this._expiration = 0;\n    this._callback = () => {\n      const diff = this._expiration - _Timer.getEpochTime();\n      this._logger.debug(\"timer completes in\", diff);\n      if (this._expiration <= _Timer.getEpochTime()) {\n        this.cancel();\n        void super.raise();\n      }\n    };\n  }\n  // get the time\n  static getEpochTime() {\n    return Math.floor(Date.now() / 1e3);\n  }\n  init(durationInSeconds) {\n    const logger2 = this._logger.create(\"init\");\n    durationInSeconds = Math.max(Math.floor(durationInSeconds), 1);\n    const expiration = _Timer.getEpochTime() + durationInSeconds;\n    if (this.expiration === expiration && this._timerHandle) {\n      logger2.debug(\"skipping since already initialized for expiration at\", this.expiration);\n      return;\n    }\n    this.cancel();\n    logger2.debug(\"using duration\", durationInSeconds);\n    this._expiration = expiration;\n    const timerDurationInSeconds = Math.min(durationInSeconds, 5);\n    this._timerHandle = setInterval(this._callback, timerDurationInSeconds * 1e3);\n  }\n  get expiration() {\n    return this._expiration;\n  }\n  cancel() {\n    this._logger.create(\"cancel\");\n    if (this._timerHandle) {\n      clearInterval(this._timerHandle);\n      this._timerHandle = null;\n    }\n  }\n};\n\n// src/utils/UrlUtils.ts\nvar UrlUtils = class {\n  static readParams(url, responseMode = \"query\") {\n    if (!url) throw new TypeError(\"Invalid URL\");\n    const parsedUrl = new URL(url, \"http://127.0.0.1\");\n    const params = parsedUrl[responseMode === \"fragment\" ? \"hash\" : \"search\"];\n    return new URLSearchParams(params.slice(1));\n  }\n};\nvar URL_STATE_DELIMITER = \";\";\n\n// src/errors/ErrorResponse.ts\nvar ErrorResponse = class extends Error {\n  constructor(args, form) {\n    var _a, _b, _c;\n    super(args.error_description || args.error || \"\");\n    this.form = form;\n    /** Marker to detect class: \"ErrorResponse\" */\n    this.name = \"ErrorResponse\";\n    if (!args.error) {\n      Logger.error(\"ErrorResponse\", \"No error passed\");\n      throw new Error(\"No error passed\");\n    }\n    this.error = args.error;\n    this.error_description = (_a = args.error_description) != null ? _a : null;\n    this.error_uri = (_b = args.error_uri) != null ? _b : null;\n    this.state = args.userState;\n    this.session_state = (_c = args.session_state) != null ? _c : null;\n    this.url_state = args.url_state;\n  }\n};\n\n// src/errors/ErrorTimeout.ts\nvar ErrorTimeout = class extends Error {\n  constructor(message) {\n    super(message);\n    /** Marker to detect class: \"ErrorTimeout\" */\n    this.name = \"ErrorTimeout\";\n  }\n};\n\n// src/AccessTokenEvents.ts\nvar AccessTokenEvents = class {\n  constructor(args) {\n    this._logger = new Logger(\"AccessTokenEvents\");\n    this._expiringTimer = new Timer(\"Access token expiring\");\n    this._expiredTimer = new Timer(\"Access token expired\");\n    this._expiringNotificationTimeInSeconds = args.expiringNotificationTimeInSeconds;\n  }\n  async load(container) {\n    const logger2 = this._logger.create(\"load\");\n    if (container.access_token && container.expires_in !== void 0) {\n      const duration = container.expires_in;\n      logger2.debug(\"access token present, remaining duration:\", duration);\n      if (duration > 0) {\n        let expiring = duration - this._expiringNotificationTimeInSeconds;\n        if (expiring <= 0) {\n          expiring = 1;\n        }\n        logger2.debug(\"registering expiring timer, raising in\", expiring, \"seconds\");\n        this._expiringTimer.init(expiring);\n      } else {\n        logger2.debug(\"canceling existing expiring timer because we're past expiration.\");\n        this._expiringTimer.cancel();\n      }\n      const expired = duration + 1;\n      logger2.debug(\"registering expired timer, raising in\", expired, \"seconds\");\n      this._expiredTimer.init(expired);\n    } else {\n      this._expiringTimer.cancel();\n      this._expiredTimer.cancel();\n    }\n  }\n  async unload() {\n    this._logger.debug(\"unload: canceling existing access token timers\");\n    this._expiringTimer.cancel();\n    this._expiredTimer.cancel();\n  }\n  /**\n   * Add callback: Raised prior to the access token expiring.\n   */\n  addAccessTokenExpiring(cb) {\n    return this._expiringTimer.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised prior to the access token expiring.\n   */\n  removeAccessTokenExpiring(cb) {\n    this._expiringTimer.removeHandler(cb);\n  }\n  /**\n   * Add callback: Raised after the access token has expired.\n   */\n  addAccessTokenExpired(cb) {\n    return this._expiredTimer.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised after the access token has expired.\n   */\n  removeAccessTokenExpired(cb) {\n    this._expiredTimer.removeHandler(cb);\n  }\n};\n\n// src/CheckSessionIFrame.ts\nvar CheckSessionIFrame = class {\n  constructor(_callback, _client_id, url, _intervalInSeconds, _stopOnError) {\n    this._callback = _callback;\n    this._client_id = _client_id;\n    this._intervalInSeconds = _intervalInSeconds;\n    this._stopOnError = _stopOnError;\n    this._logger = new Logger(\"CheckSessionIFrame\");\n    this._timer = null;\n    this._session_state = null;\n    this._message = e => {\n      if (e.origin === this._frame_origin && e.source === this._frame.contentWindow) {\n        if (e.data === \"error\") {\n          this._logger.error(\"error message from check session op iframe\");\n          if (this._stopOnError) {\n            this.stop();\n          }\n        } else if (e.data === \"changed\") {\n          this._logger.debug(\"changed message from check session op iframe\");\n          this.stop();\n          void this._callback();\n        } else {\n          this._logger.debug(e.data + \" message from check session op iframe\");\n        }\n      }\n    };\n    const parsedUrl = new URL(url);\n    this._frame_origin = parsedUrl.origin;\n    this._frame = window.document.createElement(\"iframe\");\n    this._frame.style.visibility = \"hidden\";\n    this._frame.style.position = \"fixed\";\n    this._frame.style.left = \"-1000px\";\n    this._frame.style.top = \"0\";\n    this._frame.width = \"0\";\n    this._frame.height = \"0\";\n    this._frame.src = parsedUrl.href;\n  }\n  load() {\n    return new Promise(resolve => {\n      this._frame.onload = () => {\n        resolve();\n      };\n      window.document.body.appendChild(this._frame);\n      window.addEventListener(\"message\", this._message, false);\n    });\n  }\n  start(session_state) {\n    if (this._session_state === session_state) {\n      return;\n    }\n    this._logger.create(\"start\");\n    this.stop();\n    this._session_state = session_state;\n    const send = () => {\n      if (!this._frame.contentWindow || !this._session_state) {\n        return;\n      }\n      this._frame.contentWindow.postMessage(this._client_id + \" \" + this._session_state, this._frame_origin);\n    };\n    send();\n    this._timer = setInterval(send, this._intervalInSeconds * 1e3);\n  }\n  stop() {\n    this._logger.create(\"stop\");\n    this._session_state = null;\n    if (this._timer) {\n      clearInterval(this._timer);\n      this._timer = null;\n    }\n  }\n};\n\n// src/InMemoryWebStorage.ts\nvar InMemoryWebStorage = class {\n  constructor() {\n    this._logger = new Logger(\"InMemoryWebStorage\");\n    this._data = {};\n  }\n  clear() {\n    this._logger.create(\"clear\");\n    this._data = {};\n  }\n  getItem(key) {\n    this._logger.create(`getItem('${key}')`);\n    return this._data[key];\n  }\n  setItem(key, value) {\n    this._logger.create(`setItem('${key}')`);\n    this._data[key] = value;\n  }\n  removeItem(key) {\n    this._logger.create(`removeItem('${key}')`);\n    delete this._data[key];\n  }\n  get length() {\n    return Object.getOwnPropertyNames(this._data).length;\n  }\n  key(index) {\n    return Object.getOwnPropertyNames(this._data)[index];\n  }\n};\n\n// src/errors/ErrorDPoPNonce.ts\nvar ErrorDPoPNonce = class extends Error {\n  constructor(nonce, message) {\n    super(message);\n    /** Marker to detect class: \"ErrorDPoPNonce\" */\n    this.name = \"ErrorDPoPNonce\";\n    this.nonce = nonce;\n  }\n};\n\n// src/JsonService.ts\nvar JsonService = class {\n  constructor(additionalContentTypes = [], _jwtHandler = null, _extraHeaders = {}) {\n    this._jwtHandler = _jwtHandler;\n    this._extraHeaders = _extraHeaders;\n    this._logger = new Logger(\"JsonService\");\n    this._contentTypes = [];\n    this._contentTypes.push(...additionalContentTypes, \"application/json\");\n    if (_jwtHandler) {\n      this._contentTypes.push(\"application/jwt\");\n    }\n  }\n  async fetchWithTimeout(input, init = {}) {\n    const {\n      timeoutInSeconds,\n      ...initFetch\n    } = init;\n    if (!timeoutInSeconds) {\n      return await fetch(input, initFetch);\n    }\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), timeoutInSeconds * 1e3);\n    try {\n      const response = await fetch(input, {\n        ...init,\n        signal: controller.signal\n      });\n      return response;\n    } catch (err) {\n      if (err instanceof DOMException && err.name === \"AbortError\") {\n        throw new ErrorTimeout(\"Network timed out\");\n      }\n      throw err;\n    } finally {\n      clearTimeout(timeoutId);\n    }\n  }\n  async getJson(url, {\n    token,\n    credentials,\n    timeoutInSeconds\n  } = {}) {\n    const logger2 = this._logger.create(\"getJson\");\n    const headers = {\n      \"Accept\": this._contentTypes.join(\", \")\n    };\n    if (token) {\n      logger2.debug(\"token passed, setting Authorization header\");\n      headers[\"Authorization\"] = \"Bearer \" + token;\n    }\n    this._appendExtraHeaders(headers);\n    let response;\n    try {\n      logger2.debug(\"url:\", url);\n      response = await this.fetchWithTimeout(url, {\n        method: \"GET\",\n        headers,\n        timeoutInSeconds,\n        credentials\n      });\n    } catch (err) {\n      logger2.error(\"Network Error\");\n      throw err;\n    }\n    logger2.debug(\"HTTP response received, status\", response.status);\n    const contentType = response.headers.get(\"Content-Type\");\n    if (contentType && !this._contentTypes.find(item => contentType.startsWith(item))) {\n      logger2.throw(new Error(`Invalid response Content-Type: ${contentType != null ? contentType : \"undefined\"}, from URL: ${url}`));\n    }\n    if (response.ok && this._jwtHandler && (contentType == null ? void 0 : contentType.startsWith(\"application/jwt\"))) {\n      return await this._jwtHandler(await response.text());\n    }\n    let json;\n    try {\n      json = await response.json();\n    } catch (err) {\n      logger2.error(\"Error parsing JSON response\", err);\n      if (response.ok) throw err;\n      throw new Error(`${response.statusText} (${response.status})`);\n    }\n    if (!response.ok) {\n      logger2.error(\"Error from server:\", json);\n      if (json.error) {\n        throw new ErrorResponse(json);\n      }\n      throw new Error(`${response.statusText} (${response.status}): ${JSON.stringify(json)}`);\n    }\n    return json;\n  }\n  async postForm(url, {\n    body,\n    basicAuth,\n    timeoutInSeconds,\n    initCredentials,\n    extraHeaders\n  }) {\n    const logger2 = this._logger.create(\"postForm\");\n    const headers = {\n      \"Accept\": this._contentTypes.join(\", \"),\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n      ...extraHeaders\n    };\n    if (basicAuth !== void 0) {\n      headers[\"Authorization\"] = \"Basic \" + basicAuth;\n    }\n    this._appendExtraHeaders(headers);\n    let response;\n    try {\n      logger2.debug(\"url:\", url);\n      response = await this.fetchWithTimeout(url, {\n        method: \"POST\",\n        headers,\n        body,\n        timeoutInSeconds,\n        credentials: initCredentials\n      });\n    } catch (err) {\n      logger2.error(\"Network error\");\n      throw err;\n    }\n    logger2.debug(\"HTTP response received, status\", response.status);\n    const contentType = response.headers.get(\"Content-Type\");\n    if (contentType && !this._contentTypes.find(item => contentType.startsWith(item))) {\n      throw new Error(`Invalid response Content-Type: ${contentType != null ? contentType : \"undefined\"}, from URL: ${url}`);\n    }\n    const responseText = await response.text();\n    let json = {};\n    if (responseText) {\n      try {\n        json = JSON.parse(responseText);\n      } catch (err) {\n        logger2.error(\"Error parsing JSON response\", err);\n        if (response.ok) throw err;\n        throw new Error(`${response.statusText} (${response.status})`);\n      }\n    }\n    if (!response.ok) {\n      logger2.error(\"Error from server:\", json);\n      if (response.headers.has(\"dpop-nonce\")) {\n        const nonce = response.headers.get(\"dpop-nonce\");\n        throw new ErrorDPoPNonce(nonce, `${JSON.stringify(json)}`);\n      }\n      if (json.error) {\n        throw new ErrorResponse(json, body);\n      }\n      throw new Error(`${response.statusText} (${response.status}): ${JSON.stringify(json)}`);\n    }\n    return json;\n  }\n  _appendExtraHeaders(headers) {\n    const logger2 = this._logger.create(\"appendExtraHeaders\");\n    const customKeys = Object.keys(this._extraHeaders);\n    const protectedHeaders = [\"accept\", \"content-type\"];\n    const preventOverride = [\"authorization\"];\n    if (customKeys.length === 0) {\n      return;\n    }\n    customKeys.forEach(headerName => {\n      if (protectedHeaders.includes(headerName.toLocaleLowerCase())) {\n        logger2.warn(\"Protected header could not be set\", headerName, protectedHeaders);\n        return;\n      }\n      if (preventOverride.includes(headerName.toLocaleLowerCase()) && Object.keys(headers).includes(headerName)) {\n        logger2.warn(\"Header could not be overridden\", headerName, preventOverride);\n        return;\n      }\n      const content = typeof this._extraHeaders[headerName] === \"function\" ? this._extraHeaders[headerName]() : this._extraHeaders[headerName];\n      if (content && content !== \"\") {\n        headers[headerName] = content;\n      }\n    });\n  }\n};\n\n// src/MetadataService.ts\nvar MetadataService = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"MetadataService\");\n    this._signingKeys = null;\n    this._metadata = null;\n    this._metadataUrl = this._settings.metadataUrl;\n    this._jsonService = new JsonService([\"application/jwk-set+json\"], null, this._settings.extraHeaders);\n    if (this._settings.signingKeys) {\n      this._logger.debug(\"using signingKeys from settings\");\n      this._signingKeys = this._settings.signingKeys;\n    }\n    if (this._settings.metadata) {\n      this._logger.debug(\"using metadata from settings\");\n      this._metadata = this._settings.metadata;\n    }\n    if (this._settings.fetchRequestCredentials) {\n      this._logger.debug(\"using fetchRequestCredentials from settings\");\n      this._fetchRequestCredentials = this._settings.fetchRequestCredentials;\n    }\n  }\n  resetSigningKeys() {\n    this._signingKeys = null;\n  }\n  async getMetadata() {\n    const logger2 = this._logger.create(\"getMetadata\");\n    if (this._metadata) {\n      logger2.debug(\"using cached values\");\n      return this._metadata;\n    }\n    if (!this._metadataUrl) {\n      logger2.throw(new Error(\"No authority or metadataUrl configured on settings\"));\n      throw null;\n    }\n    logger2.debug(\"getting metadata from\", this._metadataUrl);\n    const metadata = await this._jsonService.getJson(this._metadataUrl, {\n      credentials: this._fetchRequestCredentials,\n      timeoutInSeconds: this._settings.requestTimeoutInSeconds\n    });\n    logger2.debug(\"merging remote JSON with seed metadata\");\n    this._metadata = Object.assign({}, metadata, this._settings.metadataSeed);\n    return this._metadata;\n  }\n  getIssuer() {\n    return this._getMetadataProperty(\"issuer\");\n  }\n  getAuthorizationEndpoint() {\n    return this._getMetadataProperty(\"authorization_endpoint\");\n  }\n  getUserInfoEndpoint() {\n    return this._getMetadataProperty(\"userinfo_endpoint\");\n  }\n  getTokenEndpoint(optional = true) {\n    return this._getMetadataProperty(\"token_endpoint\", optional);\n  }\n  getCheckSessionIframe() {\n    return this._getMetadataProperty(\"check_session_iframe\", true);\n  }\n  getEndSessionEndpoint() {\n    return this._getMetadataProperty(\"end_session_endpoint\", true);\n  }\n  getRevocationEndpoint(optional = true) {\n    return this._getMetadataProperty(\"revocation_endpoint\", optional);\n  }\n  getKeysEndpoint(optional = true) {\n    return this._getMetadataProperty(\"jwks_uri\", optional);\n  }\n  async _getMetadataProperty(name, optional = false) {\n    const logger2 = this._logger.create(`_getMetadataProperty('${name}')`);\n    const metadata = await this.getMetadata();\n    logger2.debug(\"resolved\");\n    if (metadata[name] === void 0) {\n      if (optional === true) {\n        logger2.warn(\"Metadata does not contain optional property\");\n        return void 0;\n      }\n      logger2.throw(new Error(\"Metadata does not contain property \" + name));\n    }\n    return metadata[name];\n  }\n  async getSigningKeys() {\n    const logger2 = this._logger.create(\"getSigningKeys\");\n    if (this._signingKeys) {\n      logger2.debug(\"returning signingKeys from cache\");\n      return this._signingKeys;\n    }\n    const jwks_uri = await this.getKeysEndpoint(false);\n    logger2.debug(\"got jwks_uri\", jwks_uri);\n    const keySet = await this._jsonService.getJson(jwks_uri, {\n      timeoutInSeconds: this._settings.requestTimeoutInSeconds\n    });\n    logger2.debug(\"got key set\", keySet);\n    if (!Array.isArray(keySet.keys)) {\n      logger2.throw(new Error(\"Missing keys on keyset\"));\n      throw null;\n    }\n    this._signingKeys = keySet.keys;\n    return this._signingKeys;\n  }\n};\n\n// src/WebStorageStateStore.ts\nvar WebStorageStateStore = class {\n  constructor({\n    prefix = \"oidc.\",\n    store = localStorage\n  } = {}) {\n    this._logger = new Logger(\"WebStorageStateStore\");\n    this._store = store;\n    this._prefix = prefix;\n  }\n  async set(key, value) {\n    this._logger.create(`set('${key}')`);\n    key = this._prefix + key;\n    await this._store.setItem(key, value);\n  }\n  async get(key) {\n    this._logger.create(`get('${key}')`);\n    key = this._prefix + key;\n    const item = await this._store.getItem(key);\n    return item;\n  }\n  async remove(key) {\n    this._logger.create(`remove('${key}')`);\n    key = this._prefix + key;\n    const item = await this._store.getItem(key);\n    await this._store.removeItem(key);\n    return item;\n  }\n  async getAllKeys() {\n    this._logger.create(\"getAllKeys\");\n    const len = await this._store.length;\n    const keys = [];\n    for (let index = 0; index < len; index++) {\n      const key = await this._store.key(index);\n      if (key && key.indexOf(this._prefix) === 0) {\n        keys.push(key.substr(this._prefix.length));\n      }\n    }\n    return keys;\n  }\n};\n\n// src/OidcClientSettings.ts\nvar DefaultResponseType = \"code\";\nvar DefaultScope = \"openid\";\nvar DefaultClientAuthentication = \"client_secret_post\";\nvar DefaultStaleStateAgeInSeconds = 60 * 15;\nvar OidcClientSettingsStore = class {\n  constructor({\n    // metadata related\n    authority,\n    metadataUrl,\n    metadata,\n    signingKeys,\n    metadataSeed,\n    // client related\n    client_id,\n    client_secret,\n    response_type = DefaultResponseType,\n    scope = DefaultScope,\n    redirect_uri,\n    post_logout_redirect_uri,\n    client_authentication = DefaultClientAuthentication,\n    // optional protocol\n    prompt,\n    display,\n    max_age,\n    ui_locales,\n    acr_values,\n    resource,\n    response_mode,\n    // behavior flags\n    filterProtocolClaims = true,\n    loadUserInfo = false,\n    requestTimeoutInSeconds,\n    staleStateAgeInSeconds = DefaultStaleStateAgeInSeconds,\n    mergeClaimsStrategy = {\n      array: \"replace\"\n    },\n    disablePKCE = false,\n    // other behavior\n    stateStore,\n    revokeTokenAdditionalContentTypes,\n    fetchRequestCredentials,\n    refreshTokenAllowedScope,\n    // extra\n    extraQueryParams = {},\n    extraTokenParams = {},\n    extraHeaders = {},\n    dpop,\n    omitScopeWhenRequesting = false\n  }) {\n    var _a;\n    this.authority = authority;\n    if (metadataUrl) {\n      this.metadataUrl = metadataUrl;\n    } else {\n      this.metadataUrl = authority;\n      if (authority) {\n        if (!this.metadataUrl.endsWith(\"/\")) {\n          this.metadataUrl += \"/\";\n        }\n        this.metadataUrl += \".well-known/openid-configuration\";\n      }\n    }\n    this.metadata = metadata;\n    this.metadataSeed = metadataSeed;\n    this.signingKeys = signingKeys;\n    this.client_id = client_id;\n    this.client_secret = client_secret;\n    this.response_type = response_type;\n    this.scope = scope;\n    this.redirect_uri = redirect_uri;\n    this.post_logout_redirect_uri = post_logout_redirect_uri;\n    this.client_authentication = client_authentication;\n    this.prompt = prompt;\n    this.display = display;\n    this.max_age = max_age;\n    this.ui_locales = ui_locales;\n    this.acr_values = acr_values;\n    this.resource = resource;\n    this.response_mode = response_mode;\n    this.filterProtocolClaims = filterProtocolClaims != null ? filterProtocolClaims : true;\n    this.loadUserInfo = !!loadUserInfo;\n    this.staleStateAgeInSeconds = staleStateAgeInSeconds;\n    this.mergeClaimsStrategy = mergeClaimsStrategy;\n    this.omitScopeWhenRequesting = omitScopeWhenRequesting;\n    this.disablePKCE = !!disablePKCE;\n    this.revokeTokenAdditionalContentTypes = revokeTokenAdditionalContentTypes;\n    this.fetchRequestCredentials = fetchRequestCredentials ? fetchRequestCredentials : \"same-origin\";\n    this.requestTimeoutInSeconds = requestTimeoutInSeconds;\n    if (stateStore) {\n      this.stateStore = stateStore;\n    } else {\n      const store = typeof window !== \"undefined\" ? window.localStorage : new InMemoryWebStorage();\n      this.stateStore = new WebStorageStateStore({\n        store\n      });\n    }\n    this.refreshTokenAllowedScope = refreshTokenAllowedScope;\n    this.extraQueryParams = extraQueryParams;\n    this.extraTokenParams = extraTokenParams;\n    this.extraHeaders = extraHeaders;\n    this.dpop = dpop;\n    if (this.dpop && !((_a = this.dpop) == null ? void 0 : _a.store)) {\n      throw new Error(\"A DPoPStore is required when dpop is enabled\");\n    }\n  }\n};\n\n// src/UserInfoService.ts\nvar UserInfoService = class {\n  constructor(_settings, _metadataService) {\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._logger = new Logger(\"UserInfoService\");\n    this._getClaimsFromJwt = async responseText => {\n      const logger2 = this._logger.create(\"_getClaimsFromJwt\");\n      try {\n        const payload = JwtUtils.decode(responseText);\n        logger2.debug(\"JWT decoding successful\");\n        return payload;\n      } catch (err) {\n        logger2.error(\"Error parsing JWT response\");\n        throw err;\n      }\n    };\n    this._jsonService = new JsonService(void 0, this._getClaimsFromJwt, this._settings.extraHeaders);\n  }\n  async getClaims(token) {\n    const logger2 = this._logger.create(\"getClaims\");\n    if (!token) {\n      this._logger.throw(new Error(\"No token passed\"));\n    }\n    const url = await this._metadataService.getUserInfoEndpoint();\n    logger2.debug(\"got userinfo url\", url);\n    const claims = await this._jsonService.getJson(url, {\n      token,\n      credentials: this._settings.fetchRequestCredentials,\n      timeoutInSeconds: this._settings.requestTimeoutInSeconds\n    });\n    logger2.debug(\"got claims\", claims);\n    return claims;\n  }\n};\n\n// src/TokenClient.ts\nvar TokenClient = class {\n  constructor(_settings, _metadataService) {\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._logger = new Logger(\"TokenClient\");\n    this._jsonService = new JsonService(this._settings.revokeTokenAdditionalContentTypes, null, this._settings.extraHeaders);\n  }\n  /**\n   * Exchange code.\n   *\n   * @see https://www.rfc-editor.org/rfc/rfc6749#section-4.1.3\n   */\n  async exchangeCode({\n    grant_type = \"authorization_code\",\n    redirect_uri = this._settings.redirect_uri,\n    client_id = this._settings.client_id,\n    client_secret = this._settings.client_secret,\n    extraHeaders,\n    ...args\n  }) {\n    const logger2 = this._logger.create(\"exchangeCode\");\n    if (!client_id) {\n      logger2.throw(new Error(\"A client_id is required\"));\n    }\n    if (!redirect_uri) {\n      logger2.throw(new Error(\"A redirect_uri is required\"));\n    }\n    if (!args.code) {\n      logger2.throw(new Error(\"A code is required\"));\n    }\n    const params = new URLSearchParams({\n      grant_type,\n      redirect_uri\n    });\n    for (const [key, value] of Object.entries(args)) {\n      if (value != null) {\n        params.set(key, value);\n      }\n    }\n    let basicAuth;\n    switch (this._settings.client_authentication) {\n      case \"client_secret_basic\":\n        if (client_secret === void 0 || client_secret === null) {\n          logger2.throw(new Error(\"A client_secret is required\"));\n          throw null;\n        }\n        basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n        break;\n      case \"client_secret_post\":\n        params.append(\"client_id\", client_id);\n        if (client_secret) {\n          params.append(\"client_secret\", client_secret);\n        }\n        break;\n    }\n    const url = await this._metadataService.getTokenEndpoint(false);\n    logger2.debug(\"got token endpoint\");\n    const response = await this._jsonService.postForm(url, {\n      body: params,\n      basicAuth,\n      timeoutInSeconds: this._settings.requestTimeoutInSeconds,\n      initCredentials: this._settings.fetchRequestCredentials,\n      extraHeaders\n    });\n    logger2.debug(\"got response\");\n    return response;\n  }\n  /**\n   * Exchange credentials.\n   *\n   * @see https://www.rfc-editor.org/rfc/rfc6749#section-4.3.2\n   */\n  async exchangeCredentials({\n    grant_type = \"password\",\n    client_id = this._settings.client_id,\n    client_secret = this._settings.client_secret,\n    scope = this._settings.scope,\n    ...args\n  }) {\n    const logger2 = this._logger.create(\"exchangeCredentials\");\n    if (!client_id) {\n      logger2.throw(new Error(\"A client_id is required\"));\n    }\n    const params = new URLSearchParams({\n      grant_type\n    });\n    if (!this._settings.omitScopeWhenRequesting) {\n      params.set(\"scope\", scope);\n    }\n    for (const [key, value] of Object.entries(args)) {\n      if (value != null) {\n        params.set(key, value);\n      }\n    }\n    let basicAuth;\n    switch (this._settings.client_authentication) {\n      case \"client_secret_basic\":\n        if (client_secret === void 0 || client_secret === null) {\n          logger2.throw(new Error(\"A client_secret is required\"));\n          throw null;\n        }\n        basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n        break;\n      case \"client_secret_post\":\n        params.append(\"client_id\", client_id);\n        if (client_secret) {\n          params.append(\"client_secret\", client_secret);\n        }\n        break;\n    }\n    const url = await this._metadataService.getTokenEndpoint(false);\n    logger2.debug(\"got token endpoint\");\n    const response = await this._jsonService.postForm(url, {\n      body: params,\n      basicAuth,\n      timeoutInSeconds: this._settings.requestTimeoutInSeconds,\n      initCredentials: this._settings.fetchRequestCredentials\n    });\n    logger2.debug(\"got response\");\n    return response;\n  }\n  /**\n   * Exchange a refresh token.\n   *\n   * @see https://www.rfc-editor.org/rfc/rfc6749#section-6\n   */\n  async exchangeRefreshToken({\n    grant_type = \"refresh_token\",\n    client_id = this._settings.client_id,\n    client_secret = this._settings.client_secret,\n    timeoutInSeconds,\n    extraHeaders,\n    ...args\n  }) {\n    const logger2 = this._logger.create(\"exchangeRefreshToken\");\n    if (!client_id) {\n      logger2.throw(new Error(\"A client_id is required\"));\n    }\n    if (!args.refresh_token) {\n      logger2.throw(new Error(\"A refresh_token is required\"));\n    }\n    const params = new URLSearchParams({\n      grant_type\n    });\n    for (const [key, value] of Object.entries(args)) {\n      if (Array.isArray(value)) {\n        value.forEach(param => params.append(key, param));\n      } else if (value != null) {\n        params.set(key, value);\n      }\n    }\n    let basicAuth;\n    switch (this._settings.client_authentication) {\n      case \"client_secret_basic\":\n        if (client_secret === void 0 || client_secret === null) {\n          logger2.throw(new Error(\"A client_secret is required\"));\n          throw null;\n        }\n        basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n        break;\n      case \"client_secret_post\":\n        params.append(\"client_id\", client_id);\n        if (client_secret) {\n          params.append(\"client_secret\", client_secret);\n        }\n        break;\n    }\n    const url = await this._metadataService.getTokenEndpoint(false);\n    logger2.debug(\"got token endpoint\");\n    const response = await this._jsonService.postForm(url, {\n      body: params,\n      basicAuth,\n      timeoutInSeconds,\n      initCredentials: this._settings.fetchRequestCredentials,\n      extraHeaders\n    });\n    logger2.debug(\"got response\");\n    return response;\n  }\n  /**\n   * Revoke an access or refresh token.\n   *\n   * @see https://datatracker.ietf.org/doc/html/rfc7009#section-2.1\n   */\n  async revoke(args) {\n    var _a;\n    const logger2 = this._logger.create(\"revoke\");\n    if (!args.token) {\n      logger2.throw(new Error(\"A token is required\"));\n    }\n    const url = await this._metadataService.getRevocationEndpoint(false);\n    logger2.debug(`got revocation endpoint, revoking ${(_a = args.token_type_hint) != null ? _a : \"default token type\"}`);\n    const params = new URLSearchParams();\n    for (const [key, value] of Object.entries(args)) {\n      if (value != null) {\n        params.set(key, value);\n      }\n    }\n    params.set(\"client_id\", this._settings.client_id);\n    if (this._settings.client_secret) {\n      params.set(\"client_secret\", this._settings.client_secret);\n    }\n    await this._jsonService.postForm(url, {\n      body: params,\n      timeoutInSeconds: this._settings.requestTimeoutInSeconds\n    });\n    logger2.debug(\"got response\");\n  }\n};\n\n// src/ResponseValidator.ts\nvar ResponseValidator = class {\n  constructor(_settings, _metadataService, _claimsService) {\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._claimsService = _claimsService;\n    this._logger = new Logger(\"ResponseValidator\");\n    this._userInfoService = new UserInfoService(this._settings, this._metadataService);\n    this._tokenClient = new TokenClient(this._settings, this._metadataService);\n  }\n  async validateSigninResponse(response, state, extraHeaders) {\n    const logger2 = this._logger.create(\"validateSigninResponse\");\n    this._processSigninState(response, state);\n    logger2.debug(\"state processed\");\n    await this._processCode(response, state, extraHeaders);\n    logger2.debug(\"code processed\");\n    if (response.isOpenId) {\n      this._validateIdTokenAttributes(response);\n    }\n    logger2.debug(\"tokens validated\");\n    await this._processClaims(response, state == null ? void 0 : state.skipUserInfo, response.isOpenId);\n    logger2.debug(\"claims processed\");\n  }\n  async validateCredentialsResponse(response, skipUserInfo) {\n    const logger2 = this._logger.create(\"validateCredentialsResponse\");\n    const shouldValidateSubClaim = response.isOpenId && !!response.id_token;\n    if (shouldValidateSubClaim) {\n      this._validateIdTokenAttributes(response);\n    }\n    logger2.debug(\"tokens validated\");\n    await this._processClaims(response, skipUserInfo, shouldValidateSubClaim);\n    logger2.debug(\"claims processed\");\n  }\n  async validateRefreshResponse(response, state) {\n    var _a, _b;\n    const logger2 = this._logger.create(\"validateRefreshResponse\");\n    response.userState = state.data;\n    (_a = response.session_state) != null ? _a : response.session_state = state.session_state;\n    (_b = response.scope) != null ? _b : response.scope = state.scope;\n    if (response.isOpenId && !!response.id_token) {\n      this._validateIdTokenAttributes(response, state.id_token);\n      logger2.debug(\"ID Token validated\");\n    }\n    if (!response.id_token) {\n      response.id_token = state.id_token;\n      response.profile = state.profile;\n    }\n    const hasIdToken = response.isOpenId && !!response.id_token;\n    await this._processClaims(response, false, hasIdToken);\n    logger2.debug(\"claims processed\");\n  }\n  validateSignoutResponse(response, state) {\n    const logger2 = this._logger.create(\"validateSignoutResponse\");\n    if (state.id !== response.state) {\n      logger2.throw(new Error(\"State does not match\"));\n    }\n    logger2.debug(\"state validated\");\n    response.userState = state.data;\n    if (response.error) {\n      logger2.warn(\"Response was error\", response.error);\n      throw new ErrorResponse(response);\n    }\n  }\n  _processSigninState(response, state) {\n    var _a;\n    const logger2 = this._logger.create(\"_processSigninState\");\n    if (state.id !== response.state) {\n      logger2.throw(new Error(\"State does not match\"));\n    }\n    if (!state.client_id) {\n      logger2.throw(new Error(\"No client_id on state\"));\n    }\n    if (!state.authority) {\n      logger2.throw(new Error(\"No authority on state\"));\n    }\n    if (this._settings.authority !== state.authority) {\n      logger2.throw(new Error(\"authority mismatch on settings vs. signin state\"));\n    }\n    if (this._settings.client_id && this._settings.client_id !== state.client_id) {\n      logger2.throw(new Error(\"client_id mismatch on settings vs. signin state\"));\n    }\n    logger2.debug(\"state validated\");\n    response.userState = state.data;\n    response.url_state = state.url_state;\n    (_a = response.scope) != null ? _a : response.scope = state.scope;\n    if (response.error) {\n      logger2.warn(\"Response was error\", response.error);\n      throw new ErrorResponse(response);\n    }\n    if (state.code_verifier && !response.code) {\n      logger2.throw(new Error(\"Expected code in response\"));\n    }\n  }\n  async _processClaims(response, skipUserInfo = false, validateSub = true) {\n    const logger2 = this._logger.create(\"_processClaims\");\n    response.profile = this._claimsService.filterProtocolClaims(response.profile);\n    if (skipUserInfo || !this._settings.loadUserInfo || !response.access_token) {\n      logger2.debug(\"not loading user info\");\n      return;\n    }\n    logger2.debug(\"loading user info\");\n    const claims = await this._userInfoService.getClaims(response.access_token);\n    logger2.debug(\"user info claims received from user info endpoint\");\n    if (validateSub && claims.sub !== response.profile.sub) {\n      logger2.throw(new Error(\"subject from UserInfo response does not match subject in ID Token\"));\n    }\n    response.profile = this._claimsService.mergeClaims(response.profile, this._claimsService.filterProtocolClaims(claims));\n    logger2.debug(\"user info claims received, updated profile:\", response.profile);\n  }\n  async _processCode(response, state, extraHeaders) {\n    const logger2 = this._logger.create(\"_processCode\");\n    if (response.code) {\n      logger2.debug(\"Validating code\");\n      const tokenResponse = await this._tokenClient.exchangeCode({\n        client_id: state.client_id,\n        client_secret: state.client_secret,\n        code: response.code,\n        redirect_uri: state.redirect_uri,\n        code_verifier: state.code_verifier,\n        extraHeaders,\n        ...state.extraTokenParams\n      });\n      Object.assign(response, tokenResponse);\n    } else {\n      logger2.debug(\"No code to process\");\n    }\n  }\n  _validateIdTokenAttributes(response, existingToken) {\n    var _a;\n    const logger2 = this._logger.create(\"_validateIdTokenAttributes\");\n    logger2.debug(\"decoding ID Token JWT\");\n    const incoming = JwtUtils.decode((_a = response.id_token) != null ? _a : \"\");\n    if (!incoming.sub) {\n      logger2.throw(new Error(\"ID Token is missing a subject claim\"));\n    }\n    if (existingToken) {\n      const existing = JwtUtils.decode(existingToken);\n      if (incoming.sub !== existing.sub) {\n        logger2.throw(new Error(\"sub in id_token does not match current sub\"));\n      }\n      if (incoming.auth_time && incoming.auth_time !== existing.auth_time) {\n        logger2.throw(new Error(\"auth_time in id_token does not match original auth_time\"));\n      }\n      if (incoming.azp && incoming.azp !== existing.azp) {\n        logger2.throw(new Error(\"azp in id_token does not match original azp\"));\n      }\n      if (!incoming.azp && existing.azp) {\n        logger2.throw(new Error(\"azp not in id_token, but present in original id_token\"));\n      }\n    }\n    response.profile = incoming;\n  }\n};\n\n// src/State.ts\nvar State = class _State {\n  constructor(args) {\n    this.id = args.id || CryptoUtils.generateUUIDv4();\n    this.data = args.data;\n    if (args.created && args.created > 0) {\n      this.created = args.created;\n    } else {\n      this.created = Timer.getEpochTime();\n    }\n    this.request_type = args.request_type;\n    this.url_state = args.url_state;\n  }\n  toStorageString() {\n    new Logger(\"State\").create(\"toStorageString\");\n    return JSON.stringify({\n      id: this.id,\n      data: this.data,\n      created: this.created,\n      request_type: this.request_type,\n      url_state: this.url_state\n    });\n  }\n  static fromStorageString(storageString) {\n    Logger.createStatic(\"State\", \"fromStorageString\");\n    return Promise.resolve(new _State(JSON.parse(storageString)));\n  }\n  static async clearStaleState(storage, age) {\n    const logger2 = Logger.createStatic(\"State\", \"clearStaleState\");\n    const cutoff = Timer.getEpochTime() - age;\n    const keys = await storage.getAllKeys();\n    logger2.debug(\"got keys\", keys);\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      const item = await storage.get(key);\n      let remove = false;\n      if (item) {\n        try {\n          const state = await _State.fromStorageString(item);\n          logger2.debug(\"got item from key:\", key, state.created);\n          if (state.created <= cutoff) {\n            remove = true;\n          }\n        } catch (err) {\n          logger2.error(\"Error parsing state for key:\", key, err);\n          remove = true;\n        }\n      } else {\n        logger2.debug(\"no item in storage for key:\", key);\n        remove = true;\n      }\n      if (remove) {\n        logger2.debug(\"removed item for key:\", key);\n        void storage.remove(key);\n      }\n    }\n  }\n};\n\n// src/SigninState.ts\nvar SigninState = class _SigninState extends State {\n  constructor(args) {\n    super(args);\n    this.code_verifier = args.code_verifier;\n    this.code_challenge = args.code_challenge;\n    this.authority = args.authority;\n    this.client_id = args.client_id;\n    this.redirect_uri = args.redirect_uri;\n    this.scope = args.scope;\n    this.client_secret = args.client_secret;\n    this.extraTokenParams = args.extraTokenParams;\n    this.response_mode = args.response_mode;\n    this.skipUserInfo = args.skipUserInfo;\n  }\n  static async create(args) {\n    const code_verifier = args.code_verifier === true ? CryptoUtils.generateCodeVerifier() : args.code_verifier || void 0;\n    const code_challenge = code_verifier ? await CryptoUtils.generateCodeChallenge(code_verifier) : void 0;\n    return new _SigninState({\n      ...args,\n      code_verifier,\n      code_challenge\n    });\n  }\n  toStorageString() {\n    new Logger(\"SigninState\").create(\"toStorageString\");\n    return JSON.stringify({\n      id: this.id,\n      data: this.data,\n      created: this.created,\n      request_type: this.request_type,\n      url_state: this.url_state,\n      code_verifier: this.code_verifier,\n      authority: this.authority,\n      client_id: this.client_id,\n      redirect_uri: this.redirect_uri,\n      scope: this.scope,\n      client_secret: this.client_secret,\n      extraTokenParams: this.extraTokenParams,\n      response_mode: this.response_mode,\n      skipUserInfo: this.skipUserInfo\n    });\n  }\n  static fromStorageString(storageString) {\n    Logger.createStatic(\"SigninState\", \"fromStorageString\");\n    const data = JSON.parse(storageString);\n    return _SigninState.create(data);\n  }\n};\n\n// src/SigninRequest.ts\nvar _SigninRequest = class _SigninRequest {\n  constructor(args) {\n    this.url = args.url;\n    this.state = args.state;\n  }\n  static async create({\n    // mandatory\n    url,\n    authority,\n    client_id,\n    redirect_uri,\n    response_type,\n    scope,\n    // optional\n    state_data,\n    response_mode,\n    request_type,\n    client_secret,\n    nonce,\n    url_state,\n    resource,\n    skipUserInfo,\n    extraQueryParams,\n    extraTokenParams,\n    disablePKCE,\n    dpopJkt,\n    omitScopeWhenRequesting,\n    ...optionalParams\n  }) {\n    if (!url) {\n      this._logger.error(\"create: No url passed\");\n      throw new Error(\"url\");\n    }\n    if (!client_id) {\n      this._logger.error(\"create: No client_id passed\");\n      throw new Error(\"client_id\");\n    }\n    if (!redirect_uri) {\n      this._logger.error(\"create: No redirect_uri passed\");\n      throw new Error(\"redirect_uri\");\n    }\n    if (!response_type) {\n      this._logger.error(\"create: No response_type passed\");\n      throw new Error(\"response_type\");\n    }\n    if (!scope) {\n      this._logger.error(\"create: No scope passed\");\n      throw new Error(\"scope\");\n    }\n    if (!authority) {\n      this._logger.error(\"create: No authority passed\");\n      throw new Error(\"authority\");\n    }\n    const state = await SigninState.create({\n      data: state_data,\n      request_type,\n      url_state,\n      code_verifier: !disablePKCE,\n      client_id,\n      authority,\n      redirect_uri,\n      response_mode,\n      client_secret,\n      scope,\n      extraTokenParams,\n      skipUserInfo\n    });\n    const parsedUrl = new URL(url);\n    parsedUrl.searchParams.append(\"client_id\", client_id);\n    parsedUrl.searchParams.append(\"redirect_uri\", redirect_uri);\n    parsedUrl.searchParams.append(\"response_type\", response_type);\n    if (!omitScopeWhenRequesting) {\n      parsedUrl.searchParams.append(\"scope\", scope);\n    }\n    if (nonce) {\n      parsedUrl.searchParams.append(\"nonce\", nonce);\n    }\n    if (dpopJkt) {\n      parsedUrl.searchParams.append(\"dpop_jkt\", dpopJkt);\n    }\n    let stateParam = state.id;\n    if (url_state) {\n      stateParam = `${stateParam}${URL_STATE_DELIMITER}${url_state}`;\n    }\n    parsedUrl.searchParams.append(\"state\", stateParam);\n    if (state.code_challenge) {\n      parsedUrl.searchParams.append(\"code_challenge\", state.code_challenge);\n      parsedUrl.searchParams.append(\"code_challenge_method\", \"S256\");\n    }\n    if (resource) {\n      const resources = Array.isArray(resource) ? resource : [resource];\n      resources.forEach(r => parsedUrl.searchParams.append(\"resource\", r));\n    }\n    for (const [key, value] of Object.entries({\n      response_mode,\n      ...optionalParams,\n      ...extraQueryParams\n    })) {\n      if (value != null) {\n        parsedUrl.searchParams.append(key, value.toString());\n      }\n    }\n    return new _SigninRequest({\n      url: parsedUrl.href,\n      state\n    });\n  }\n};\n_SigninRequest._logger = new Logger(\"SigninRequest\");\nvar SigninRequest = _SigninRequest;\n\n// src/SigninResponse.ts\nvar OidcScope = \"openid\";\nvar SigninResponse = class {\n  constructor(params) {\n    /** @see {@link User.access_token} */\n    this.access_token = \"\";\n    /** @see {@link User.token_type} */\n    this.token_type = \"\";\n    /** @see {@link User.profile} */\n    this.profile = {};\n    this.state = params.get(\"state\");\n    this.session_state = params.get(\"session_state\");\n    if (this.state) {\n      const splitState = decodeURIComponent(this.state).split(URL_STATE_DELIMITER);\n      this.state = splitState[0];\n      if (splitState.length > 1) {\n        this.url_state = splitState.slice(1).join(URL_STATE_DELIMITER);\n      }\n    }\n    this.error = params.get(\"error\");\n    this.error_description = params.get(\"error_description\");\n    this.error_uri = params.get(\"error_uri\");\n    this.code = params.get(\"code\");\n  }\n  get expires_in() {\n    if (this.expires_at === void 0) {\n      return void 0;\n    }\n    return this.expires_at - Timer.getEpochTime();\n  }\n  set expires_in(value) {\n    if (typeof value === \"string\") value = Number(value);\n    if (value !== void 0 && value >= 0) {\n      this.expires_at = Math.floor(value) + Timer.getEpochTime();\n    }\n  }\n  get isOpenId() {\n    var _a;\n    return ((_a = this.scope) == null ? void 0 : _a.split(\" \").includes(OidcScope)) || !!this.id_token;\n  }\n};\n\n// src/SignoutRequest.ts\nvar SignoutRequest = class {\n  constructor({\n    url,\n    state_data,\n    id_token_hint,\n    post_logout_redirect_uri,\n    extraQueryParams,\n    request_type,\n    client_id,\n    url_state\n  }) {\n    this._logger = new Logger(\"SignoutRequest\");\n    if (!url) {\n      this._logger.error(\"ctor: No url passed\");\n      throw new Error(\"url\");\n    }\n    const parsedUrl = new URL(url);\n    if (id_token_hint) {\n      parsedUrl.searchParams.append(\"id_token_hint\", id_token_hint);\n    }\n    if (client_id) {\n      parsedUrl.searchParams.append(\"client_id\", client_id);\n    }\n    if (post_logout_redirect_uri) {\n      parsedUrl.searchParams.append(\"post_logout_redirect_uri\", post_logout_redirect_uri);\n      if (state_data || url_state) {\n        this.state = new State({\n          data: state_data,\n          request_type,\n          url_state\n        });\n        let stateParam = this.state.id;\n        if (url_state) {\n          stateParam = `${stateParam}${URL_STATE_DELIMITER}${url_state}`;\n        }\n        parsedUrl.searchParams.append(\"state\", stateParam);\n      }\n    }\n    for (const [key, value] of Object.entries({\n      ...extraQueryParams\n    })) {\n      if (value != null) {\n        parsedUrl.searchParams.append(key, value.toString());\n      }\n    }\n    this.url = parsedUrl.href;\n  }\n};\n\n// src/SignoutResponse.ts\nvar SignoutResponse = class {\n  constructor(params) {\n    this.state = params.get(\"state\");\n    if (this.state) {\n      const splitState = decodeURIComponent(this.state).split(URL_STATE_DELIMITER);\n      this.state = splitState[0];\n      if (splitState.length > 1) {\n        this.url_state = splitState.slice(1).join(URL_STATE_DELIMITER);\n      }\n    }\n    this.error = params.get(\"error\");\n    this.error_description = params.get(\"error_description\");\n    this.error_uri = params.get(\"error_uri\");\n  }\n};\n\n// src/ClaimsService.ts\nvar DefaultProtocolClaims = [\"nbf\", \"jti\", \"auth_time\", \"nonce\", \"acr\", \"amr\", \"azp\", \"at_hash\"\n// https://openid.net/specs/openid-connect-core-1_0.html#CodeIDToken\n];\nvar InternalRequiredProtocolClaims = [\"sub\", \"iss\", \"aud\", \"exp\", \"iat\"];\nvar ClaimsService = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"ClaimsService\");\n  }\n  filterProtocolClaims(claims) {\n    const result = {\n      ...claims\n    };\n    if (this._settings.filterProtocolClaims) {\n      let protocolClaims;\n      if (Array.isArray(this._settings.filterProtocolClaims)) {\n        protocolClaims = this._settings.filterProtocolClaims;\n      } else {\n        protocolClaims = DefaultProtocolClaims;\n      }\n      for (const claim of protocolClaims) {\n        if (!InternalRequiredProtocolClaims.includes(claim)) {\n          delete result[claim];\n        }\n      }\n    }\n    return result;\n  }\n  mergeClaims(claims1, claims2) {\n    const result = {\n      ...claims1\n    };\n    for (const [claim, values] of Object.entries(claims2)) {\n      if (result[claim] !== values) {\n        if (Array.isArray(result[claim]) || Array.isArray(values)) {\n          if (this._settings.mergeClaimsStrategy.array == \"replace\") {\n            result[claim] = values;\n          } else {\n            const mergedValues = Array.isArray(result[claim]) ? result[claim] : [result[claim]];\n            for (const value of Array.isArray(values) ? values : [values]) {\n              if (!mergedValues.includes(value)) {\n                mergedValues.push(value);\n              }\n            }\n            result[claim] = mergedValues;\n          }\n        } else if (typeof result[claim] === \"object\" && typeof values === \"object\") {\n          result[claim] = this.mergeClaims(result[claim], values);\n        } else {\n          result[claim] = values;\n        }\n      }\n    }\n    return result;\n  }\n};\n\n// src/DPoPStore.ts\nvar DPoPState = class {\n  constructor(keys, nonce) {\n    this.keys = keys;\n    this.nonce = nonce;\n  }\n};\n\n// src/OidcClient.ts\nvar OidcClient = class {\n  constructor(settings, metadataService) {\n    this._logger = new Logger(\"OidcClient\");\n    this.settings = settings instanceof OidcClientSettingsStore ? settings : new OidcClientSettingsStore(settings);\n    this.metadataService = metadataService != null ? metadataService : new MetadataService(this.settings);\n    this._claimsService = new ClaimsService(this.settings);\n    this._validator = new ResponseValidator(this.settings, this.metadataService, this._claimsService);\n    this._tokenClient = new TokenClient(this.settings, this.metadataService);\n  }\n  async createSigninRequest({\n    state,\n    request,\n    request_uri,\n    request_type,\n    id_token_hint,\n    login_hint,\n    skipUserInfo,\n    nonce,\n    url_state,\n    response_type = this.settings.response_type,\n    scope = this.settings.scope,\n    redirect_uri = this.settings.redirect_uri,\n    prompt = this.settings.prompt,\n    display = this.settings.display,\n    max_age = this.settings.max_age,\n    ui_locales = this.settings.ui_locales,\n    acr_values = this.settings.acr_values,\n    resource = this.settings.resource,\n    response_mode = this.settings.response_mode,\n    extraQueryParams = this.settings.extraQueryParams,\n    extraTokenParams = this.settings.extraTokenParams,\n    dpopJkt,\n    omitScopeWhenRequesting = this.settings.omitScopeWhenRequesting\n  }) {\n    const logger2 = this._logger.create(\"createSigninRequest\");\n    if (response_type !== \"code\") {\n      throw new Error(\"Only the Authorization Code flow (with PKCE) is supported\");\n    }\n    const url = await this.metadataService.getAuthorizationEndpoint();\n    logger2.debug(\"Received authorization endpoint\", url);\n    const signinRequest = await SigninRequest.create({\n      url,\n      authority: this.settings.authority,\n      client_id: this.settings.client_id,\n      redirect_uri,\n      response_type,\n      scope,\n      state_data: state,\n      url_state,\n      prompt,\n      display,\n      max_age,\n      ui_locales,\n      id_token_hint,\n      login_hint,\n      acr_values,\n      dpopJkt,\n      resource,\n      request,\n      request_uri,\n      extraQueryParams,\n      extraTokenParams,\n      request_type,\n      response_mode,\n      client_secret: this.settings.client_secret,\n      skipUserInfo,\n      nonce,\n      disablePKCE: this.settings.disablePKCE,\n      omitScopeWhenRequesting\n    });\n    await this.clearStaleState();\n    const signinState = signinRequest.state;\n    await this.settings.stateStore.set(signinState.id, signinState.toStorageString());\n    return signinRequest;\n  }\n  async readSigninResponseState(url, removeState = false) {\n    const logger2 = this._logger.create(\"readSigninResponseState\");\n    const response = new SigninResponse(UrlUtils.readParams(url, this.settings.response_mode));\n    if (!response.state) {\n      logger2.throw(new Error(\"No state in response\"));\n      throw null;\n    }\n    const storedStateString = await this.settings.stateStore[removeState ? \"remove\" : \"get\"](response.state);\n    if (!storedStateString) {\n      logger2.throw(new Error(\"No matching state found in storage\"));\n      throw null;\n    }\n    const state = await SigninState.fromStorageString(storedStateString);\n    return {\n      state,\n      response\n    };\n  }\n  async processSigninResponse(url, extraHeaders, removeState = true) {\n    const logger2 = this._logger.create(\"processSigninResponse\");\n    const {\n      state,\n      response\n    } = await this.readSigninResponseState(url, removeState);\n    logger2.debug(\"received state from storage; validating response\");\n    if (this.settings.dpop && this.settings.dpop.store) {\n      const dpopProof = await this.getDpopProof(this.settings.dpop.store);\n      extraHeaders = {\n        ...extraHeaders,\n        \"DPoP\": dpopProof\n      };\n    }\n    try {\n      await this._validator.validateSigninResponse(response, state, extraHeaders);\n    } catch (err) {\n      if (err instanceof ErrorDPoPNonce && this.settings.dpop) {\n        const dpopProof = await this.getDpopProof(this.settings.dpop.store, err.nonce);\n        extraHeaders[\"DPoP\"] = dpopProof;\n        await this._validator.validateSigninResponse(response, state, extraHeaders);\n      } else {\n        throw err;\n      }\n    }\n    return response;\n  }\n  async getDpopProof(dpopStore, nonce) {\n    let keyPair;\n    let dpopState;\n    if (!(await dpopStore.getAllKeys()).includes(this.settings.client_id)) {\n      keyPair = await CryptoUtils.generateDPoPKeys();\n      dpopState = new DPoPState(keyPair, nonce);\n      await dpopStore.set(this.settings.client_id, dpopState);\n    } else {\n      dpopState = await dpopStore.get(this.settings.client_id);\n      if (dpopState.nonce !== nonce && nonce) {\n        dpopState.nonce = nonce;\n        await dpopStore.set(this.settings.client_id, dpopState);\n      }\n    }\n    return await CryptoUtils.generateDPoPProof({\n      url: await this.metadataService.getTokenEndpoint(false),\n      httpMethod: \"POST\",\n      keyPair: dpopState.keys,\n      nonce: dpopState.nonce\n    });\n  }\n  async processResourceOwnerPasswordCredentials({\n    username,\n    password,\n    skipUserInfo = false,\n    extraTokenParams = {}\n  }) {\n    const tokenResponse = await this._tokenClient.exchangeCredentials({\n      username,\n      password,\n      ...extraTokenParams\n    });\n    const signinResponse = new SigninResponse(new URLSearchParams());\n    Object.assign(signinResponse, tokenResponse);\n    await this._validator.validateCredentialsResponse(signinResponse, skipUserInfo);\n    return signinResponse;\n  }\n  async useRefreshToken({\n    state,\n    redirect_uri,\n    resource,\n    timeoutInSeconds,\n    extraHeaders,\n    extraTokenParams\n  }) {\n    var _a;\n    const logger2 = this._logger.create(\"useRefreshToken\");\n    let scope;\n    if (this.settings.refreshTokenAllowedScope === void 0) {\n      scope = state.scope;\n    } else {\n      const allowableScopes = this.settings.refreshTokenAllowedScope.split(\" \");\n      const providedScopes = ((_a = state.scope) == null ? void 0 : _a.split(\" \")) || [];\n      scope = providedScopes.filter(s => allowableScopes.includes(s)).join(\" \");\n    }\n    if (this.settings.dpop && this.settings.dpop.store) {\n      const dpopProof = await this.getDpopProof(this.settings.dpop.store);\n      extraHeaders = {\n        ...extraHeaders,\n        \"DPoP\": dpopProof\n      };\n    }\n    let result;\n    try {\n      result = await this._tokenClient.exchangeRefreshToken({\n        refresh_token: state.refresh_token,\n        // provide the (possible filtered) scope list\n        scope,\n        redirect_uri,\n        resource,\n        timeoutInSeconds,\n        extraHeaders,\n        ...extraTokenParams\n      });\n    } catch (err) {\n      if (err instanceof ErrorDPoPNonce && this.settings.dpop) {\n        extraHeaders[\"DPoP\"] = await this.getDpopProof(this.settings.dpop.store, err.nonce);\n        result = await this._tokenClient.exchangeRefreshToken({\n          refresh_token: state.refresh_token,\n          // provide the (possible filtered) scope list\n          scope,\n          redirect_uri,\n          resource,\n          timeoutInSeconds,\n          extraHeaders,\n          ...extraTokenParams\n        });\n      } else {\n        throw err;\n      }\n    }\n    const response = new SigninResponse(new URLSearchParams());\n    Object.assign(response, result);\n    logger2.debug(\"validating response\", response);\n    await this._validator.validateRefreshResponse(response, {\n      ...state,\n      // override the scope in the state handed over to the validator\n      // so it can set the granted scope to the requested scope in case none is included in the response\n      scope\n    });\n    return response;\n  }\n  async createSignoutRequest({\n    state,\n    id_token_hint,\n    client_id,\n    request_type,\n    url_state,\n    post_logout_redirect_uri = this.settings.post_logout_redirect_uri,\n    extraQueryParams = this.settings.extraQueryParams\n  } = {}) {\n    const logger2 = this._logger.create(\"createSignoutRequest\");\n    const url = await this.metadataService.getEndSessionEndpoint();\n    if (!url) {\n      logger2.throw(new Error(\"No end session endpoint\"));\n      throw null;\n    }\n    logger2.debug(\"Received end session endpoint\", url);\n    if (!client_id && post_logout_redirect_uri && !id_token_hint) {\n      client_id = this.settings.client_id;\n    }\n    const request = new SignoutRequest({\n      url,\n      id_token_hint,\n      client_id,\n      post_logout_redirect_uri,\n      state_data: state,\n      extraQueryParams,\n      request_type,\n      url_state\n    });\n    await this.clearStaleState();\n    const signoutState = request.state;\n    if (signoutState) {\n      logger2.debug(\"Signout request has state to persist\");\n      await this.settings.stateStore.set(signoutState.id, signoutState.toStorageString());\n    }\n    return request;\n  }\n  async readSignoutResponseState(url, removeState = false) {\n    const logger2 = this._logger.create(\"readSignoutResponseState\");\n    const response = new SignoutResponse(UrlUtils.readParams(url, this.settings.response_mode));\n    if (!response.state) {\n      logger2.debug(\"No state in response\");\n      if (response.error) {\n        logger2.warn(\"Response was error:\", response.error);\n        throw new ErrorResponse(response);\n      }\n      return {\n        state: void 0,\n        response\n      };\n    }\n    const storedStateString = await this.settings.stateStore[removeState ? \"remove\" : \"get\"](response.state);\n    if (!storedStateString) {\n      logger2.throw(new Error(\"No matching state found in storage\"));\n      throw null;\n    }\n    const state = await State.fromStorageString(storedStateString);\n    return {\n      state,\n      response\n    };\n  }\n  async processSignoutResponse(url) {\n    const logger2 = this._logger.create(\"processSignoutResponse\");\n    const {\n      state,\n      response\n    } = await this.readSignoutResponseState(url, true);\n    if (state) {\n      logger2.debug(\"Received state from storage; validating response\");\n      this._validator.validateSignoutResponse(response, state);\n    } else {\n      logger2.debug(\"No state from storage; skipping response validation\");\n    }\n    return response;\n  }\n  clearStaleState() {\n    this._logger.create(\"clearStaleState\");\n    return State.clearStaleState(this.settings.stateStore, this.settings.staleStateAgeInSeconds);\n  }\n  async revokeToken(token, type) {\n    this._logger.create(\"revokeToken\");\n    return await this._tokenClient.revoke({\n      token,\n      token_type_hint: type\n    });\n  }\n};\n\n// src/SessionMonitor.ts\nvar SessionMonitor = class {\n  constructor(_userManager) {\n    this._userManager = _userManager;\n    this._logger = new Logger(\"SessionMonitor\");\n    this._start = async user => {\n      const session_state = user.session_state;\n      if (!session_state) {\n        return;\n      }\n      const logger2 = this._logger.create(\"_start\");\n      if (user.profile) {\n        this._sub = user.profile.sub;\n        logger2.debug(\"session_state\", session_state, \", sub\", this._sub);\n      } else {\n        this._sub = void 0;\n        logger2.debug(\"session_state\", session_state, \", anonymous user\");\n      }\n      if (this._checkSessionIFrame) {\n        this._checkSessionIFrame.start(session_state);\n        return;\n      }\n      try {\n        const url = await this._userManager.metadataService.getCheckSessionIframe();\n        if (url) {\n          logger2.debug(\"initializing check session iframe\");\n          const client_id = this._userManager.settings.client_id;\n          const intervalInSeconds = this._userManager.settings.checkSessionIntervalInSeconds;\n          const stopOnError = this._userManager.settings.stopCheckSessionOnError;\n          const checkSessionIFrame = new CheckSessionIFrame(this._callback, client_id, url, intervalInSeconds, stopOnError);\n          await checkSessionIFrame.load();\n          this._checkSessionIFrame = checkSessionIFrame;\n          checkSessionIFrame.start(session_state);\n        } else {\n          logger2.warn(\"no check session iframe found in the metadata\");\n        }\n      } catch (err) {\n        logger2.error(\"Error from getCheckSessionIframe:\", err instanceof Error ? err.message : err);\n      }\n    };\n    this._stop = () => {\n      const logger2 = this._logger.create(\"_stop\");\n      this._sub = void 0;\n      if (this._checkSessionIFrame) {\n        this._checkSessionIFrame.stop();\n      }\n      if (this._userManager.settings.monitorAnonymousSession) {\n        const timerHandle = setInterval(async () => {\n          clearInterval(timerHandle);\n          try {\n            const session = await this._userManager.querySessionStatus();\n            if (session) {\n              const tmpUser = {\n                session_state: session.session_state,\n                profile: session.sub ? {\n                  sub: session.sub\n                } : null\n              };\n              void this._start(tmpUser);\n            }\n          } catch (err) {\n            logger2.error(\"error from querySessionStatus\", err instanceof Error ? err.message : err);\n          }\n        }, 1e3);\n      }\n    };\n    this._callback = async () => {\n      const logger2 = this._logger.create(\"_callback\");\n      try {\n        const session = await this._userManager.querySessionStatus();\n        let raiseEvent = true;\n        if (session && this._checkSessionIFrame) {\n          if (session.sub === this._sub) {\n            raiseEvent = false;\n            this._checkSessionIFrame.start(session.session_state);\n            logger2.debug(\"same sub still logged in at OP, session state has changed, restarting check session iframe; session_state\", session.session_state);\n            await this._userManager.events._raiseUserSessionChanged();\n          } else {\n            logger2.debug(\"different subject signed into OP\", session.sub);\n          }\n        } else {\n          logger2.debug(\"subject no longer signed into OP\");\n        }\n        if (raiseEvent) {\n          if (this._sub) {\n            await this._userManager.events._raiseUserSignedOut();\n          } else {\n            await this._userManager.events._raiseUserSignedIn();\n          }\n        } else {\n          logger2.debug(\"no change in session detected, no event to raise\");\n        }\n      } catch (err) {\n        if (this._sub) {\n          logger2.debug(\"Error calling queryCurrentSigninSession; raising signed out event\", err);\n          await this._userManager.events._raiseUserSignedOut();\n        }\n      }\n    };\n    if (!_userManager) {\n      this._logger.throw(new Error(\"No user manager passed\"));\n    }\n    this._userManager.events.addUserLoaded(this._start);\n    this._userManager.events.addUserUnloaded(this._stop);\n    this._init().catch(err => {\n      this._logger.error(err);\n    });\n  }\n  async _init() {\n    this._logger.create(\"_init\");\n    const user = await this._userManager.getUser();\n    if (user) {\n      void this._start(user);\n    } else if (this._userManager.settings.monitorAnonymousSession) {\n      const session = await this._userManager.querySessionStatus();\n      if (session) {\n        const tmpUser = {\n          session_state: session.session_state,\n          profile: session.sub ? {\n            sub: session.sub\n          } : null\n        };\n        void this._start(tmpUser);\n      }\n    }\n  }\n};\n\n// src/User.ts\nvar User = class _User {\n  constructor(args) {\n    var _a;\n    this.id_token = args.id_token;\n    this.session_state = (_a = args.session_state) != null ? _a : null;\n    this.access_token = args.access_token;\n    this.refresh_token = args.refresh_token;\n    this.token_type = args.token_type;\n    this.scope = args.scope;\n    this.profile = args.profile;\n    this.expires_at = args.expires_at;\n    this.state = args.userState;\n    this.url_state = args.url_state;\n  }\n  /** Computed number of seconds the access token has remaining. */\n  get expires_in() {\n    if (this.expires_at === void 0) {\n      return void 0;\n    }\n    return this.expires_at - Timer.getEpochTime();\n  }\n  set expires_in(value) {\n    if (value !== void 0) {\n      this.expires_at = Math.floor(value) + Timer.getEpochTime();\n    }\n  }\n  /** Computed value indicating if the access token is expired. */\n  get expired() {\n    const expires_in = this.expires_in;\n    if (expires_in === void 0) {\n      return void 0;\n    }\n    return expires_in <= 0;\n  }\n  /** Array representing the parsed values from the `scope`. */\n  get scopes() {\n    var _a, _b;\n    return (_b = (_a = this.scope) == null ? void 0 : _a.split(\" \")) != null ? _b : [];\n  }\n  toStorageString() {\n    new Logger(\"User\").create(\"toStorageString\");\n    return JSON.stringify({\n      id_token: this.id_token,\n      session_state: this.session_state,\n      access_token: this.access_token,\n      refresh_token: this.refresh_token,\n      token_type: this.token_type,\n      scope: this.scope,\n      profile: this.profile,\n      expires_at: this.expires_at\n    });\n  }\n  static fromStorageString(storageString) {\n    Logger.createStatic(\"User\", \"fromStorageString\");\n    return new _User(JSON.parse(storageString));\n  }\n};\n\n// src/navigators/AbstractChildWindow.ts\nvar messageSource = \"oidc-client\";\nvar AbstractChildWindow = class {\n  constructor() {\n    this._abort = new Event(\"Window navigation aborted\");\n    this._disposeHandlers = /* @__PURE__ */new Set();\n    this._window = null;\n  }\n  async navigate(params) {\n    const logger2 = this._logger.create(\"navigate\");\n    if (!this._window) {\n      throw new Error(\"Attempted to navigate on a disposed window\");\n    }\n    logger2.debug(\"setting URL in window\");\n    this._window.location.replace(params.url);\n    const {\n      url,\n      keepOpen\n    } = await new Promise((resolve, reject) => {\n      const listener = e => {\n        var _a;\n        const data = e.data;\n        const origin = (_a = params.scriptOrigin) != null ? _a : window.location.origin;\n        if (e.origin !== origin || (data == null ? void 0 : data.source) !== messageSource) {\n          return;\n        }\n        try {\n          const state = UrlUtils.readParams(data.url, params.response_mode).get(\"state\");\n          if (!state) {\n            logger2.warn(\"no state found in response url\");\n          }\n          if (e.source !== this._window && state !== params.state) {\n            return;\n          }\n        } catch {\n          this._dispose();\n          reject(new Error(\"Invalid response from window\"));\n        }\n        resolve(data);\n      };\n      window.addEventListener(\"message\", listener, false);\n      this._disposeHandlers.add(() => window.removeEventListener(\"message\", listener, false));\n      const channel = new BroadcastChannel(`oidc-client-popup-${params.state}`);\n      channel.addEventListener(\"message\", listener, false);\n      this._disposeHandlers.add(() => channel.close());\n      this._disposeHandlers.add(this._abort.addHandler(reason => {\n        this._dispose();\n        reject(reason);\n      }));\n    });\n    logger2.debug(\"got response from window\");\n    this._dispose();\n    if (!keepOpen) {\n      this.close();\n    }\n    return {\n      url\n    };\n  }\n  _dispose() {\n    this._logger.create(\"_dispose\");\n    for (const dispose of this._disposeHandlers) {\n      dispose();\n    }\n    this._disposeHandlers.clear();\n  }\n  static _notifyParent(parent, url, keepOpen = false, targetOrigin = window.location.origin) {\n    const msgData = {\n      source: messageSource,\n      url,\n      keepOpen\n    };\n    const logger2 = new Logger(\"_notifyParent\");\n    if (parent) {\n      logger2.debug(\"With parent. Using parent.postMessage.\");\n      parent.postMessage(msgData, targetOrigin);\n    } else {\n      logger2.debug(\"No parent. Using BroadcastChannel.\");\n      const state = new URL(url).searchParams.get(\"state\");\n      if (!state) {\n        throw new Error(\"No parent and no state in URL. Can't complete notification.\");\n      }\n      const channel = new BroadcastChannel(`oidc-client-popup-${state}`);\n      channel.postMessage(msgData);\n      channel.close();\n    }\n  }\n};\n\n// src/UserManagerSettings.ts\nvar DefaultPopupWindowFeatures = {\n  location: false,\n  toolbar: false,\n  height: 640,\n  closePopupWindowAfterInSeconds: -1\n};\nvar DefaultPopupTarget = \"_blank\";\nvar DefaultAccessTokenExpiringNotificationTimeInSeconds = 60;\nvar DefaultCheckSessionIntervalInSeconds = 2;\nvar DefaultSilentRequestTimeoutInSeconds = 10;\nvar UserManagerSettingsStore = class extends OidcClientSettingsStore {\n  constructor(args) {\n    const {\n      popup_redirect_uri = args.redirect_uri,\n      popup_post_logout_redirect_uri = args.post_logout_redirect_uri,\n      popupWindowFeatures = DefaultPopupWindowFeatures,\n      popupWindowTarget = DefaultPopupTarget,\n      redirectMethod = \"assign\",\n      redirectTarget = \"self\",\n      iframeNotifyParentOrigin = args.iframeNotifyParentOrigin,\n      iframeScriptOrigin = args.iframeScriptOrigin,\n      requestTimeoutInSeconds,\n      silent_redirect_uri = args.redirect_uri,\n      silentRequestTimeoutInSeconds,\n      automaticSilentRenew = true,\n      validateSubOnSilentRenew = true,\n      includeIdTokenInSilentRenew = false,\n      monitorSession = false,\n      monitorAnonymousSession = false,\n      checkSessionIntervalInSeconds = DefaultCheckSessionIntervalInSeconds,\n      query_status_response_type = \"code\",\n      stopCheckSessionOnError = true,\n      revokeTokenTypes = [\"access_token\", \"refresh_token\"],\n      revokeTokensOnSignout = false,\n      includeIdTokenInSilentSignout = false,\n      accessTokenExpiringNotificationTimeInSeconds = DefaultAccessTokenExpiringNotificationTimeInSeconds,\n      userStore\n    } = args;\n    super(args);\n    this.popup_redirect_uri = popup_redirect_uri;\n    this.popup_post_logout_redirect_uri = popup_post_logout_redirect_uri;\n    this.popupWindowFeatures = popupWindowFeatures;\n    this.popupWindowTarget = popupWindowTarget;\n    this.redirectMethod = redirectMethod;\n    this.redirectTarget = redirectTarget;\n    this.iframeNotifyParentOrigin = iframeNotifyParentOrigin;\n    this.iframeScriptOrigin = iframeScriptOrigin;\n    this.silent_redirect_uri = silent_redirect_uri;\n    this.silentRequestTimeoutInSeconds = silentRequestTimeoutInSeconds || requestTimeoutInSeconds || DefaultSilentRequestTimeoutInSeconds;\n    this.automaticSilentRenew = automaticSilentRenew;\n    this.validateSubOnSilentRenew = validateSubOnSilentRenew;\n    this.includeIdTokenInSilentRenew = includeIdTokenInSilentRenew;\n    this.monitorSession = monitorSession;\n    this.monitorAnonymousSession = monitorAnonymousSession;\n    this.checkSessionIntervalInSeconds = checkSessionIntervalInSeconds;\n    this.stopCheckSessionOnError = stopCheckSessionOnError;\n    this.query_status_response_type = query_status_response_type;\n    this.revokeTokenTypes = revokeTokenTypes;\n    this.revokeTokensOnSignout = revokeTokensOnSignout;\n    this.includeIdTokenInSilentSignout = includeIdTokenInSilentSignout;\n    this.accessTokenExpiringNotificationTimeInSeconds = accessTokenExpiringNotificationTimeInSeconds;\n    if (userStore) {\n      this.userStore = userStore;\n    } else {\n      const store = typeof window !== \"undefined\" ? window.sessionStorage : new InMemoryWebStorage();\n      this.userStore = new WebStorageStateStore({\n        store\n      });\n    }\n  }\n};\n\n// src/navigators/IFrameWindow.ts\nvar IFrameWindow = class _IFrameWindow extends AbstractChildWindow {\n  constructor({\n    silentRequestTimeoutInSeconds = DefaultSilentRequestTimeoutInSeconds\n  }) {\n    super();\n    this._logger = new Logger(\"IFrameWindow\");\n    this._timeoutInSeconds = silentRequestTimeoutInSeconds;\n    this._frame = _IFrameWindow.createHiddenIframe();\n    this._window = this._frame.contentWindow;\n  }\n  static createHiddenIframe() {\n    const iframe = window.document.createElement(\"iframe\");\n    iframe.style.visibility = \"hidden\";\n    iframe.style.position = \"fixed\";\n    iframe.style.left = \"-1000px\";\n    iframe.style.top = \"0\";\n    iframe.width = \"0\";\n    iframe.height = \"0\";\n    window.document.body.appendChild(iframe);\n    return iframe;\n  }\n  async navigate(params) {\n    this._logger.debug(\"navigate: Using timeout of:\", this._timeoutInSeconds);\n    const timer = setTimeout(() => void this._abort.raise(new ErrorTimeout(\"IFrame timed out without a response\")), this._timeoutInSeconds * 1e3);\n    this._disposeHandlers.add(() => clearTimeout(timer));\n    return await super.navigate(params);\n  }\n  close() {\n    var _a;\n    if (this._frame) {\n      if (this._frame.parentNode) {\n        this._frame.addEventListener(\"load\", ev => {\n          var _a2;\n          const frame = ev.target;\n          (_a2 = frame.parentNode) == null ? void 0 : _a2.removeChild(frame);\n          void this._abort.raise(new Error(\"IFrame removed from DOM\"));\n        }, true);\n        (_a = this._frame.contentWindow) == null ? void 0 : _a.location.replace(\"about:blank\");\n      }\n      this._frame = null;\n    }\n    this._window = null;\n  }\n  static notifyParent(url, targetOrigin) {\n    return super._notifyParent(window.parent, url, false, targetOrigin);\n  }\n};\n\n// src/navigators/IFrameNavigator.ts\nvar IFrameNavigator = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"IFrameNavigator\");\n  }\n  async prepare({\n    silentRequestTimeoutInSeconds = this._settings.silentRequestTimeoutInSeconds\n  }) {\n    return new IFrameWindow({\n      silentRequestTimeoutInSeconds\n    });\n  }\n  async callback(url) {\n    this._logger.create(\"callback\");\n    IFrameWindow.notifyParent(url, this._settings.iframeNotifyParentOrigin);\n  }\n};\n\n// src/navigators/PopupWindow.ts\nvar checkForPopupClosedInterval = 500;\nvar second = 1e3;\nvar PopupWindow = class extends AbstractChildWindow {\n  constructor({\n    popupWindowTarget = DefaultPopupTarget,\n    popupWindowFeatures = {},\n    popupSignal\n  }) {\n    super();\n    this._logger = new Logger(\"PopupWindow\");\n    const centeredPopup = PopupUtils.center({\n      ...DefaultPopupWindowFeatures,\n      ...popupWindowFeatures\n    });\n    this._window = window.open(void 0, popupWindowTarget, PopupUtils.serialize(centeredPopup));\n    if (popupSignal) {\n      popupSignal.addEventListener(\"abort\", () => {\n        var _a;\n        void this._abort.raise(new Error((_a = popupSignal.reason) != null ? _a : \"Popup aborted\"));\n      });\n    }\n    if (popupWindowFeatures.closePopupWindowAfterInSeconds && popupWindowFeatures.closePopupWindowAfterInSeconds > 0) {\n      setTimeout(() => {\n        if (!this._window || typeof this._window.closed !== \"boolean\" || this._window.closed) {\n          void this._abort.raise(new Error(\"Popup blocked by user\"));\n          return;\n        }\n        this.close();\n      }, popupWindowFeatures.closePopupWindowAfterInSeconds * second);\n    }\n  }\n  async navigate(params) {\n    var _a;\n    (_a = this._window) == null ? void 0 : _a.focus();\n    const popupClosedInterval = setInterval(() => {\n      if (!this._window || this._window.closed) {\n        this._logger.debug(\"Popup closed by user or isolated by redirect\");\n        clearPopupClosedInterval();\n        this._disposeHandlers.delete(clearPopupClosedInterval);\n      }\n    }, checkForPopupClosedInterval);\n    const clearPopupClosedInterval = () => clearInterval(popupClosedInterval);\n    this._disposeHandlers.add(clearPopupClosedInterval);\n    return await super.navigate(params);\n  }\n  close() {\n    if (this._window) {\n      if (!this._window.closed) {\n        this._window.close();\n        void this._abort.raise(new Error(\"Popup closed\"));\n      }\n    }\n    this._window = null;\n  }\n  static notifyOpener(url, keepOpen) {\n    super._notifyParent(window.opener, url, keepOpen);\n    if (!keepOpen && !window.opener) {\n      window.close();\n    }\n  }\n};\n\n// src/navigators/PopupNavigator.ts\nvar PopupNavigator = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"PopupNavigator\");\n  }\n  async prepare({\n    popupWindowFeatures = this._settings.popupWindowFeatures,\n    popupWindowTarget = this._settings.popupWindowTarget,\n    popupSignal\n  }) {\n    return new PopupWindow({\n      popupWindowFeatures,\n      popupWindowTarget,\n      popupSignal\n    });\n  }\n  async callback(url, {\n    keepOpen = false\n  }) {\n    this._logger.create(\"callback\");\n    PopupWindow.notifyOpener(url, keepOpen);\n  }\n};\n\n// src/navigators/RedirectNavigator.ts\nvar RedirectNavigator = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"RedirectNavigator\");\n  }\n  async prepare({\n    redirectMethod = this._settings.redirectMethod,\n    redirectTarget = this._settings.redirectTarget\n  }) {\n    var _a;\n    this._logger.create(\"prepare\");\n    let targetWindow = window.self;\n    if (redirectTarget === \"top\") {\n      targetWindow = (_a = window.top) != null ? _a : window.self;\n    }\n    const redirect = targetWindow.location[redirectMethod].bind(targetWindow.location);\n    let abort;\n    return {\n      navigate: async params => {\n        this._logger.create(\"navigate\");\n        const promise = new Promise((resolve, reject) => {\n          abort = reject;\n        });\n        redirect(params.url);\n        return await promise;\n      },\n      close: () => {\n        this._logger.create(\"close\");\n        abort == null ? void 0 : abort(new Error(\"Redirect aborted\"));\n        targetWindow.stop();\n      }\n    };\n  }\n  async callback() {\n    return;\n  }\n};\n\n// src/UserManagerEvents.ts\nvar UserManagerEvents = class extends AccessTokenEvents {\n  constructor(settings) {\n    super({\n      expiringNotificationTimeInSeconds: settings.accessTokenExpiringNotificationTimeInSeconds\n    });\n    this._logger = new Logger(\"UserManagerEvents\");\n    this._userLoaded = new Event(\"User loaded\");\n    this._userUnloaded = new Event(\"User unloaded\");\n    this._silentRenewError = new Event(\"Silent renew error\");\n    this._userSignedIn = new Event(\"User signed in\");\n    this._userSignedOut = new Event(\"User signed out\");\n    this._userSessionChanged = new Event(\"User session changed\");\n  }\n  async load(user, raiseEvent = true) {\n    await super.load(user);\n    if (raiseEvent) {\n      await this._userLoaded.raise(user);\n    }\n  }\n  async unload() {\n    await super.unload();\n    await this._userUnloaded.raise();\n  }\n  /**\n   * Add callback: Raised when a user session has been established (or re-established).\n   */\n  addUserLoaded(cb) {\n    return this._userLoaded.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when a user session has been established (or re-established).\n   */\n  removeUserLoaded(cb) {\n    return this._userLoaded.removeHandler(cb);\n  }\n  /**\n   * Add callback: Raised when a user session has been terminated.\n   */\n  addUserUnloaded(cb) {\n    return this._userUnloaded.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when a user session has been terminated.\n   */\n  removeUserUnloaded(cb) {\n    return this._userUnloaded.removeHandler(cb);\n  }\n  /**\n   * Add callback: Raised when the automatic silent renew has failed.\n   */\n  addSilentRenewError(cb) {\n    return this._silentRenewError.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when the automatic silent renew has failed.\n   */\n  removeSilentRenewError(cb) {\n    return this._silentRenewError.removeHandler(cb);\n  }\n  /**\n   * @internal\n   */\n  async _raiseSilentRenewError(e) {\n    await this._silentRenewError.raise(e);\n  }\n  /**\n   * Add callback: Raised when the user is signed in (when `monitorSession` is set).\n   * @see {@link UserManagerSettings.monitorSession}\n   */\n  addUserSignedIn(cb) {\n    return this._userSignedIn.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when the user is signed in (when `monitorSession` is set).\n   */\n  removeUserSignedIn(cb) {\n    this._userSignedIn.removeHandler(cb);\n  }\n  /**\n   * @internal\n   */\n  async _raiseUserSignedIn() {\n    await this._userSignedIn.raise();\n  }\n  /**\n   * Add callback: Raised when the user's sign-in status at the OP has changed (when `monitorSession` is set).\n   * @see {@link UserManagerSettings.monitorSession}\n   */\n  addUserSignedOut(cb) {\n    return this._userSignedOut.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when the user's sign-in status at the OP has changed (when `monitorSession` is set).\n   */\n  removeUserSignedOut(cb) {\n    this._userSignedOut.removeHandler(cb);\n  }\n  /**\n   * @internal\n   */\n  async _raiseUserSignedOut() {\n    await this._userSignedOut.raise();\n  }\n  /**\n   * Add callback: Raised when the user session changed (when `monitorSession` is set).\n   * @see {@link UserManagerSettings.monitorSession}\n   */\n  addUserSessionChanged(cb) {\n    return this._userSessionChanged.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when the user session changed (when `monitorSession` is set).\n   */\n  removeUserSessionChanged(cb) {\n    this._userSessionChanged.removeHandler(cb);\n  }\n  /**\n   * @internal\n   */\n  async _raiseUserSessionChanged() {\n    await this._userSessionChanged.raise();\n  }\n};\n\n// src/SilentRenewService.ts\nvar SilentRenewService = class {\n  constructor(_userManager) {\n    this._userManager = _userManager;\n    this._logger = new Logger(\"SilentRenewService\");\n    this._isStarted = false;\n    this._retryTimer = new Timer(\"Retry Silent Renew\");\n    this._tokenExpiring = async () => {\n      const logger2 = this._logger.create(\"_tokenExpiring\");\n      try {\n        await this._userManager.signinSilent();\n        logger2.debug(\"silent token renewal successful\");\n      } catch (err) {\n        if (err instanceof ErrorTimeout) {\n          logger2.warn(\"ErrorTimeout from signinSilent:\", err, \"retry in 5s\");\n          this._retryTimer.init(5);\n          return;\n        }\n        logger2.error(\"Error from signinSilent:\", err);\n        await this._userManager.events._raiseSilentRenewError(err);\n      }\n    };\n  }\n  async start() {\n    const logger2 = this._logger.create(\"start\");\n    if (!this._isStarted) {\n      this._isStarted = true;\n      this._userManager.events.addAccessTokenExpiring(this._tokenExpiring);\n      this._retryTimer.addHandler(this._tokenExpiring);\n      try {\n        await this._userManager.getUser();\n      } catch (err) {\n        logger2.error(\"getUser error\", err);\n      }\n    }\n  }\n  stop() {\n    if (this._isStarted) {\n      this._retryTimer.cancel();\n      this._retryTimer.removeHandler(this._tokenExpiring);\n      this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring);\n      this._isStarted = false;\n    }\n  }\n};\n\n// src/RefreshState.ts\nvar RefreshState = class {\n  constructor(args) {\n    this.refresh_token = args.refresh_token;\n    this.id_token = args.id_token;\n    this.session_state = args.session_state;\n    this.scope = args.scope;\n    this.profile = args.profile;\n    this.data = args.state;\n  }\n};\n\n// src/UserManager.ts\nvar UserManager = class {\n  constructor(settings, redirectNavigator, popupNavigator, iframeNavigator) {\n    this._logger = new Logger(\"UserManager\");\n    this.settings = new UserManagerSettingsStore(settings);\n    this._client = new OidcClient(settings);\n    this._redirectNavigator = redirectNavigator != null ? redirectNavigator : new RedirectNavigator(this.settings);\n    this._popupNavigator = popupNavigator != null ? popupNavigator : new PopupNavigator(this.settings);\n    this._iframeNavigator = iframeNavigator != null ? iframeNavigator : new IFrameNavigator(this.settings);\n    this._events = new UserManagerEvents(this.settings);\n    this._silentRenewService = new SilentRenewService(this);\n    if (this.settings.automaticSilentRenew) {\n      this.startSilentRenew();\n    }\n    this._sessionMonitor = null;\n    if (this.settings.monitorSession) {\n      this._sessionMonitor = new SessionMonitor(this);\n    }\n  }\n  /**\n   * Get object used to register for events raised by the `UserManager`.\n   */\n  get events() {\n    return this._events;\n  }\n  /**\n   * Get object used to access the metadata configuration of the identity provider.\n   */\n  get metadataService() {\n    return this._client.metadataService;\n  }\n  /**\n   * Load the `User` object for the currently authenticated user.\n   *\n   * @param raiseEvent - If `true`, the `UserLoaded` event will be raised. Defaults to false.\n   * @returns A promise\n   */\n  async getUser(raiseEvent = false) {\n    const logger2 = this._logger.create(\"getUser\");\n    const user = await this._loadUser();\n    if (user) {\n      logger2.info(\"user loaded\");\n      await this._events.load(user, raiseEvent);\n      return user;\n    }\n    logger2.info(\"user not found in storage\");\n    return null;\n  }\n  /**\n   * Remove from any storage the currently authenticated user.\n   *\n   * @returns A promise\n   */\n  async removeUser() {\n    const logger2 = this._logger.create(\"removeUser\");\n    await this.storeUser(null);\n    logger2.info(\"user removed from storage\");\n    await this._events.unload();\n  }\n  /**\n   * Trigger a redirect of the current window to the authorization endpoint.\n   *\n   * @returns A promise\n   *\n   * @throws `Error` In cases of wrong authentication.\n   */\n  async signinRedirect(args = {}) {\n    var _a;\n    this._logger.create(\"signinRedirect\");\n    const {\n      redirectMethod,\n      ...requestArgs\n    } = args;\n    let dpopJkt;\n    if ((_a = this.settings.dpop) == null ? void 0 : _a.bind_authorization_code) {\n      dpopJkt = await this.generateDPoPJkt(this.settings.dpop);\n    }\n    const handle = await this._redirectNavigator.prepare({\n      redirectMethod\n    });\n    await this._signinStart({\n      request_type: \"si:r\",\n      dpopJkt,\n      ...requestArgs\n    }, handle);\n  }\n  /**\n   * Process the response (callback) from the authorization endpoint.\n   * It is recommended to use {@link UserManager.signinCallback} instead.\n   *\n   * @returns A promise containing the authenticated `User`.\n   *\n   * @see {@link UserManager.signinCallback}\n   */\n  async signinRedirectCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signinRedirectCallback\");\n    const user = await this._signinEnd(url);\n    if (user.profile && user.profile.sub) {\n      logger2.info(\"success, signed in subject\", user.profile.sub);\n    } else {\n      logger2.info(\"no subject\");\n    }\n    return user;\n  }\n  /**\n   * Trigger the signin with user/password.\n   *\n   * @returns A promise containing the authenticated `User`.\n   * @throws {@link ErrorResponse} In cases of wrong authentication.\n   */\n  async signinResourceOwnerCredentials({\n    username,\n    password,\n    skipUserInfo = false\n  }) {\n    const logger2 = this._logger.create(\"signinResourceOwnerCredential\");\n    const signinResponse = await this._client.processResourceOwnerPasswordCredentials({\n      username,\n      password,\n      skipUserInfo,\n      extraTokenParams: this.settings.extraTokenParams\n    });\n    logger2.debug(\"got signin response\");\n    const user = await this._buildUser(signinResponse);\n    if (user.profile && user.profile.sub) {\n      logger2.info(\"success, signed in subject\", user.profile.sub);\n    } else {\n      logger2.info(\"no subject\");\n    }\n    return user;\n  }\n  /**\n   * Trigger a request (via a popup window) to the authorization endpoint.\n   *\n   * @returns A promise containing the authenticated `User`.\n   * @throws `Error` In cases of wrong authentication.\n   */\n  async signinPopup(args = {}) {\n    var _a;\n    const logger2 = this._logger.create(\"signinPopup\");\n    let dpopJkt;\n    if ((_a = this.settings.dpop) == null ? void 0 : _a.bind_authorization_code) {\n      dpopJkt = await this.generateDPoPJkt(this.settings.dpop);\n    }\n    const {\n      popupWindowFeatures,\n      popupWindowTarget,\n      popupSignal,\n      ...requestArgs\n    } = args;\n    const url = this.settings.popup_redirect_uri;\n    if (!url) {\n      logger2.throw(new Error(\"No popup_redirect_uri configured\"));\n    }\n    const handle = await this._popupNavigator.prepare({\n      popupWindowFeatures,\n      popupWindowTarget,\n      popupSignal\n    });\n    const user = await this._signin({\n      request_type: \"si:p\",\n      redirect_uri: url,\n      display: \"popup\",\n      dpopJkt,\n      ...requestArgs\n    }, handle);\n    if (user) {\n      if (user.profile && user.profile.sub) {\n        logger2.info(\"success, signed in subject\", user.profile.sub);\n      } else {\n        logger2.info(\"no subject\");\n      }\n    }\n    return user;\n  }\n  /**\n   * Notify the opening window of response (callback) from the authorization endpoint.\n   * It is recommended to use {@link UserManager.signinCallback} instead.\n   *\n   * @returns A promise\n   *\n   * @see {@link UserManager.signinCallback}\n   */\n  async signinPopupCallback(url = window.location.href, keepOpen = false) {\n    const logger2 = this._logger.create(\"signinPopupCallback\");\n    await this._popupNavigator.callback(url, {\n      keepOpen\n    });\n    logger2.info(\"success\");\n  }\n  /**\n   * Trigger a silent request (via refresh token or an iframe) to the authorization endpoint.\n   *\n   * @returns A promise that contains the authenticated `User`.\n   */\n  async signinSilent(args = {}) {\n    var _a, _b;\n    const logger2 = this._logger.create(\"signinSilent\");\n    const {\n      silentRequestTimeoutInSeconds,\n      ...requestArgs\n    } = args;\n    let user = await this._loadUser();\n    if (user == null ? void 0 : user.refresh_token) {\n      logger2.debug(\"using refresh token\");\n      const state = new RefreshState(user);\n      return await this._useRefreshToken({\n        state,\n        redirect_uri: requestArgs.redirect_uri,\n        resource: requestArgs.resource,\n        extraTokenParams: requestArgs.extraTokenParams,\n        timeoutInSeconds: silentRequestTimeoutInSeconds\n      });\n    }\n    let dpopJkt;\n    if ((_a = this.settings.dpop) == null ? void 0 : _a.bind_authorization_code) {\n      dpopJkt = await this.generateDPoPJkt(this.settings.dpop);\n    }\n    const url = this.settings.silent_redirect_uri;\n    if (!url) {\n      logger2.throw(new Error(\"No silent_redirect_uri configured\"));\n    }\n    let verifySub;\n    if (user && this.settings.validateSubOnSilentRenew) {\n      logger2.debug(\"subject prior to silent renew:\", user.profile.sub);\n      verifySub = user.profile.sub;\n    }\n    const handle = await this._iframeNavigator.prepare({\n      silentRequestTimeoutInSeconds\n    });\n    user = await this._signin({\n      request_type: \"si:s\",\n      redirect_uri: url,\n      prompt: \"none\",\n      id_token_hint: this.settings.includeIdTokenInSilentRenew ? user == null ? void 0 : user.id_token : void 0,\n      dpopJkt,\n      ...requestArgs\n    }, handle, verifySub);\n    if (user) {\n      if ((_b = user.profile) == null ? void 0 : _b.sub) {\n        logger2.info(\"success, signed in subject\", user.profile.sub);\n      } else {\n        logger2.info(\"no subject\");\n      }\n    }\n    return user;\n  }\n  async _useRefreshToken(args) {\n    const response = await this._client.useRefreshToken({\n      timeoutInSeconds: this.settings.silentRequestTimeoutInSeconds,\n      ...args\n    });\n    const user = new User({\n      ...args.state,\n      ...response\n    });\n    await this.storeUser(user);\n    await this._events.load(user);\n    return user;\n  }\n  /**\n   *\n   * Notify the parent window of response (callback) from the authorization endpoint.\n   * It is recommended to use {@link UserManager.signinCallback} instead.\n   *\n   * @returns A promise\n   *\n   * @see {@link UserManager.signinCallback}\n   */\n  async signinSilentCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signinSilentCallback\");\n    await this._iframeNavigator.callback(url);\n    logger2.info(\"success\");\n  }\n  /**\n   * Process any response (callback) from the authorization endpoint, by dispatching the request_type\n   * and executing one of the following functions:\n   * - {@link UserManager.signinRedirectCallback}\n   * - {@link UserManager.signinPopupCallback}\n   * - {@link UserManager.signinSilentCallback}\n   *\n   * @throws `Error` If request_type is unknown or signin cannot be processed.\n   */\n  async signinCallback(url = window.location.href) {\n    const {\n      state\n    } = await this._client.readSigninResponseState(url);\n    switch (state.request_type) {\n      case \"si:r\":\n        return await this.signinRedirectCallback(url);\n      case \"si:p\":\n        await this.signinPopupCallback(url);\n        break;\n      case \"si:s\":\n        await this.signinSilentCallback(url);\n        break;\n      default:\n        throw new Error(\"invalid response_type in state\");\n    }\n    return void 0;\n  }\n  /**\n   * Process any response (callback) from the end session endpoint, by dispatching the request_type\n   * and executing one of the following functions:\n   * - {@link UserManager.signoutRedirectCallback}\n   * - {@link UserManager.signoutPopupCallback}\n   * - {@link UserManager.signoutSilentCallback}\n   *\n   * @throws `Error` If request_type is unknown or signout cannot be processed.\n   */\n  async signoutCallback(url = window.location.href, keepOpen = false) {\n    const {\n      state\n    } = await this._client.readSignoutResponseState(url);\n    if (!state) {\n      return void 0;\n    }\n    switch (state.request_type) {\n      case \"so:r\":\n        return await this.signoutRedirectCallback(url);\n      case \"so:p\":\n        await this.signoutPopupCallback(url, keepOpen);\n        break;\n      case \"so:s\":\n        await this.signoutSilentCallback(url);\n        break;\n      default:\n        throw new Error(\"invalid response_type in state\");\n    }\n    return void 0;\n  }\n  /**\n   * Query OP for user's current signin status.\n   *\n   * @returns A promise object with session_state and subject identifier.\n   */\n  async querySessionStatus(args = {}) {\n    const logger2 = this._logger.create(\"querySessionStatus\");\n    const {\n      silentRequestTimeoutInSeconds,\n      ...requestArgs\n    } = args;\n    const url = this.settings.silent_redirect_uri;\n    if (!url) {\n      logger2.throw(new Error(\"No silent_redirect_uri configured\"));\n    }\n    const user = await this._loadUser();\n    const handle = await this._iframeNavigator.prepare({\n      silentRequestTimeoutInSeconds\n    });\n    const navResponse = await this._signinStart({\n      request_type: \"si:s\",\n      // this acts like a signin silent\n      redirect_uri: url,\n      prompt: \"none\",\n      id_token_hint: this.settings.includeIdTokenInSilentRenew ? user == null ? void 0 : user.id_token : void 0,\n      response_type: this.settings.query_status_response_type,\n      scope: \"openid\",\n      skipUserInfo: true,\n      ...requestArgs\n    }, handle);\n    try {\n      const extraHeaders = {};\n      const signinResponse = await this._client.processSigninResponse(navResponse.url, extraHeaders);\n      logger2.debug(\"got signin response\");\n      if (signinResponse.session_state && signinResponse.profile.sub) {\n        logger2.info(\"success for subject\", signinResponse.profile.sub);\n        return {\n          session_state: signinResponse.session_state,\n          sub: signinResponse.profile.sub\n        };\n      }\n      logger2.info(\"success, user not authenticated\");\n      return null;\n    } catch (err) {\n      if (this.settings.monitorAnonymousSession && err instanceof ErrorResponse) {\n        switch (err.error) {\n          case \"login_required\":\n          case \"consent_required\":\n          case \"interaction_required\":\n          case \"account_selection_required\":\n            logger2.info(\"success for anonymous user\");\n            return {\n              session_state: err.session_state\n            };\n        }\n      }\n      throw err;\n    }\n  }\n  async _signin(args, handle, verifySub) {\n    const navResponse = await this._signinStart(args, handle);\n    return await this._signinEnd(navResponse.url, verifySub);\n  }\n  async _signinStart(args, handle) {\n    const logger2 = this._logger.create(\"_signinStart\");\n    try {\n      const signinRequest = await this._client.createSigninRequest(args);\n      logger2.debug(\"got signin request\");\n      return await handle.navigate({\n        url: signinRequest.url,\n        state: signinRequest.state.id,\n        response_mode: signinRequest.state.response_mode,\n        scriptOrigin: this.settings.iframeScriptOrigin\n      });\n    } catch (err) {\n      logger2.debug(\"error after preparing navigator, closing navigator window\");\n      handle.close();\n      throw err;\n    }\n  }\n  async _signinEnd(url, verifySub) {\n    const logger2 = this._logger.create(\"_signinEnd\");\n    const extraHeaders = {};\n    const signinResponse = await this._client.processSigninResponse(url, extraHeaders);\n    logger2.debug(\"got signin response\");\n    const user = await this._buildUser(signinResponse, verifySub);\n    return user;\n  }\n  async _buildUser(signinResponse, verifySub) {\n    const logger2 = this._logger.create(\"_buildUser\");\n    const user = new User(signinResponse);\n    if (verifySub) {\n      if (verifySub !== user.profile.sub) {\n        logger2.debug(\"current user does not match user returned from signin. sub from signin:\", user.profile.sub);\n        throw new ErrorResponse({\n          ...signinResponse,\n          error: \"login_required\"\n        });\n      }\n      logger2.debug(\"current user matches user returned from signin\");\n    }\n    await this.storeUser(user);\n    logger2.debug(\"user stored\");\n    await this._events.load(user);\n    return user;\n  }\n  /**\n   * Trigger a redirect of the current window to the end session endpoint.\n   *\n   * @returns A promise\n   */\n  async signoutRedirect(args = {}) {\n    const logger2 = this._logger.create(\"signoutRedirect\");\n    const {\n      redirectMethod,\n      ...requestArgs\n    } = args;\n    const handle = await this._redirectNavigator.prepare({\n      redirectMethod\n    });\n    await this._signoutStart({\n      request_type: \"so:r\",\n      post_logout_redirect_uri: this.settings.post_logout_redirect_uri,\n      ...requestArgs\n    }, handle);\n    logger2.info(\"success\");\n  }\n  /**\n   * Process response (callback) from the end session endpoint.\n   * It is recommended to use {@link UserManager.signoutCallback} instead.\n   *\n   * @returns A promise containing signout response\n   *\n   * @see {@link UserManager.signoutCallback}\n   */\n  async signoutRedirectCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signoutRedirectCallback\");\n    const response = await this._signoutEnd(url);\n    logger2.info(\"success\");\n    return response;\n  }\n  /**\n   * Trigger a redirect of a popup window to the end session endpoint.\n   *\n   * @returns A promise\n   */\n  async signoutPopup(args = {}) {\n    const logger2 = this._logger.create(\"signoutPopup\");\n    const {\n      popupWindowFeatures,\n      popupWindowTarget,\n      popupSignal,\n      ...requestArgs\n    } = args;\n    const url = this.settings.popup_post_logout_redirect_uri;\n    const handle = await this._popupNavigator.prepare({\n      popupWindowFeatures,\n      popupWindowTarget,\n      popupSignal\n    });\n    await this._signout({\n      request_type: \"so:p\",\n      post_logout_redirect_uri: url,\n      // we're putting a dummy entry in here because we\n      // need a unique id from the state for notification\n      // to the parent window, which is necessary if we\n      // plan to return back to the client after signout\n      // and so we can close the popup after signout\n      state: url == null ? void 0 : {},\n      ...requestArgs\n    }, handle);\n    logger2.info(\"success\");\n  }\n  /**\n   * Process response (callback) from the end session endpoint from a popup window.\n   * It is recommended to use {@link UserManager.signoutCallback} instead.\n   *\n   * @returns A promise\n   *\n   * @see {@link UserManager.signoutCallback}\n   */\n  async signoutPopupCallback(url = window.location.href, keepOpen = false) {\n    const logger2 = this._logger.create(\"signoutPopupCallback\");\n    await this._popupNavigator.callback(url, {\n      keepOpen\n    });\n    logger2.info(\"success\");\n  }\n  async _signout(args, handle) {\n    const navResponse = await this._signoutStart(args, handle);\n    return await this._signoutEnd(navResponse.url);\n  }\n  async _signoutStart(args = {}, handle) {\n    var _a;\n    const logger2 = this._logger.create(\"_signoutStart\");\n    try {\n      const user = await this._loadUser();\n      logger2.debug(\"loaded current user from storage\");\n      if (this.settings.revokeTokensOnSignout) {\n        await this._revokeInternal(user);\n      }\n      const id_token = args.id_token_hint || user && user.id_token;\n      if (id_token) {\n        logger2.debug(\"setting id_token_hint in signout request\");\n        args.id_token_hint = id_token;\n      }\n      await this.removeUser();\n      logger2.debug(\"user removed, creating signout request\");\n      const signoutRequest = await this._client.createSignoutRequest(args);\n      logger2.debug(\"got signout request\");\n      return await handle.navigate({\n        url: signoutRequest.url,\n        state: (_a = signoutRequest.state) == null ? void 0 : _a.id,\n        scriptOrigin: this.settings.iframeScriptOrigin\n      });\n    } catch (err) {\n      logger2.debug(\"error after preparing navigator, closing navigator window\");\n      handle.close();\n      throw err;\n    }\n  }\n  async _signoutEnd(url) {\n    const logger2 = this._logger.create(\"_signoutEnd\");\n    const signoutResponse = await this._client.processSignoutResponse(url);\n    logger2.debug(\"got signout response\");\n    return signoutResponse;\n  }\n  /**\n   * Trigger a silent request (via an iframe) to the end session endpoint.\n   *\n   * @returns A promise\n   */\n  async signoutSilent(args = {}) {\n    var _a;\n    const logger2 = this._logger.create(\"signoutSilent\");\n    const {\n      silentRequestTimeoutInSeconds,\n      ...requestArgs\n    } = args;\n    const id_token_hint = this.settings.includeIdTokenInSilentSignout ? (_a = await this._loadUser()) == null ? void 0 : _a.id_token : void 0;\n    const url = this.settings.popup_post_logout_redirect_uri;\n    const handle = await this._iframeNavigator.prepare({\n      silentRequestTimeoutInSeconds\n    });\n    await this._signout({\n      request_type: \"so:s\",\n      post_logout_redirect_uri: url,\n      id_token_hint,\n      ...requestArgs\n    }, handle);\n    logger2.info(\"success\");\n  }\n  /**\n   * Notify the parent window of response (callback) from the end session endpoint.\n   * It is recommended to use {@link UserManager.signoutCallback} instead.\n   *\n   * @returns A promise\n   *\n   * @see {@link UserManager.signoutCallback}\n   */\n  async signoutSilentCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signoutSilentCallback\");\n    await this._iframeNavigator.callback(url);\n    logger2.info(\"success\");\n  }\n  async revokeTokens(types) {\n    const user = await this._loadUser();\n    await this._revokeInternal(user, types);\n  }\n  async _revokeInternal(user, types = this.settings.revokeTokenTypes) {\n    const logger2 = this._logger.create(\"_revokeInternal\");\n    if (!user) return;\n    const typesPresent = types.filter(type => typeof user[type] === \"string\");\n    if (!typesPresent.length) {\n      logger2.debug(\"no need to revoke due to no token(s)\");\n      return;\n    }\n    for (const type of typesPresent) {\n      await this._client.revokeToken(user[type], type);\n      logger2.info(`${type} revoked successfully`);\n      if (type !== \"access_token\") {\n        user[type] = null;\n      }\n    }\n    await this.storeUser(user);\n    logger2.debug(\"user stored\");\n    await this._events.load(user);\n  }\n  /**\n   * Enables silent renew for the `UserManager`.\n   */\n  startSilentRenew() {\n    this._logger.create(\"startSilentRenew\");\n    void this._silentRenewService.start();\n  }\n  /**\n   * Disables silent renew for the `UserManager`.\n   */\n  stopSilentRenew() {\n    this._silentRenewService.stop();\n  }\n  get _userStoreKey() {\n    return `user:${this.settings.authority}:${this.settings.client_id}`;\n  }\n  async _loadUser() {\n    const logger2 = this._logger.create(\"_loadUser\");\n    const storageString = await this.settings.userStore.get(this._userStoreKey);\n    if (storageString) {\n      logger2.debug(\"user storageString loaded\");\n      return User.fromStorageString(storageString);\n    }\n    logger2.debug(\"no user storageString\");\n    return null;\n  }\n  async storeUser(user) {\n    const logger2 = this._logger.create(\"storeUser\");\n    if (user) {\n      logger2.debug(\"storing user\");\n      const storageString = user.toStorageString();\n      await this.settings.userStore.set(this._userStoreKey, storageString);\n    } else {\n      this._logger.debug(\"removing user\");\n      await this.settings.userStore.remove(this._userStoreKey);\n      if (this.settings.dpop) {\n        await this.settings.dpop.store.remove(this.settings.client_id);\n      }\n    }\n  }\n  /**\n   * Removes stale state entries in storage for incomplete authorize requests.\n   */\n  async clearStaleState() {\n    await this._client.clearStaleState();\n  }\n  /**\n   * Dynamically generates a DPoP proof for a given user, URL and optional Http method.\n   * This method is useful when you need to make a request to a resource server\n   * with fetch or similar, and you need to include a DPoP proof in a DPoP header.\n   * @param url - The URL to generate the DPoP proof for\n   * @param user - The user to generate the DPoP proof for\n   * @param httpMethod - Optional, defaults to \"GET\"\n   * @param nonce - Optional nonce provided by the resource server\n   *\n   * @returns A promise containing the DPoP proof or undefined if DPoP is not enabled/no user is found.\n   */\n  async dpopProof(url, user, httpMethod, nonce) {\n    var _a, _b;\n    const dpopState = await ((_b = (_a = this.settings.dpop) == null ? void 0 : _a.store) == null ? void 0 : _b.get(this.settings.client_id));\n    if (dpopState) {\n      return await CryptoUtils.generateDPoPProof({\n        url,\n        accessToken: user == null ? void 0 : user.access_token,\n        httpMethod,\n        keyPair: dpopState.keys,\n        nonce\n      });\n    }\n    return void 0;\n  }\n  async generateDPoPJkt(dpopSettings) {\n    let dpopState = await dpopSettings.store.get(this.settings.client_id);\n    if (!dpopState) {\n      const dpopKeys = await CryptoUtils.generateDPoPKeys();\n      dpopState = new DPoPState(dpopKeys);\n      await dpopSettings.store.set(this.settings.client_id, dpopState);\n    }\n    return await CryptoUtils.generateDPoPJkt(dpopState.keys);\n  }\n};\n\n// package.json\nvar version = \"3.3.0\";\n\n// src/Version.ts\nvar Version = version;\n\n// src/IndexedDbDPoPStore.ts\nvar IndexedDbDPoPStore = class {\n  constructor() {\n    this._dbName = \"oidc\";\n    this._storeName = \"dpop\";\n  }\n  async set(key, value) {\n    const store = await this.createStore(this._dbName, this._storeName);\n    await store(\"readwrite\", str => {\n      str.put(value, key);\n      return this.promisifyRequest(str.transaction);\n    });\n  }\n  async get(key) {\n    const store = await this.createStore(this._dbName, this._storeName);\n    return await store(\"readonly\", str => {\n      return this.promisifyRequest(str.get(key));\n    });\n  }\n  async remove(key) {\n    const item = await this.get(key);\n    const store = await this.createStore(this._dbName, this._storeName);\n    await store(\"readwrite\", str => {\n      return this.promisifyRequest(str.delete(key));\n    });\n    return item;\n  }\n  async getAllKeys() {\n    const store = await this.createStore(this._dbName, this._storeName);\n    return await store(\"readonly\", str => {\n      return this.promisifyRequest(str.getAllKeys());\n    });\n  }\n  promisifyRequest(request) {\n    return new Promise((resolve, reject) => {\n      request.oncomplete = request.onsuccess = () => resolve(request.result);\n      request.onabort = request.onerror = () => reject(request.error);\n    });\n  }\n  async createStore(dbName, storeName) {\n    const request = indexedDB.open(dbName);\n    request.onupgradeneeded = () => request.result.createObjectStore(storeName);\n    const db = await this.promisifyRequest(request);\n    return async (txMode, callback) => {\n      const tx = db.transaction(storeName, txMode);\n      const store = tx.objectStore(storeName);\n      return await callback(store);\n    };\n  }\n};\nexport { AccessTokenEvents, CheckSessionIFrame, DPoPState, ErrorResponse, ErrorTimeout, InMemoryWebStorage, IndexedDbDPoPStore, Log, Logger, MetadataService, OidcClient, OidcClientSettingsStore, SessionMonitor, SigninResponse, SigninState, SignoutResponse, State, User, UserManager, UserManagerSettingsStore, Version, WebStorageStateStore };\n"],
  "mappings": "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",
  "names": ["InvalidTokenError", "b64DecodeUnicode", "str", "m", "p", "code", "base64UrlDecode", "output", "jwtDecode", "token", "options", "pos", "part", "decoded", "e", "nopLogger", "level", "logger", "Log", "Log2", "reset", "setLevel", "value", "setLogger", "Logger", "_Logger", "_name", "args", "err", "method", "methodLogger", "name", "staticMethod", "staticLogger", "prefix", "JwtUtils", "token", "jwtDecode", "header", "payload", "privateKey", "__async", "encodedHeader", "CryptoUtils", "encodedPayload", "encodedToken", "signature", "encodedSignature", "UUID_V4_TEMPLATE", "toBase64", "val", "chr", "_CryptoUtils", "arr", "c", "code_verifier", "data", "hashed", "client_id", "client_secret", "alg", "message", "msgUint8", "hashBuffer", "jwk", "jsonObject", "utf8encodedAndHashed", "_0", "url", "accessToken", "httpMethod", "keyPair", "nonce", "hashedToken", "encodedHash", "publicJwk", "input", "Event", "cb", "idx", "ev", "PopupUtils", "_a", "features", "__objRest", "_b", "_c", "width", "key", "Timer", "_Timer", "diff", "durationInSeconds", "logger2", "expiration", "timerDurationInSeconds", "UrlUtils", "responseMode", "params", "URL_STATE_DELIMITER", "ErrorResponse", "form", "ErrorTimeout", "AccessTokenEvents", "container", "duration", "expiring", "expired", "CheckSessionIFrame", "_callback", "_client_id", "_intervalInSeconds", "_stopOnError", "e", "parsedUrl", "resolve", "session_state", "send", "InMemoryWebStorage", "index", "ErrorDPoPNonce", "JsonService", "additionalContentTypes", "_jwtHandler", "_extraHeaders", "init", "timeoutInSeconds", "initFetch", "controller", "timeoutId", "__spreadProps", "__spreadValues", "credentials", "headers", "response", "contentType", "item", "json", "_1", "body", "basicAuth", "initCredentials", "extraHeaders", "responseText", "customKeys", "protectedHeaders", "preventOverride", "headerName", "content", "MetadataService", "_settings", "metadata", "optional", "jwks_uri", "keySet", "WebStorageStateStore", "store", "len", "keys", "DefaultResponseType", "DefaultScope", "DefaultClientAuthentication", "DefaultStaleStateAgeInSeconds", "OidcClientSettingsStore", "authority", "metadataUrl", "signingKeys", "metadataSeed", "response_type", "scope", "redirect_uri", "post_logout_redirect_uri", "client_authentication", "prompt", "display", "max_age", "ui_locales", "acr_values", "resource", "response_mode", "filterProtocolClaims", "loadUserInfo", "requestTimeoutInSeconds", "staleStateAgeInSeconds", "mergeClaimsStrategy", "disablePKCE", "stateStore", "revokeTokenAdditionalContentTypes", "fetchRequestCredentials", "refreshTokenAllowedScope", "extraQueryParams", "extraTokenParams", "dpop", "omitScopeWhenRequesting", "UserInfoService", "_metadataService", "claims", "TokenClient", "grant_type", "_d", "_e", "_f", "param", "ResponseValidator", "_claimsService", "state", "skipUserInfo", "shouldValidateSubClaim", "hasIdToken", "validateSub", "tokenResponse", "existingToken", "incoming", "existing", "State", "_State", "storageString", "storage", "age", "cutoff", "i", "remove", "SigninState", "_SigninState", "code_challenge", "_SigninRequest", "state_data", "request_type", "url_state", "dpopJkt", "optionalParams", "stateParam", "r", "SigninRequest", "OidcScope", "SigninResponse", "splitState", "SignoutRequest", "id_token_hint", "SignoutResponse", "DefaultProtocolClaims", "InternalRequiredProtocolClaims", "ClaimsService", "result", "protocolClaims", "claim", "claims1", "claims2", "values", "mergedValues", "DPoPState", "OidcClient", "settings", "metadataService", "request", "request_uri", "login_hint", "signinRequest", "signinState", "removeState", "storedStateString", "dpopProof", "dpopStore", "dpopState", "username", "password", "signinResponse", "allowableScopes", "s", "signoutState", "type", "SessionMonitor", "_userManager", "user", "intervalInSeconds", "stopOnError", "checkSessionIFrame", "timerHandle", "session", "tmpUser", "raiseEvent", "User", "_User", "expires_in", "messageSource", "AbstractChildWindow", "keepOpen", "reject", "listener", "origin", "channel", "reason", "dispose", "parent", "targetOrigin", "msgData", "DefaultPopupWindowFeatures", "DefaultPopupTarget", "DefaultAccessTokenExpiringNotificationTimeInSeconds", "DefaultCheckSessionIntervalInSeconds", "DefaultSilentRequestTimeoutInSeconds", "UserManagerSettingsStore", "popup_redirect_uri", "popup_post_logout_redirect_uri", "popupWindowFeatures", "popupWindowTarget", "redirectMethod", "redirectTarget", "iframeNotifyParentOrigin", "iframeScriptOrigin", "silent_redirect_uri", "silentRequestTimeoutInSeconds", "automaticSilentRenew", "validateSubOnSilentRenew", "includeIdTokenInSilentRenew", "monitorSession", "monitorAnonymousSession", "checkSessionIntervalInSeconds", "query_status_response_type", "stopCheckSessionOnError", "revokeTokenTypes", "revokeTokensOnSignout", "includeIdTokenInSilentSignout", "accessTokenExpiringNotificationTimeInSeconds", "userStore", "IFrameWindow", "_IFrameWindow", "iframe", "timer", "__superGet", "_a2", "frame", "IFrameNavigator", "checkForPopupClosedInterval", "second", "PopupWindow", "_this", "popupSignal", "centeredPopup", "popupClosedInterval", "clearPopupClosedInterval", "PopupNavigator", "RedirectNavigator", "targetWindow", "redirect", "abort", "promise", "UserManagerEvents", "SilentRenewService", "RefreshState", "UserManager", "redirectNavigator", "popupNavigator", "iframeNavigator", "requestArgs", "handle", "verifySub", "navResponse", "id_token", "signoutRequest", "signoutResponse", "types", "typesPresent", "dpopSettings", "dpopKeys", "version", "Version", "IndexedDbDPoPStore", "str", "dbName", "storeName", "db", "txMode", "callback"]
}
